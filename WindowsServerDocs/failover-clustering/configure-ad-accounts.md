---
description: 詳細については、Active Directory でのクラスターアカウントの構成に関するページを参照してください。
title: Active Directory でクラスターのアカウントを構成する
ms.date: 11/12/2012
author: JasonGerend
manager: lizross
ms.author: jgerend
ms.openlocfilehash: e6b7c2a3af136fa7c3970de4550609f4eaa9fa8d
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "97041070"
---
# <a name="configuring-cluster-accounts-in-active-directory"></a>Active Directory でクラスターのアカウントを構成する

適用対象: Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows Server 2008 R2、および Windows Server 2008

Windows Server では、フェールオーバークラスターを作成し、クラスター化されたサービスまたはアプリケーションを構成すると、フェールオーバークラスターウィザードによって必要な Active Directory コンピューターアカウント (コンピューターオブジェクトとも呼ばれます) が作成され、特定のアクセス許可が付与されます。 ウィザードは、クラスター自体のコンピューターアカウント (このアカウントはクラスター名オブジェクトまたは CNO とも呼ばれます) と、クラスター化されたサービスとアプリケーションのほとんどの種類のコンピューターアカウント (Hyper-v 仮想マシン) を作成します。 これらのアカウントのアクセス許可は、フェールオーバークラスターウィザードによって自動的に設定されます。 アクセス許可が変更された場合は、クラスターの要件に合わせて変更する必要があります。 このガイドでは、これらの Active Directory アカウントとアクセス許可について説明し、重要な理由についての背景情報を提供し、アカウントを構成および管理する手順について説明します。


## <a name="overview-of-active-directory-accounts-needed-by-a-failover-cluster"></a>フェールオーバークラスターで必要とされる Active Directory アカウントの概要

このセクションでは、フェールオーバークラスターにとって重要な Active Directory コンピューターアカウント (Active Directory コンピューターオブジェクト) について説明します。 これらのアカウントは次のとおりです。

  - **クラスターの作成に使用されたユーザーアカウント。** これは、クラスターの作成ウィザードを起動するために使用されるユーザーアカウントです。 このアカウントは、クラスター自体に対してコンピューターアカウントを作成するための基礎を提供するため、重要です。

  - **クラスター名アカウント。** (クラスター自体のコンピューターアカウント (クラスター名オブジェクトまたは CNO とも呼ばれます)。 このアカウントは、クラスターの作成ウィザードによって自動的に作成され、クラスターと同じ名前になります。 クラスター名アカウントは非常に重要です。このアカウントを使用すると、クラスターで新しいサービスとアプリケーションを構成するときに、他のアカウントが自動的に作成されるためです。 クラスター名アカウントが削除された場合、またはアクセス許可が失われた場合、クラスター名アカウントが復元されるか、適切なアクセス許可が復元されるまで、他のアカウントをクラスターで要求されたように作成することはできません。

    たとえば、Cluster1 という名前のクラスターを作成し、クラスター上で PrintServer1 という名前のクラスター化されたプリントサーバーを構成しようとすると、Active Directory の Cluster1 アカウントは、PrintServer1 という名前のコンピューターアカウントを作成するために使用できるように、正しいアクセス許可を保持する必要があります。

    クラスター名アカウントは、Active Directory のコンピューターアカウントの既定のコンテナーに作成されます。 既定では、これは "Computers" コンテナーですが、ドメイン管理者は別のコンテナーまたは組織単位 (OU) にリダイレクトすることを選択できます。

  - **クラスター化されたサービスまたはアプリケーションのコンピューターアカウント (コンピューターオブジェクト)。** これらのアカウントは、多くの種類のクラスター化されたサービスまたはアプリケーションを作成するプロセスの一部として、高可用性ウィザードによって自動的に作成されます。ただし、Hyper-v 仮想マシンの場合は例外です。 クラスター名アカウントには、これらのアカウントを制御するために必要なアクセス許可が付与されます。

    たとえば、Cluster1 という名前のクラスターがある場合に、FileServer1 という名前のクラスター化されたファイルサーバーを作成すると、高可用性ウィザードによって、FileServer1 という Active Directory のコンピューターアカウントが作成されます。 高可用性ウィザードでは、FileServer1 アカウントを制御するために必要なアクセス許可を Cluster1 アカウントに付与することもできます。


次の表では、これらのアカウントに必要なアクセス許可について説明します。


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>アカウント</th>
<th>アクセス許可の詳細</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>クラスターの作成に使用されるアカウント</p></td>
<td><p>クラスターノードとなるサーバーの管理アクセス許可が必要です。 また、ドメイン内のコンピューターアカウントに使用されるコンテナーに、[ <strong>コンピューターオブジェクトの作成</strong> ] および [ <strong>すべてのプロパティの読み取り</strong> ] アクセス許可が必要です。</p></td>
</tr>
<tr class="even">
<td><p>クラスター名アカウント (クラスター自体のコンピューターアカウント)</p></td>
<td><p>クラスターの作成ウィザードを実行すると、ドメイン内のコンピューターアカウントに使用される既定のコンテナーにクラスター名アカウントが作成されます。 既定では、クラスター名アカウント (他のコンピューターアカウントと同様) では、ドメイン内に最大10個のコンピューターアカウントを作成できます。</p>
<p>クラスターを作成する前にクラスター名アカウント (クラスター名オブジェクト) を作成する場合 (つまり、アカウントを事前設定する場合)、ドメイン内のコンピューターアカウントに使用されるコンテナーの [ <strong>コンピューターオブジェクトの作成</strong> ] および [ <strong>すべてのプロパティの読み取り</strong> ] アクセス許可を付与する必要があります。 また、アカウントを無効にし、クラスターをインストールする管理者が使用するアカウントに <strong>フルコントロール</strong> を付与する必要があります。 詳細については、このガイドの後の「 <a href="#steps-for-prestaging-the-cluster-name-account" data-raw-source="[Steps for prestaging the cluster name account](#steps-for-prestaging-the-cluster-name-account)">クラスター名アカウントを事前設定する手順</a>」を参照してください。</p></td>
</tr>
<tr class="odd">
<td><p>クラスター化されたサービスまたはアプリケーションのコンピューターアカウント</p></td>
<td><p>高可用性ウィザードを実行すると (新しいクラスター化されたサービスまたはアプリケーションを作成するため)、ほとんどの場合、クラスター化されたサービスまたはアプリケーションのコンピューターアカウントが Active Directory に作成されます。 このアカウントを制御するために必要なアクセス許可がクラスター名アカウントに付与されます。 例外はクラスター化された Hyper-v 仮想マシンです。こののコンピューターアカウントは作成されません。</p>
<p>クラスター化されたサービスまたはアプリケーションのコンピューターアカウントを事前設定する場合は、必要なアクセス許可で構成する必要があります。 詳細については、このガイドの後の「 <a href="#steps-for-prestaging-an-account-for-a-clustered-service-or-application" data-raw-source="[Steps for prestaging an account for a clustered service or application](#steps-for-prestaging-an-account-for-a-clustered-service-or-application)">クラスター化されたサービスまたはアプリケーションのアカウントを事前設定する手順</a>」を参照してください。</p></td>
</tr>
</tbody>
</table>


> [!NOTE]
> 以前のバージョンの Windows Server では、クラスターサービスのアカウントがありました。 ただし、Windows Server 2008 以降、このクラスターサービスは、サービスに必要な特定のアクセス許可と特権 (ローカルシステムコンテキストに似ていますが、特権が制限されています) を提供する特別なコンテキストで自動的に実行されます。 ただし、このガイドで説明されているように、他のアカウントが必要です。
<br>


### <a name="how-accounts-are-created-through-wizards-in-failover-clustering"></a>フェールオーバークラスタリングでウィザードを使用してアカウントを作成する方法

次の図は、前のサブセクションで説明したコンピューターアカウント (Active Directory オブジェクト) の使用方法と作成方法を示しています。 これらのアカウントは、管理者がクラスターの作成ウィザードを実行し、(クラスター化されたサービスまたはアプリケーションを構成するために) 高可用性ウィザードを実行したときに再生されます。

![コンピューターアカウントの使用と作成](media/configure-ad-accounts/Cc731002.e8a7686c-9ba8-4ddf-87b1-175b7b51f65d(WS.10).gif)

上の図は、クラスターの作成ウィザードと高可用性ウィザードの両方を実行している単一の管理者を示しています。 ただし、2つの異なるユーザーアカウントを使用する2人の管理者が、両方のアカウントに十分なアクセス許可を持っている可能性があります。 アクセス許可の詳細については、このガイドの「フェールオーバークラスター、Active Directory ドメイン、およびアカウントに関する要件」を参照してください。

### <a name="how-problems-can-result-if-accounts-needed-by-the-cluster-are-changed"></a>クラスターで必要なアカウントが変更された場合に発生する問題

次の図は、クラスターの作成ウィザードでクラスター名アカウント (クラスターに必要なアカウントの1つ) が自動的に作成された後に、そのアカウントが変更された場合の問題を示しています。

![クラスター名が変更された場合の問題](media/configure-ad-accounts/Cc731002.beecc4f7-049c-4945-8fad-2cceafd6a4a5(WS.10).gif)

図に示されている問題の種類が発生すると、特定のイベント (1193、1194、1206、または 1207) がイベントビューアーに記録されます。 これらのイベントの詳細については、「」を参照してください [https://go.microsoft.com/fwlink/?LinkId=118271](https://go.microsoft.com/fwlink/?linkid=118271) 。

コンピューターオブジェクト (既定では 10) を作成するためのドメイン全体のクォータに達した場合は、クラスター化されたサービスまたはアプリケーションのアカウントの作成に関する同様の問題が発生する可能性があります。 含まれている場合は、クォータの増加についてドメイン管理者に相談することをお勧めします。ただし、これはドメイン全体の設定であるため、慎重に検討した後でのみ変更し、前の図で状況を説明していないことを確認した後にのみ変更することをお勧めします。 詳細については、このガイドの後の「 [クラスター関連の Active Directory アカウントの変更によって発生する問題のトラブルシューティングの手順](#steps-for-troubleshooting-problems-caused-by-changes-in-cluster-related-active-directory-accounts)」を参照してください。

## <a name="requirements-related-to-failover-clusters-active-directory-domains-and-accounts"></a>フェールオーバークラスター、Active Directory ドメイン、およびアカウントに関する要件

前の3つのセクションで説明したように、クラスター化されたサービスとアプリケーションをフェールオーバークラスターで正常に構成するには、特定の要件を満たす必要があります。 最も基本的な要件は、クラスターノードの場所 (1 つのドメイン内) と、クラスターをインストールするユーザーのアカウントのアクセス許可のレベルに関係します。 これらの要件を満たしている場合は、フェールオーバークラスターウィザードによって、クラスターに必要なその他のアカウントが自動的に作成されます。 次の一覧は、これらの基本的な要件についての詳細を示しています。

  - **ノード:** すべてのノードは同じ Active Directory ドメイン内に存在する必要があります。 (ドメインは、Active Directory を含まない Windows NT 4.0 に基づくことはできません)。

  - **クラスターをインストールするユーザーのアカウント:** クラスターをインストールするユーザーは、次の特性を持つアカウントを使用する必要があります。

      - アカウントはドメインアカウントである必要があります。 ドメイン管理者アカウントである必要はありません。 この一覧の他の要件を満たしている場合は、ドメインユーザーアカウントを使用できます。

      - このアカウントは、クラスターノードとなるサーバーの管理アクセス許可を持っている必要があります。 これを実現する最も簡単な方法は、ドメインユーザーアカウントを作成し、クラスターノードとなる各サーバーのローカルの Administrators グループにそのアカウントを追加することです。 詳細については、このガイドの後半の「 [クラスターをインストールするユーザーのアカウントを構成する手順](#steps-for-configuring-the-account-for-the-person-who-installs-the-cluster)」を参照してください。

      - アカウント (またはアカウントがメンバーとなっているグループ) には、ドメイン内のコンピューターアカウントに使用されるコンテナーの [ **コンピューターオブジェクトの作成** ] および [ **すべてのプロパティの読み取り** ] アクセス許可が付与されている必要があります。 詳細については、このガイドの後半の「 [クラスターをインストールするユーザーのアカウントを構成する手順](#steps-for-configuring-the-account-for-the-person-who-installs-the-cluster)」を参照してください。

      - クラスター名アカウント (クラスターと同じ名前のコンピューターアカウント) を事前設定することを選択した場合、事前設定されたクラスター名アカウントは、クラスターをインストールするユーザーのアカウントに "フルコントロール" アクセス許可を付与する必要があります。 クラスター名アカウントを事前設定する方法に関するその他の重要な詳細については、このガイドの「 [クラスター名アカウントを事前](#steps-for-prestaging-the-cluster-name-account)設定する手順」を参照してください。


### <a name="planning-ahead-for-password-resets-and-other-account-maintenance"></a>パスワードのリセットとその他のアカウントのメンテナンスを事前に計画する

フェールオーバークラスターの管理者は、場合によっては、クラスター名アカウントのパスワードのリセットが必要になることがあります。 この操作には、特定のアクセス許可、" **パスワードのリセット** " アクセス許可が必要です。 そのため、クラスター名アカウントのアクセス許可を編集することをお勧めします (Active Directory ユーザーとコンピュータースナップインを使用します)。クラスターの管理者に、クラスター名アカウントの **パスワードリセット** アクセス許可を付与します。 詳細については、このガイドの後の「 [クラスター名アカウントのパスワードに関する問題のトラブルシューティングの手順](#steps-for-troubleshooting-password-problems-with-the-cluster-name-account)」を参照してください。

## <a name="steps-for-configuring-the-account-for-the-person-who-installs-the-cluster"></a>クラスターをインストールするユーザーのアカウントを構成する手順

クラスターをインストールするユーザーのアカウントは、クラスター自体に対してコンピューターアカウントが作成される基準を提供するため、重要です。

次の手順を完了するために最低限必要なグループメンバーシップは、ドメインアカウントを作成し、ドメインに必要なアクセス許可を割り当てるか、または (他のユーザーによって作成された) アカウントをフェールオーバークラスター内のノードとなるサーバーのローカルの **Administrators** グループに配置するかによって異なります。 前者の場合、この手順を実行するには、 **Account Operators** またはそれと同等のメンバーシップが最低限必要です。 後者の場合、フェールオーバークラスター内のノードとなるサーバーのローカル **Administrators** グループのメンバーシップ、またはそれと同等のメンバーシップがすべて必要です。 適切なアカウントおよびグループメンバーシップの使用方法の詳細については、「」を参照 [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477) してください。

#### <a name="to-configure-the-account-for-the-person-who-installs-the-cluster"></a>クラスターをインストールするユーザーのアカウントを構成するには

1.  クラスターをインストールするユーザーのドメインアカウントを作成または取得します。 このアカウントには、ドメインユーザーアカウントまたは **アカウントオペレーター** アカウントを使用できます。 標準ユーザーアカウントを使用する場合は、この手順の後半で、追加のアクセス許可を付与する必要があります。

2.  手順 1. で作成または取得したアカウントが、ドメイン内のコンピューターのローカルの **administrators** グループに自動的に含まれていない場合は、フェールオーバークラスター内のノードとなるサーバーのローカルの **administrators** グループにアカウントを追加します。

    1.  [**スタート**] ボタンをクリックし、[**管理ツール**]、[**サーバー マネージャー**] の順にクリックします。

    2.  コンソールツリーで、[ **構成**]、[ **ローカルユーザーとグループ**]、[ **グループ**] の順に展開します。

    3.  中央のウィンドウで、[ **Administrators**] を右クリックし、[ **グループに追加**] をクリックして、[ **追加**] をクリックします。

    4.  [ **選択するオブジェクト名を入力してください**] に、手順1で作成または取得したユーザーアカウントの名前を入力します。 メッセージが表示されたら、この操作に必要なアクセス許可を持つアカウント名とパスワードを入力します。 次に、 **[OK]** をクリックします

    5.  フェールオーバークラスター内のノードとなる各サーバーで、これらの手順を繰り返します。

> [!IMPORTANT]
> これらの手順は、クラスター内のノードとなるすべてのサーバーで繰り返す必要があります。
<br>


3. 手順 1. で作成または取得したアカウントがドメイン管理者アカウントである場合は、この手順の残りの部分をスキップします。 それ以外の場合は、ドメイン内のコンピューターアカウントに使用されるコンテナーで、[ **コンピューターオブジェクトの作成** ] および [ **すべてのプロパティの読み取り** ] のアクセス許可をアカウントに付与します。

   1.  ドメインコントローラーで、[ **スタート**] をクリックし、[ **管理ツール**] をクリックして、[ **ユーザーとコンピューターの Active Directory**] をクリックします。 [**ユーザー アカウント制御**] ダイアログ ボックスが表示されたら、表示された操作が正しいことを確認し、[**続行**] をクリックします。

   2.  [ **表示** ] メニューで、 **[高度な機能** ] が選択されていることを確認します。

       **[高度な機能**] を選択すると、[ **Active Directory ユーザーとコンピューター**] のアカウント (オブジェクト) のプロパティに [**セキュリティ**] タブが表示されます。

   3.  [既定の **コンピューター** ] コンテナー、またはドメイン内にコンピューターアカウントが作成された既定のコンテナーを右クリックし、[ **プロパティ**] をクリックします。 **コンピューター** は <b>Active Directory ユーザーとコンピューター/</b><i>ドメインノード</i>/<b>コンピューター</b>にあります。

   4.  **[セキュリティ]** タブで **[詳細設定]** をクリックします。

   5.  [ **追加**] をクリックし、手順1で作成または取得したアカウントの名前を入力して、[ **OK**] をクリックします。

   6.  [コンテナー **のアクセス許可エントリ** ] ダイアログボックスで、[**コンピューターオブジェクトの作成**] および [すべての **プロパティの読み取り**] のアクセス許可を見つけ、それぞれに対して [**許可**] チェックボックスがオンになっていることを確認します。

       ![[アクセス許可エントリ] ダイアログボックス](media/configure-ad-accounts/Cc731002.0a863ac5-2024-4f9f-8a4d-a419aff32fa0(WS.10).gif)

## <a name="steps-for-prestaging-the-cluster-name-account"></a>クラスター名アカウントを事前設定する手順

クラスター名アカウントを事前設定せずに、クラスターの作成ウィザードを実行したときにアカウントを自動的に作成および構成できるようにする場合は、通常はより簡単です。 ただし、組織の要件によりクラスター名アカウントを事前設定する必要がある場合は、次の手順を使用します。

この手順を実行するには、**Domain Admins** グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。 適切なアカウントおよびグループメンバーシップの使用方法の詳細については、「」を参照 [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477) してください。 この手順では、クラスターの作成時に使用するのと同じアカウントを使用できます。

#### <a name="to-prestage-a-cluster-name-account"></a>クラスター名アカウントを事前設定するには

1.  クラスターの名前と、クラスターの作成者が使用するユーザーアカウントの名前がわかっていることを確認してください。 (このアカウントを使用してこの手順を実行できます)。

2.  ドメインコントローラーで、[ **スタート**] をクリックし、[ **管理ツール**] をクリックして、[ **ユーザーとコンピューターの Active Directory**] をクリックします。 [**ユーザー アカウント制御**] ダイアログ ボックスが表示されたら、表示された操作が正しいことを確認し、[**続行**] をクリックします。

3.  コンソールツリーで、[ **コンピューター** ] を右クリックするか、ドメイン内にコンピューターアカウントが作成されている既定のコンテナーを右クリックします。 **コンピューター** は <b>Active Directory ユーザーとコンピューター/</b><i>ドメインノード</i>/<b>コンピューター</b>にあります。

4.  [ **新規** ] をクリックし、[ **コンピューター**] をクリックします。

5.  フェールオーバークラスターに使用する名前 (つまり、クラスターの作成ウィザードで指定するクラスター名) を入力し、[ **OK]** をクリックします。

6.  作成したアカウントを右クリックし、[ **アカウントを無効に** する] をクリックします。 選択内容を確認するメッセージが表示されたら、[ **はい]** をクリックします。

    このアカウントは無効にする必要があります。これにより、 **クラスターの作成** ウィザードを実行するときに、クラスターに使用するアカウントが、現在ドメイン内の既存のコンピューターまたはクラスターによって使用されていないことを確認できます。

7.  [ **表示** ] メニューで、 **[高度な機能** ] が選択されていることを確認します。

    **[高度な機能**] を選択すると、[ **Active Directory ユーザーとコンピューター**] のアカウント (オブジェクト) のプロパティに [**セキュリティ**] タブが表示されます。

8.  手順 3. で右クリックしたフォルダーを右クリックし、[ **プロパティ**] をクリックします。

9.  **[セキュリティ]** タブで **[詳細設定]** をクリックします。

10. [ **追加**] をクリックし、[ **オブジェクトの種類** ] をクリックして [ **コンピューター** ] が選択されていることを確認し、[ **OK]** をクリックします。 次に、[ **選択するオブジェクト名を入力してください**] に、作成したコンピューターアカウントの名前を入力し、[ **OK]** をクリックします。 無効なオブジェクトを追加しようとしているというメッセージが表示された場合は、[ **OK]** をクリックします。

11. [ **アクセス許可エントリ** ] ダイアログボックスで、 **[コンピューターオブジェクトの作成** ] および [すべてのプロパティの **読み取り** ] のアクセス許可を見つけ、それぞれに対して [ **許可** ] チェックボックスがオンになっていることを確認します。

    ![[アクセス許可エントリ] ダイアログボックス](media/configure-ad-accounts/Cc731002.f5977c4d-a62e-4b17-81e3-8c19ddca2078(WS.10).gif)

12. **Active Directory ユーザーとコンピューター** ] スナップインに戻るまで、[ **OK** ] をクリックします。

13. クラスターの作成に使用するのと同じアカウントを使用してこの手順を実行する場合は、残りの手順を省略します。 それ以外の場合は、クラスターの作成に使用されるユーザーアカウントが、作成したコンピューターアカウントに対してフルコントロールを持つように、アクセス許可を構成する必要があります。

    1.  [ **表示** ] メニューで、 **[高度な機能** ] が選択されていることを確認します。

    2.  作成したコンピューター アカウントを右クリックし、[**プロパティ**] をクリックします。

    3.  **[セキュリティ]** タブで **[追加]** をクリックします。 [**ユーザー アカウント制御**] ダイアログ ボックスが表示されたら、表示された操作が正しいことを確認し、[**続行**] をクリックします。

    4.  **[ユーザー、コンピュータ、またはグループの選択**] ダイアログボックスを使用して、クラスタの作成時に使用されるユーザーアカウントを指定します。 次に、 **[OK]** をクリックします

    5.  追加したユーザーアカウントが選択されていることを確認し、[ **フルコントロール**] の横にある [ **許可** ] チェックボックスをオンにします。

        ![[アクセス許可エントリ] ダイアログボックス](media/configure-ad-accounts/Cc731002.fffaafe2-a494-498b-974c-8f9d70f7103b(WS.10).gif)

## <a name="steps-for-prestaging-an-account-for-a-clustered-service-or-application"></a>クラスター化されたサービスまたはアプリケーションのアカウントを事前設定する手順

通常は、クラスター化されたサービスまたはアプリケーションのコンピューターアカウントを事前設定しないで、高可用性ウィザードを実行するときにアカウントを自動的に作成および構成できるようにする方が簡単です。 ただし、組織の要件によってアカウントを事前設定する必要がある場合は、次の手順を使用します。

この手順を実行するには、 **Account Operators** グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。 適切なアカウントおよびグループメンバーシップの使用方法の詳細については、「」を参照 [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477) してください。

### <a name="to-prestage-an-account-for-a-clustered-service-or-application"></a>クラスター化されたサービスまたはアプリケーションのアカウントを事前設定するには

1. クラスターの名前とクラスター化されたサービスまたはアプリケーションの名前がわかっていることを確認してください。

2. ドメインコントローラーで、[ **スタート**] をクリックし、[ **管理ツール**] をクリックして、[ **ユーザーとコンピューターの Active Directory**] をクリックします。 [**ユーザー アカウント制御**] ダイアログ ボックスが表示されたら、表示された操作が正しいことを確認し、[**続行**] をクリックします。

3. コンソールツリーで、[ **コンピューター** ] を右クリックするか、ドメイン内にコンピューターアカウントが作成されている既定のコンテナーを右クリックします。 **コンピューター** は <b>Active Directory ユーザーとコンピューター/</b><i>ドメインノード</i>/<b>コンピューター</b>にあります。

4. [ **新規** ] をクリックし、[ **コンピューター**] をクリックします。

5. クラスター化されたサービスまたはアプリケーションに使用する名前を入力し、[ **OK]** をクリックします。

6. [ **表示** ] メニューで、 **[高度な機能** ] が選択されていることを確認します。

    **[高度な機能**] を選択すると、[ **Active Directory ユーザーとコンピューター**] のアカウント (オブジェクト) のプロパティに [**セキュリティ**] タブが表示されます。

7.  作成したコンピューター アカウントを右クリックし、[**プロパティ**] をクリックします。

8.  **[セキュリティ]** タブで **[追加]** をクリックします。

9.  [ **オブジェクトの種類** ] をクリックし、[ **コンピューター** ] が選択されていることを確認して、[ **OK]** をクリックします。 次に、[ **選択するオブジェクト名を入力してください**] にクラスター名アカウントを入力し、[ **OK**] をクリックします。 無効なオブジェクトを追加しようとしているというメッセージが表示された場合は、[ **OK]** をクリックします。

10. [クラスター名アカウント] が選択されていることを確認し、[ **フルコントロール**] の横にある [ **許可** ] チェックボックスをオンにします。

    ![[セキュリティ] タブ](media/configure-ad-accounts/Cc731002.2e614376-87a6-453a-81ba-90ff7ebc3fa2(WS.10).gif)

## <a name="steps-for-troubleshooting-problems-related-to-accounts-used-by-the-cluster"></a>クラスターで使用されるアカウントに関連する問題のトラブルシューティングの手順

このガイドで既に説明したように、フェールオーバークラスターを作成し、クラスター化されたサービスまたはアプリケーションを構成すると、フェールオーバークラスターウィザードによって必要な Active Directory アカウントが作成され、適切なアクセス許可が付与されます。 必要なアカウントが削除されたり、必要なアクセス許可が変更されたりすると、問題が発生する可能性があります。 次のサブセクションでは、これらの問題をトラブルシューティングする手順について説明します。

  - [クラスター名アカウントのパスワードに関する問題のトラブルシューティングの手順](#steps-for-troubleshooting-password-problems-with-the-cluster-name-account)

  - [クラスター関連の Active Directory アカウントの変更によって発生する問題のトラブルシューティングの手順](#steps-for-troubleshooting-problems-caused-by-changes-in-cluster-related-active-directory-accounts)

### <a name="steps-for-troubleshooting-password-problems-with-the-cluster-name-account"></a>クラスター名アカウントのパスワードに関する問題のトラブルシューティングの手順

コンピューターオブジェクトに関するイベントメッセージ、または次のテキストを含むクラスター id に関するイベントメッセージがある場合は、この手順を使用します。 このテキストは、イベントメッセージの先頭ではなく、イベントメッセージ内にあることに注意してください。

`Logon failure: unknown user name or bad password.`

前の説明に一致するイベントメッセージは、クラスター名アカウントのパスワードと、クラスターソフトウェアによって保存されている対応するパスワードが一致しなくなったことを示します。

クラスター管理者が必要に応じて次の手順を実行するための適切なアクセス許可を持っていることを確認する方法については、このガイドの前半の「パスワードのリセットとその他のアカウントのメンテナンスのための事前計画」を参照してください。

この手順を完了するには、少なくともローカルの **Administrators** グループ、またはそれと同等のメンバーシップが必要です。 また、アカウントが **Domain Admins** アカウントであるか、またはクラスター名アカウントの作成者の所有者でない場合は、そのアカウントに、クラスター名アカウントの [**パスワードのリセット**] アクセス許可を付与する必要があります。 この手順では、クラスターをインストールしたユーザーが使用したアカウントを使用できます。 適切なアカウントおよびグループメンバーシップの使用方法の詳細については、「」を参照 [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477) してください。

#### <a name="to-troubleshoot-password-problems-with-the-cluster-name-account"></a>クラスター名アカウントのパスワードに関する問題のトラブルシューティングを行うには

1.  フェールオーバー クラスタ スナップインを開くには、[**スタート**] ボタンをクリックし、[**管理ツール**] をクリックします。次に、[**フェールオーバー クラスタ管理**] をクリックします。 ([ **ユーザーアカウント制御** ] ダイアログボックスが表示されたら、表示された操作が正しいことを確認し、[ **続行**] をクリックします)。

2.  構成するクラスタがフェールオーバー クラスタの管理スナップインに表示されない場合は、コンソール ツリーで [**フェールオーバー クラスタ管理**] を右クリックして [**クラスタの管理**] をクリックし、目的のクラスタを選択または指定します。

3.  中央のウィンドウで、[ **クラスターコアリソース**] を展開します。

4.  [ **クラスター名**] で、[ **名前** ] 項目を右クリックし、[ **他の操作**] をポイントして、[ **Active Directory オブジェクトの修復**] をクリックします。

### <a name="steps-for-troubleshooting-problems-caused-by-changes-in-cluster-related-active-directory-accounts"></a>クラスター関連の Active Directory アカウントの変更によって発生する問題のトラブルシューティングの手順

クラスター名アカウントが削除された場合、またはアクセス許可が失われた場合は、新しいクラスター化されたサービスまたはアプリケーションを構成しようとすると問題が発生します。 これが原因である可能性がある問題のトラブルシューティングを行うには、Active Directory ユーザーとコンピューター] スナップインを使用して、クラスター名アカウントとその他の関連アカウントを表示または変更します。 この種類の問題が発生したときにログに記録されるイベント (イベント1193、1194、1206、または 1207) については、「」を参照してください [https://go.microsoft.com/fwlink/?LinkId=118271](https://go.microsoft.com/fwlink/?linkid=118271) 。

この手順を実行するには、**Domain Admins** グループのメンバーシップ、またはそれと同等のメンバーシップが最低限必要です。 適切なアカウントおよびグループメンバーシップの使用方法の詳細については、「」を参照 [https://go.microsoft.com/fwlink/?LinkId=83477](https://go.microsoft.com/fwlink/?linkid=83477) してください。

#### <a name="to-troubleshoot-problems-caused-by-changes-in-cluster-related-active-directory-accounts"></a>クラスター関連の Active Directory アカウントの変更によって発生する問題のトラブルシューティングを行うには

1.  ドメインコントローラーで、[ **スタート**] をクリックし、[ **管理ツール**] をクリックして、[ **ユーザーとコンピューターの Active Directory**] をクリックします。 [**ユーザー アカウント制御**] ダイアログ ボックスが表示されたら、表示された操作が正しいことを確認し、[**続行**] をクリックします。

2.  [既定の **コンピューター** ] コンテナー、またはクラスター名アカウント (クラスターのコンピューターアカウント) が配置されているフォルダーを展開します。 **コンピューター** は <b>Active Directory ユーザーとコンピューター/</b><i>ドメインノード</i>/<b>コンピューター</b>にあります。

3.  クラスター名アカウントのアイコンを確認します。 これには下向きの矢印がない必要があります。つまり、アカウントを無効にすることはできません。 無効になっていると思われる場合は、右クリックして、[ **アカウントの有効化**] コマンドを探します。 コマンドが表示されたら、それをクリックします。

4.  [ **表示** ] メニューで、 **[高度な機能** ] が選択されていることを確認します。

    **[高度な機能**] を選択すると、[ **Active Directory ユーザーとコンピューター**] のアカウント (オブジェクト) のプロパティに [**セキュリティ**] タブが表示されます。

5.  [既定の **コンピューター** ] コンテナー、またはクラスター名アカウントがあるフォルダーを右クリックします。

6.  **[プロパティ]** をクリックします。

7.  **[セキュリティ]** タブで **[詳細設定]** をクリックします。

8.  アクセス許可のあるアカウントの一覧で、クラスター名のアカウントをクリックし、[ **編集**] をクリックします。


> [!NOTE]
> クラスター名のアカウントが表示されていない場合は、[ <STRONG>追加</STRONG> ] をクリックして一覧に追加します。
<br>


9. クラスター名アカウント (クラスター名オブジェクトまたは CNO とも呼ばれます) の場合は、[**コンピューターオブジェクトの作成**] および [**すべてのプロパティの読み取り**] のアクセス許可に [**許可**] が選択されていることを確認します。

   ![[アクセス許可エントリ] ダイアログボックス](media/configure-ad-accounts/Cc731002.f5977c4d-a62e-4b17-81e3-8c19ddca2078(WS.10).gif)

10. **Active Directory ユーザーとコンピューター** ] スナップインに戻るまで、[ **OK** ] をクリックします。

11. コンピューターアカウント (オブジェクト) の作成に関連するドメインポリシー (該当する場合は、ドメイン管理者によるコンサルティング) を確認します。 クラスター化されたサービスまたはアプリケーションを構成するたびに、クラスター名アカウントでコンピューターアカウントを作成できることを確認します。 たとえば、ドメイン管理者が、既定の **コンピューター** コンテナーではなく、特殊なコンテナーに新しいコンピューターアカウントを作成するように設定している場合は、これらの設定によって、クラスター名アカウントがそのコンテナーに新しいコンピューターアカウントを作成することも許可されていることを確認してください。

12. [既定の **コンピューター** ] コンテナー、またはクラスター化されたサービスまたはアプリケーションのいずれかのコンピューターアカウントがあるコンテナーを展開します。

13. クラスター化されたサービスまたはアプリケーションの1つのコンピューターアカウントを右クリックし、[ **プロパティ**] をクリックします。

14. [ **セキュリティ** ] タブで、アクセス許可のあるアカウントの中にクラスター名のアカウントが表示されていることを確認し、それを選択します。 クラスター名アカウントに **フルコントロール** のアクセス許可があることを確認します ([ **許可** ] チェックボックスがオンになっています)。 表示されていない場合は、クラスター名アカウントを一覧に追加し、 **フルコントロール** アクセス許可を付与します。

   ![[セキュリティ] タブ](media/configure-ad-accounts/Cc731002.2e614376-87a6-453a-81ba-90ff7ebc3fa2(WS.10).gif)

15. クラスターに構成されているクラスター化されたサービスとアプリケーションごとに、手順13-14 を繰り返します。

16. コンピューターオブジェクト (既定では 10) を作成するためのドメイン全体のクォータに達していないことを確認します (該当する場合は、ドメイン管理者に相談してください)。 この手順の前の項目をすべて確認して修正し、クォータに達した場合は、クォータを増やすことを検討してください。 クォータを変更するには:

   1.  管理者としてコマンドプロンプトを開き、 **ADSIEdit** を実行します。

   2.  [ **ADSI エディター**] を右クリックし、[ **接続先**] をクリックして、[ **OK]** をクリックします。 **既定の名前付けコンテキスト** がコンソールツリーに追加されます。

   3.  [既定の **名前付けコンテキスト**] をダブルクリックし、その下にあるドメインオブジェクトを右クリックして、[ **プロパティ**] をクリックします。

   4.  [ **Ms-DS-MachineAccountQuota**] までスクロールして選択し、[ **編集**] をクリックして値を変更し、[ **OK**] をクリックします。
