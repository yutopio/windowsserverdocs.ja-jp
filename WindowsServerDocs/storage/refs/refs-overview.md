---
title: Resilient File System (ReFS) の概要
ms.author: gawatu
manager: mchad
ms.topic: article
author: gawatu
ms.date: 06/29/2019
ms.openlocfilehash: 65ae84f354f535ba94a7331680234b3ad32d230d
ms.sourcegitcommit: 92e46b11154bab929e2c622d759ef62ec264c4e6
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/27/2020
ms.locfileid: "92734737"
---
# <a name="resilient-file-system-refs-overview"></a>Resilient File System (ReFS) の概要

>適用対象: Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows Server (半期チャネル)

Resilient File System (ReFS) は、Microsoft の最新のファイル システムであり、データの最大限の可用性、さまざまなワークロードに対する大規模なデータ セットへの拡張、破損部分の回復によるデータの整合性を実現できるように設計されています。 拡大する一連の記憶域のシナリオに対処し、未来の技術革新の基盤を確立することを目指しています。

## <a name="key-benefits"></a>主な利点

### <a name="resiliency"></a>回復性

ReFS には、正確に破損を検出し、オンライン状態を維持しながら、それらの破損を修正できる新機能が導入されており、データの整合性と可用性が向上しています。

- **整合性ストリーム** - ReFS は、メタデータのチェックサムと、必要に応じてファイル データのチェックサムを使用します。これにより、ReFS は破損を確実に検出できます。
- **記憶域スペースの統合** - ミラー スペースやパリティ スペースと組み合わせて使用する場合、ReFS は記憶域スペースによって提供されるデータの代替コピーを使って、検出された破損を自動的に修復できます。 修復プロセスは、破損の領域のみに限定され、オンラインで実行されるため、ボリュームのダウンタイムを必要としません。
- **データの部分的な救済** - ボリュームが破損し、破損したデータの代替コピーが存在しない場合、ReFS は名前空間から破損したデータを削除します。 ReFS では、ほとんどの修正できない破損を処理している間、ボリュームをオンライン状態に保つことができます。ただし、まれに、ReFS でボリュームをオフラインにすることが必要になる場合もあります。
- **事前対応型のエラー修正** - ReFS では、読み取りと書き込みの前にデータを検証するだけでなく、 <i></i>"スクラブ機能" と呼ばれる、データの整合性のスキャン機能が導入されています。 このスクラブ機能ではボリュームが定期的にスキャンされ、潜在的な破損部分を識別し、その破損データの修復を事前にトリガーします。

### <a name="performance"></a>パフォーマンス

回復性の向上に加えて、ReFS には、パフォーマンスが重視される仮想化されたワークロードに関する新機能が導入されています。 リアルタイムでの階層の最適化、ブロックの複製、スパース VDL は、動的に多様なワークロードをサポートするように設計されている、ReFS の先進的な機能の一例です。

- **[ミラーリングによって高速化されたパリティ](./mirror-accelerated-parity.md)** : ミラーリングによって高速化されたパリティは、パフォーマンスと容量効率の高い、データの記憶域を提供します。

    - パフォーマンスと容量効率の高い記憶域を提供するために、ReFS は、ボリュームを階層と呼ばれる 2 つの論理記憶域グループに分割します。 これらの階層ではそれぞれドライブと回復性の種類を設定でき、各階層をパフォーマンスまたは容量について最適化することができます。 構成の例の一部を以下に示します。

      | パフォーマンス レベル | 容量階層 |
      | ---------------- | ----------------- |
      | ミラー SSD | ミラー HDD |
      | ミラー SSD | パリティ SSD |
      | ミラー SSD | パリティ HDD |

    - これらの階層を構成すると、ReFS はこれらの階層を使用して、ホット データには高速記憶域を、コールド データには容量効率の高い記憶域を提供します。
        - すべての書き込みはパフォーマンス階層で発生し、パフォーマンス階層に残っているデータの大規模なチャンクはリアルタイムで容量階層に効率的に移動されます。
        - ハイブリッド展開 (フラッシュドライブと HDD ドライブの混在) を使用している場合、 [記憶域スペースダイレクトのキャッシュ](../storage-spaces/understand-the-cache.md) によって読み取りが高速化され、仮想化されたワークロードのデータの断片化の特性の影響が軽減されます。 それ以外の場合、すべての-flash 展開を使用すると、パフォーマンスレベルでも読み取りが発生します。

> [!NOTE]
> サーバーの展開では、ミラーリングによって高速化されたパリティは、[記憶域スペース ダイレクト](../storage-spaces/storage-spaces-direct-overview.md)でのみサポートされます。 アーカイブとバックアップのワークロードでのみ、ミラーアクセラレータのパリティを使用することをお勧めします。 仮想化された、その他の高パフォーマンスランダムワークロードの場合は、パフォーマンス向上のために3方向ミラーを使用することをお勧めします。

- **VM の操作の高速化** - ReFS では、仮想化されたワークロードのパフォーマンスを向上させる新機能が導入されています。
    - [ブロックの複製](./block-cloning.md) - ブロックの複製によってコピー操作が高速化されるため、VM のチェックポイントのマージ操作をすばやく実行し、影響を抑えることができます。
    - スパース VDL - ReFS では、スパース VDL によってファイルを迅速にセロ化することができ、固定 VHD を作成するために必要な時間が数十分からわずか数秒に短縮されます。

- **可変クラスター サイズ** - ReFS では、4 K と 64 K の両方のクラスター サイズをサポートしています。 ほとんどの展開で推奨されるクラスター サイズは 4 K ですが、サイズの大きい順次 IO ワークロードには 64 K クラスターが適しています。

### <a name="scalability"></a>スケーラビリティ

ReFS は、非常に大きなデータ セット (数百万テラバイト) をサポートするように設計されており、パフォーマンスを損なうことなく、以前のファイル システムよりも大きいスケールを実現します。

## <a name="supported-deployments"></a>サポートされているデプロイ

Microsoft では、さまざまな構成やワークロードでの汎用的な使用専用に NTFS を開発していますが、ReFS が提供する可用性、回復性、およびスケールを特別に必要とするお客様には、次の構成とシナリオでの ReFS の使用がサポートされています。

> [!NOTE]
> 参照がサポートされているすべての構成では、 [Windows Server Catalog](https://www.WindowsServerCatalog.com) 認定ハードウェアを使用し、アプリケーションの要件を満たす必要があります。

### <a name="storage-spaces-direct"></a>記憶域スペース ダイレクト

記憶域スペース ダイレクトへの ReFS の展開は、仮想化されたワークロードやネットワーク接続ストレージで推奨されるセットアップ方法です。
- ミラーリングによって高速化されたパリティと[記憶域スペース ダイレクトのキャッシュ](../storage-spaces/understand-the-cache.md)によって、高パフォーマンスで容量効率の高い記憶域が提供されます。
- ブロックの複製とスパース VDL の導入により、.vhdx ファイルの作成、マージ、拡張などの操作が大幅に高速化されます。
- 整合性ストリーム、オンライン修復、および代替のデータコピーにより、ReFS と記憶域スペースダイレクトは、メタデータとデータの両方で、記憶域コントローラーと記憶域メディアの破損を検出して修正することができます。
- ReFS は、拡張して大規模なデータ セットをサポートするための機能を提供します。

### <a name="storage-spaces"></a>記憶域スペース

- 整合性ストリーム、オンライン修復、および代替のデータコピーにより、ReFS と [記憶域スペース](../storage-spaces/overview.md) は、メタデータとデータの両方で、記憶域コントローラーと記憶域メディアの破損を検出して修正することができます。
- また、記憶域スペースの展開では、ブロックの複製や ReFS が提供するスケーラビリティを利用することもできます。
- 共有 SAS エンクロージャを使用した記憶域スペースへの ReFS の展開は、アーカイブデータのホストとユーザードキュメントの保存に適しています。

> [!NOTE]
> 記憶域スペースは、BusTypes SATA、SAS、NVME を介して、または HBA (パススルーモードでは RAID コントローラー) を介して接続されている、ローカルの非リムーバブル直接接続をサポートします。

### <a name="basic-disks"></a>ベーシック ディスク

ベーシックディスクへの ReFS の展開は、独自のソフトウェア回復性と可用性ソリューションを実装するアプリケーションに最適です。
- 独自の回復性と可用性のソフトウェア ソリューションを導入するアプリケーションには、整合性ストリーム、ブロックの複製、大規模なデータ セットに合わせてスケーリングしサポートする機能を活用できます。

> [!IMPORTANT]
> CSV (クラスターの共有ボリューム) に ReFS を使用する予定がある場合は、参照を使用して後の CSV ボリュームを事前にフォーマットするための制限事項を検討してください。
> CSV の場合: 従来の San では NTFS を使用する必要があります。 S2D の上で ReFS を使用する必要があります。

> [!NOTE]
> ベーシックディスクには、BusTypes SATA、SAS、NVME、または RAID を使用した、ローカルの非リムーバブル直接接続が含まれます。 ベーシックディスクには、記憶域スペースは含まれません。

### <a name="backup-target"></a>バックアップ ターゲット

ReFS をバックアップターゲットとして展開することは、独自の回復性と可用性ソリューションを実装するアプリケーションとハードウェアに最適です。
- 独自の回復性と可用性のソフトウェア ソリューションを導入するアプリケーションには、整合性ストリーム、ブロックの複製、大規模なデータ セットに合わせてスケーリングしサポートする機能を活用できます。

> [!NOTE]
> バックアップターゲットには、上記のサポートされている構成が含まれます。 ファイバーチャネルと iSCSI San のサポートの詳細については、アプリケーションおよび記憶域配列ベンダーにお問い合わせください。 San では、仮想プロビジョニング、トリム/マッピング解除、オフロードデータ転送 (ODX) などの機能が必要な場合は、NTFS を使用する必要があります。

## <a name="feature-comparison"></a>機能の比較

### <a name="limits"></a>制限

| 機能       | ReFS                                        | NTFS |
|----------------|------------------------------------------------|-----------------------|
| ファイル名の最大長 | 255 Unicode 文字  | 255 Unicode 文字               |
| パス名の最大長 |32 K Unicode 文字 | 32 K Unicode 文字                |
| ファイルの最大サイズ | 35 PB (ペタバイト)  | 256 TB               |
| 最大ボリューム サイズ | 35 PB                           | 256 TB                |

### <a name="functionality"></a>機能

#### <a name="the-following-features-are-available-on-refs-and-ntfs"></a>ReFS と NTFS で使用できる機能は次のとおりです。

| 機能       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| BitLocker 暗号化 | はい | はい |
| データ重複除去 | 可<sup>1</sup> | はい |
| クラスター共有ボリューム (CSV) のサポート | はい<sup>2</sup> <sup>4</sup> | はい |
| ソフト リンク | はい | はい |
| フェールオーバー クラスターのサポート | はい | はい |
| アクセス制御リスト | はい | はい |
| USN ジャーナル | はい | はい |
| 変更通知 | はい | はい |
| 接合ポイント | はい | はい |
| マウント ポイント | はい | はい |
| 再解析ポイント | はい | はい |
| ボリューム スナップショット | はい | はい |
| ファイル ID | はい | はい |
| oplock | はい | はい |
| スパース ファイル | はい | はい |
| 名前付きストリーム | はい | はい |
| 仮想プロビジョニング | ○<sup>3</sup> | はい |
| トリミング/マップ解除 | ○<sup>3</sup> | はい |
1. Windows Server バージョン1709以降、Windows Server 2019 (1809) LTSC 以降で使用できます。
2. Windows Server 2012 R2 以降で使用できます。
3. 記憶域スペースのみ
4. CSV では、記憶域スペース、記憶域スペースダイレクト (S2D)、または SAN との接合に直接 i/o が使用されません。

#### <a name="the-following-features-are-only-available-on-refs"></a>ReFS のみで使用できる機能は次のとおりです。

| 機能       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| ブロックの複製 | はい | いいえ |
| スパース VDL | はい | いいえ |
| ミラー高速パリティ| 〇 (記憶域スペース ダイレクト上) | いいえ |

#### <a name="the-following-features-are-unavailable-on-refs-at-this-time"></a>現時点では、ReFS で次の機能は利用できません。

| 機能       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| ファイル システムの圧縮 | いいえ | はい |
| ファイル システムの暗号化 | いいえ | はい |
| トランザクション | いいえ | はい |
| ハード リンク | 可<sup>1</sup> | はい |
| オブジェクト ID | いいえ | はい |
| オフロードデータ転送 (ODX) | いいえ | はい |
| 短い名前 | いいえ | はい |
| 拡張属性 | いいえ | はい |
| ディスク クォータ | いいえ | はい |
| 起動可能 | いいえ | はい |
| ページファイルのサポート | いいえ | はい |
| リムーバブル メディアでのサポート | いいえ | はい |

1. バージョン ReFS 3.5 は、Windows 10 Enterprise Insider Preview build 19536 によって書式設定されています。 新しくフォーマットされたボリュームの場合は、ハードリンクサポートを追加しました **。以前のバージョンからアップグレードした場合は、ハードリンクを使用できません**

## <a name="additional-references"></a>その他の参照情報

- [ReFS および NTFS のクラスター サイズに関する推奨事項](https://techcommunity.microsoft.com/t5/Storage-at-Microsoft/Cluster-size-recommendations-for-ReFS-and-NTFS/ba-p/425960)
- [記憶域スペース ダイレクトの概要](../storage-spaces/storage-spaces-direct-overview.md)
- [ReFS のブロックの複製](block-cloning.md)
- [ReFS 整合性ストリーム](integrity-streams.md)
- [ReFSUtil を使用した ReFS のトラブルシューティング](../../administration/windows-commands/refsutil.md)
- [Cluster-Shared ボリュームでの ReFS の使用](../../failover-clustering/failover-cluster-csvs.md)
- [ReFS バージョンと互換性のマトリックス](https://gist.github.com/0xbadfca11/da0598e47dd643d933dc)
