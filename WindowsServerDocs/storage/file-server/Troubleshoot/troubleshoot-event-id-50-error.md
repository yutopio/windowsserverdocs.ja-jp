---
title: イベント ID 50 のエラーメッセージのトラブルシューティング
description: イベント ID 50 のエラーメッセージをトラブルシューティングする方法について説明します。
author: Deland-Han
manager: dcscontentpm
ms.topic: article
ms.author: delhan
ms.date: 12/25/2019
ms.openlocfilehash: 930a503f756bf2005e26ac227565b42b627ee11a
ms.sourcegitcommit: 39d55b5a0006aceac6281e8cdb61fc79a209ce1b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/04/2020
ms.locfileid: "93328132"
---
# <a name="troubleshoot-the-event-id-50-error-message"></a>イベント ID 50 のエラーメッセージのトラブルシューティング

##  <a name="symptoms"></a>現象

情報が物理ディスクに書き込まれるときに、次の2つのイベントメッセージがシステムイベントログに記録されることがあります。 

```
Event ID: 50 
Event Type: Warning 
Event Source: Ftdisk 
Description: {Lost Delayed-Write Data} The system was attempting to transfer file data from buffers to \Device\HarddiskVolume4. The write operation failed, and only some of the data may have been written to the file.
Data: 
0000: 00 00 04 00 02 00 56 00 
0008: 00 00 00 00 32 00 04 80 
0010: 00 00 00 00 00 00 00 00 
0018: 00 00 00 00 00 00 00 00 
0020: 00 00 00 00 00 00 00 00 
0028: 11 00 00 80 
```

```
Event ID: 26 
Event Type: Information
Event Source: Application Popup
Description: Windows - Delayed Write Failed : Windows was unable to save all the data for the file \Device\HarddiskVolume4\Program Files\Microsoft SQL Server\MSSQL$INSTANCETWO\LOG\ERRORLOG. The data has been lost. This error may be caused by a failure of your computer hardware or network connection.

Please try to save this file elsewhere.
```

これらのイベント ID メッセージは、まったく同じことを意味し、同じ理由から生成されます。 この記事では、イベント ID 50 のメッセージのみを説明します。

> [!NOTE] 
> 説明および特定の16進数データのデバイスとパスは異なります。 

##  <a name="more-information"></a>詳細情報

Windows がディスクに情報を書き込もうとしているときに一般的なエラーが発生すると、イベント ID 50 のメッセージがログに記録されます。 このエラーは、Windows が (ハードウェアレベルのキャッシュではなく) ファイルシステムキャッシュマネージャーから物理ディスクにデータをコミットしようとしたときに発生します。 この動作は、Windows のメモリ管理の一部です。 たとえば、プログラムが書き込み要求を送信した場合、書き込み要求はキャッシュマネージャーによってキャッシュされ、書き込みが正常に完了したという指示がプログラムによって示されます。 キャッシュマネージャーは、後の時点で、データを物理ディスクに遅延書き込みしようとします。 キャッシュマネージャーがデータをディスクにコミットしようとすると、データの書き込み中にエラーが発生し、データがキャッシュからフラッシュされ、破棄されます。 ライトバックキャッシュを使用すると、システムのパフォーマンスが向上しますが、遅延書き込みエラーが失われた結果としてデータ損失とボリュームの整合性が失われる可能性があります。

すべての i/o がキャッシュマネージャーによってバッファー i/o されるわけではないことに注意してください。 プログラムでは、キャッシュマネージャーをバイパスする FILE_FLAG_NO_BUFFERING フラグを設定できます。 SQL がデータベースへの重要な書き込みを実行するとき、このフラグは、トランザクションが直接ディスクに対して完了することを保証するように設定されます。 たとえば、ログファイルへの重要ではない書き込みでは、全体的なパフォーマンスを向上させるためにバッファー i/o が実行されます。 イベント ID 50 のメッセージがバッファリングされていない i/o から生成されることはありません。

イベント ID 50 メッセージには、いくつかの異なるソースがあります。 たとえば、MRxSmb ソースからログに記録されたイベント ID 50 のメッセージは、リダイレクターにネットワーク接続の問題がある場合に発生します。 不適切なトラブルシューティング手順を実行しないようにするには、イベント ID 50 のメッセージを確認して、ディスク i/o の問題を示していることと、この記事が適用されていることを確認してください。

イベント ID 50 のメッセージは、イベント ID 9 とイベント ID 11 のメッセージに似ています。 このエラーは、イベント ID 9 とイベント ID 11 のメッセージで示されているエラーほど重大ではありませんが、イベント id 9 とイベント ID 11 メッセージの場合と同じように、イベント ID 50 メッセージに対して同じトラブルシューティング手法を使用できます。 ただし、スタック内のすべてのものが原因で、フィルタードライバーやミニポートドライバーなどの遅延書き込みが失われる可能性があることに注意してください。 

付随する "ディスク" エラー (イベント ID 9、11、51エラーメッセージ、またはその他のメッセージ) に関連付けられているバイナリデータを使用して、問題の特定に役立てることができます。

###  <a name="how-to-decode-the-data-section-of-an-event-id-50-event-message"></a>イベント ID 50 イベントメッセージのデータセクションをデコードする方法 

"Summary" セクションに含まれているイベント ID 50 メッセージの例でデータセクションをデコードすると、デバイスがビジー状態でデータが失われたため、書き込み操作の試行が失敗したことがわかります。 このセクションでは、このイベント ID 50 メッセージをデコードする方法について説明します。 

次の表は、このメッセージの各オフセットの意味を示しています。 

|OffsetLengthValues|長さ|値|
|-----------|------------|---------|
|0x00|2|未使用|
|0x02|2|ダンプデータサイズ = 0x0004|
|0x04|2|文字列の数 = 0x0002|
|0x06|2|文字列へのオフセット|
|0x08|2|イベント カテゴリ|
|0x0c|4|NTSTATUS エラーコード = 0x80040032 = IO_LOST_DELAYED_WRITE|
|0x10|8|未使用|
|0x18|8|未使用|
|0x20|8|未使用|
|0x28|4|NT 状態エラーコード|

#### <a name="key-sections-to-decode"></a>デコードするキーセクション

**エラーコード**

"Summary" セクションの例では、エラーコードが2行目に表示されています。 この行は "0008:" で始まります。この例では、0008:00 00 00 00 32 00 04 80 の行に最後の4バイトが含まれています。この場合、エラーコードは0x80040032 です。 次のコードはエラー50のコードであり、すべてのイベント ID 50 メッセージで同じです。 IO_LOST_DELAYED_WRITEWARNINGNote イベント ID メッセージの16進データをステータスコードに変換する場合、値はリトルエンディアン形式で表されることに注意してください。

**ターゲットディスク**

書き込みが試行されていたディスクを特定するには、イベント ID メッセージの "説明" セクションのドライブに表示されているシンボリックリンクを使用します。たとえば、\Device\HarddiskVolume4. のように指定します。

**最終的な状態コード**

最終的な状態コードは、イベント ID 50 のメッセージに含まれる最も重要な情報です。 これは、i/o 要求が行われたときに返されるエラーコードであり、情報の主要なソースです。 "Summary" セクションの例では、最終的な状態コードは 0x28 (6 行目) に表示されます。これは、"0028:" で始まり、この行には4つのオクテットのみ含まれています。 

```
0028: 11 00 00 80 
```

この場合、最終ステータスは0x80000011 と等しくなります。この状態コードは STATUS_DEVICE_BUSY にマップされ、デバイスが現在ビジー状態であることを意味します。

> [!NOTE] 
> イベント ID 50 メッセージの16進データをステータスコードに変換する場合、値はリトルエンディアン形式で表されることに注意してください。 状態コードは関心のある唯一の情報であるため、バイトではなく、データをワード形式で表示する方が簡単な場合があります。 この場合、バイトは正しい形式になり、データの解釈が簡単になる可能性があります。

これを行うには、[ **イベントのプロパティ** ] ウィンドウで [ **単語** ] をクリックします。 データワードビューでは、"Symptoms" セクションの例は次のように読み取られます。 Data: 

```
() Bytes (.) 
Words 0000: 00040000 00560002 00000000 80040032 0010: 00000000 00000000 00000000 00000000 0020: 00000000 00000000 80000011
```

Windows NT の状態コードの一覧を取得するには、「NTSTATUS」を参照してください。Windows Software デベロッパーキット (SDK) の H。
