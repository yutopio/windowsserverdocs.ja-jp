---
title: rundll32 printui.dll、PrintUIEntry
description: PrintUIEntry コマンドの参照 printui.dll 記事。これにより、多くのプリンター構成タスクが自動化されます。
ms.topic: reference
ms.assetid: 12fb48b6-5dd8-4cc0-8808-e6a681aceb84
ms.author: lizross
author: eross-msft
manager: mtillman
ms.date: 05/25/2018
ms.openlocfilehash: 8ad0b9b3cfdca8d9ed82cc980d29df7c885bac46
ms.sourcegitcommit: e164aeffc01069b8f1f3248bf106fcdb7f64f894
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/26/2020
ms.locfileid: "91388453"
---
# <a name="rundll32-printuidllprintuientry"></a>rundll32 printui.dll、PrintUIEntry

> 適用対象: Windows Server (半期チャネル)、Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

さまざまなプリンター構成タスクを自動化します。 printui.dll は、プリンターの構成ダイアログボックスによって使用される関数を含む実行可能ファイルです。 スクリプトまたはコマンドライン バッチ ファイル内でこれらの関数がから呼び出すこともできますか、コマンド プロンプトから対話的に実行できます。

## <a name="syntax"></a>構文

```
rundll32 printui.dll PrintUIEntry [baseparameter] [modificationparameter1] [modificationparameter2] [modificationparameterN]
```

このトピックの例では、前の構文を使用しても、次の代替の構文を使用できます。

```
rundll32 printui.dll,PrintUIEntry [baseparameter] [modificationparameter1] [modificationparameter2] [ModificationParameterN]
```

```
rundll32 printui PrintUIEntry [baseparameter] [modificationparameter1] [modificationparameter2] [modificationparameterN]
```

```
rundll32 printui,PrintUIEntry [baseparameter] [modificationparameter1] [modificationparameter2] [modificationparameterN]
```

### <a name="parameters"></a>パラメーター

パラメーターの 2 種類があります。 base パラメーターおよびパラメーターを変更します。 基本のパラメーターは、コマンドが実行するには、関数を指定します。 これらのパラメーターの 1 つのみが、指定したコマンド ラインで表示できます。 次に、(基本のすべてのパラメーターで変更のすべてのパラメーターがサポートされます)、基本パラメーターに適用している場合、変更のパラメーターの 1 つ以上を使用して、基本パラメーターを変更できます。

| 基本パラメーター | [説明] |
|--|--|
| /dl | ローカル プリンターを削除します。 |
| /dn | ネットワーク プリンター接続を削除します。 |
| /dd | プリンタ ドライバを削除します。 |
| /e | 特定のプリンターの印刷の設定を表示します。 |
| /ga | コンピューターごとのプリンター接続を追加します (接続は、ログオン時にそのコンピューター上のすべてのユーザーが使用できます)。 |
| /ge | ごとのコンピューター上のコンピューターのプリンター接続を表示します。 |
| /gd | 削除するコンピューターごとのプリンター接続 (接続には、次回、ユーザーがログインも削除されます)。 |
| /ia | .Inf ファイルを使用してプリンター ドライバーをインストールします。 |
| /id | プリンタードライバーの追加ウィザードを使用して、プリンタードライバーをインストールします。 |
| /if | .Inf ファイルを使用してプリンターをインストールします。 |
| /ii | プリンターの追加ウィザードと .inf ファイルを使用して、プリンターをインストールします。 |
| /il | プリンターの追加ウィザードを使用して、プリンターをインストールします。 |
| /in | リモート ネットワーク プリンターに接続します。 |
| /ip | ネットワークプリンターのインストールウィザードを使用してプリンターをインストールします ([印刷の管理] のユーザーインターフェイスから利用できます)。 |
| /k | プリンターでテストページを印刷します。 |
| /o | プリンターのキューを表示します。 |
| /p | プリンターのプロパティを表示します。 このパラメーターを使用する場合は、変更のパラメーターの値も指定する必要があります **/n [name]** します。 |
| /s | プリント サーバーのプロパティを表示します。 ローカル プリント サーバーを表示する場合は、変更のパラメーターを使用する必要はありません。 ただし、リモート プリント サーバーを表示する場合を指定してください、 **/c [name]** パラメーターを変更します。 |
| /Ss | 格納は、プリンターの情報の種類を指定します。 値のない場合 **/Ss** が指定されている既定の動作は、それらのすべてが指定されているかのようです。 この基本パラメーターを使用して、コマンドラインの末尾に配置する次の値で。<ul><li>**2**: プリンター s printER_INFO_2 構造に含まれている情報を格納します。 この構造体には、その名前、サーバー名、ポート名、および共有名などのプリンターに関する基本的な情報が含まれています。</li><li>**7**: printER_INFO_7 構造に含まれるディレクトリサービス情報を格納するために使用します。</li><li>**c**: プリンターのカラープロファイル情報を格納します。</li><li>**d**: プリンターのハードウェア ID などのプリンター固有のデータを格納します。</li><li>**s**: プリンターのセキュリティ記述子を格納します。</li><li>**g**: プリンターのグローバル DEVmode 構造体に情報を格納します。</li><li>**m**: プリンターの最小設定を格納します。 これは指定することと同じ **2** **d**, 、および **g**します。</li><li>**u**: プリンター s のユーザーの DEVmode 構造体に情報を格納します。</li></ul> |
| /Sr | プリンターに関する情報が復元され、設定の競合の処理方法を指定します。 コマンドラインの末尾に配置する次の値を使用します。<ul><li>**2**: プリンター s printER_INFO_2 構造に含まれる情報を復元します。 この構造体には、その名前、サーバー名、ポート名、および共有名などのプリンターに関する基本的な情報が含まれています。</li><li>**7**: printER_INFO_7 構造に含まれるディレクトリサービス情報を復元します。</li><li>**c**: プリンターのカラープロファイル情報を復元します。</li><li>**d**: プリンターのハードウェア ID など、プリンター固有のデータを復元します。</li><li>**s**: プリンターのセキュリティ記述子を復元します。</li><li>**g**: プリンター s グローバル DEVmode 構造体の情報を復元します。</li><li>**m**: プリンターの最小設定を復元します。 これは指定することと同じ **2**, 、**d**, 、および **g**します。</li><li>**u** は、ユーザーごとの DEVmode 構造体の情報を復元します。</li><li>**r**: ファイルに格納されているプリンタの名前が復元されるプリンターの名前と異なる場合は、現在のプリンター名を使用します。 これを指定することはできません **f**します。 どちらの場合 **r** も **f** が指定されている名前が一致しない場合は、設定の復元に失敗します。</li><li>**f**: ファイルに格納されているプリンタの名前が復元されるプリンターの名前と異なる場合は、ファイルでプリンター名を使用しています。 これを指定することはできません **r**します。 どちらの場合 **f** も **r** が指定されている名前が一致しない場合は、設定の復元に失敗します。</li><li>**p**: から復元されるファイルのポート名が、復元されるプリンターの現在のポート名と一致しない場合、プリンターの現在のポート名が使用されます。</li><li>**h**: 復元されるプリンターを、保存された設定ファイルのリソース共有名を使用して共有できなかった場合は、現在の共有名または新しい共有名のいずれかを使用してプリンターの共有を試行します。 **h** も **h** も指定されていない場合、復元されるプリンターが保存された共有名と共有できない</li><li>**h**: 場合は、プリンターへの復元中は、保存した共有名と共有できない、し、プリンターを共有しないのです。 どちらの場合 **H** も **h** が指定されているプリンターへの復元中は、保存した共有名と共有できないし、復元に失敗します。</li><li>****: 保存された設定ファイル内のドライバーが復元されるプリンターのドライバーと一致しないかどうかは、復元は失敗します。 |
| /Xg | プリンターの設定を取得します。 |
| /Xs | プリンターの設定を行います。 |
| /y | 通常使うプリンターとしてインストールされているプリンターを設定します。 |
| /? | コマンドとそれに関連付けられているパラメーターの製品内ヘルプを表示します。 |
| @[ファイル] | コマンドライン引数を使ってファイルを指定し、直接コマンドラインにそのファイルにテキストを挿入します。 |

| パラメーターの変更 | [説明] |
|--|--|
| /a [ファイル] | バイナリ ファイルの名前を指定します。 |
| /b [name] | 基本のプリンターの名前を指定します。 |
| /c [name] | 実行するアクションがリモート コンピューター上にある場合は、コンピューター名を指定します。 |
| /f [ファイル] | 汎用名前付け規則 (UNC) パスを指定し、.inf ファイル名または実行しているタスクによって、出力ファイル名の名前。 使用 **/F [ファイル]** 依存 .inf ファイルを指定します。 |
| /F [ファイル] | 指定した .inf ファイルの .inf ファイルの名前と UNC パスを指定 **/f [ファイル]** に依存します。 |
| /h [アーキテクチャ] | ドライバーのアーキテクチャを指定します。 次のいずれかを使用します。 **x86**, 、**x64**, 、または **Itanium**します。 |
| /j [プロバイダー] | 印刷のプロバイダー名を指定します。 |
| /l [パス] | 使用しているプリンター ドライバーのファイルが置かれている UNC パスを指定します。 |
| /m [モデル] | ドライバー モデル名を指定します。 (この値は、.inf ファイルで指定することができます)。 |
| /n [name] | プリンター名を指定します。 |
| /q | ユーザーに通知なしで、コマンドを実行します。 |
| /r [ポート] | ポートの名前を指定します。 |
| /U | 既にインストールされている場合は、既存のプリンター ドライバーを使用するように指定します。 |
| /t[#] | 開始する 0 から始まるインデックス ページを指定します。 |
| /v [バージョン] | ドライバーのバージョンを指定します。 **/K**の値も指定しない場合は、 **Type 2-Kernel mode**または**type 3-User mode**のいずれかの値を指定する必要があります。 |
| /w | **/f**によって指定された .inf ファイルにドライバーが見つからない場合に、ユーザーにドライバーの入力を求めます。 |
| /Y | プリンターの名前が自動的に生成できなかったことを指定します。 |
| /z | 自動的にインストールされているプリンタの共有を指定します。 |
| /K | パラメーター **/h [architecture]** の意味を変更して、 **x86**の代わりに**2**を、 **x64**の代わりに**3** 、 **Itanium**の代わりに**4**を受け入れるようにします。 また、パラメーター **/v [version]** の値を、**型 2-カーネルモード**の代わりに**2**を使用するように変更し、3 **-ユーザーモード****にし**ます。 |
| /Z | インストールされているプリンターを共有します。 のみ使用して、 **/if** パラメーター。 |
| /Mw [メッセージ] | コマンドラインで指定した変更をコミットする前に、ユーザーに警告メッセージを表示します。 |
| /Mq [メッセージ] | コマンドラインで指定した変更をコミットする前に、ユーザーに確認メッセージを表示します。 |
| /W [フラグ] | プリンターの追加ウィザード、プリンタードライバーの追加ウィザード、およびネットワークプリンターのインストールウィザードのパラメーターまたはオプションを指定します。<p>**r**: 最後のページから再起動するウィザードを使用します。 |
| /G [フラグ] | グローバル パラメーターを使用するオプションを指定します。<p>**w**: セットアップ ドライバーへのユーザーに警告を抑制します。 |

#### <a name="remarks"></a>解説

- **PrintUIEntry** キーワードは大文字と小文字を区別して正確な大文字と小文字のこのトピックの例に示すように、このコマンドの構文を入力する必要があります。

- コマンド プロンプトで、他の例について: **rundll32 printui.dll,PrintUIEntry/でしょうか。**

## <a name="examples"></a>例

新しいリモートプリンター printer1 を追加するには、このコマンドを実行するユーザーアカウントに表示される Client1 というコンピューターに、次のように入力します。

```
rundll32 printui.dll PrintUIEntry /in /n\\client1\printer1
```

プリンターの追加ウィザードを使用して .inf ファイルを使用し、プリンターを追加するには、次のように入力します。

```
rundll32 printui.dll PrintUIEntry /ii /f c:\Infpath\InfFile.inf
```

既存のプリンター printer1 を削除するには、コンピューターの Client1 で、次のように入力します。

```
rundll32 printui.dll PrintUIEntry /dn /n\\client1\printer1
```

コンピューターごとのプリンター接続 (printer2) を追加するには、次のように入力します (ユーザーがログオンしたときに接続が適用されます)。

```
rundll32 printui.dll PrintUIEntry /ga /n\\client2\printer2
```

コンピューターごとのプリンター接続 (printer2) を削除するには、次のように入力します (ユーザーがログオンすると、接続は削除されます)。

```
rundll32 printui.dll PrintUIEntry /gd /n\\client2\printer2
```

プリントサーバー printServer1 のプロパティを表示するには、次のように入力します。

```
rundll32 printui.dll PrintUIEntry /s /t1 /c\\printserver1
```

Printer3 プリンターのプロパティを表示するには、次のように入力します。
```
rundll32 printui.dll PrintUIEntry /p /n\\printer3
```

## <a name="additional-references"></a>その他のリファレンス

- [rundll32](rundll32.md)

- [印刷コマンドのリファレンス](print-command-reference.md)
