---
ms.assetid: d92731f1-e4d8-4223-9b07-ca1f40bb0e1f
title: 名前空間の不整合
author: iainfoulds
ms.author: daveba
manager: daveba
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 76733e31497ab92ab54cb583b9db88b989400389
ms.sourcegitcommit: b115e5edc545571b6ff4f42082cc3ed965815ea4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2020
ms.locfileid: "93068734"
---
# <a name="disjoint-namespace"></a>名前空間の不整合

> 適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

不整合な名前空間は、1つまたは複数のドメインメンバーコンピューターのプライマリドメインネームサービス (DNS) サフィックスが、そのコンピューターが属する Active Directory ドメインの DNS 名と一致しない場合に発生します。 たとえば、na.corp.fabrikam.com という名前の Active Directory ドメインで corp.fabrikam.com のプライマリ DNS サフィックスを使用しているメンバーコンピューターは、不整合のある名前空間を使用しています。

不整合な名前空間は、連続した名前空間よりも管理、保守、トラブルシューティングがより複雑になります。 連続する名前空間では、プライマリ DNS サフィックスは Active Directory ドメイン名と一致します。 Active Directory 名前空間が、不整合な名前空間では、すべてのドメインメンバーコンピューターのプライマリ DNS サフィックスと同じであると想定するように記述されたネットワークアプリケーションは、正しく機能しません。

## <a name="support-for-disjoint-namespaces"></a>不整合な名前空間のサポート

ドメインコントローラーを含むドメインメンバーコンピューターは、不整合な名前空間で機能することができます。 ドメインメンバーコンピューターは、そのホスト (A) リソースレコードと IP version 6 (IPv6) ホスト (AAAA) リソースレコードを、不整合のある DNS 名前空間に登録できます。 ドメインメンバーコンピューターがこのようにリソースレコードを登録すると、ドメインコントローラーは、Active Directory ドメイン名と同じ DNS ゾーンに、グローバルリソースレコードとサイト固有のサービス (SRV) リソースレコードを引き続き登録します。

たとえば、corp.fabrikam.com のプライマリ DNS サフィックスを使用する na.corp.fabrikam.com という名前の Active Directory ドメインのドメインコントローラーが、corp.fabrikam.com DNS ゾーンのホスト (A) リソースレコードと IPv6 ホスト (AAAA) リソースレコードを登録しているとします。 ドメインコントローラは、グローバルリソースレコードとサイト固有サービス (SRV) リソースレコードを _msdcs. na.corp.fabrikam.com DNS ゾーンに登録し続けます。これにより、サービスの場所が可能になります。

> [!IMPORTANT]
> Windows オペレーティングシステムは不整合な名前空間をサポートする場合がありますが、プライマリ DNS サフィックスが Active Directory ドメインサフィックスと同じであると想定するように記述されたアプリケーションは、このような環境では機能しない可能性があります。 このため、不整合な名前空間を展開する前に、すべてのアプリケーションとそのオペレーティングシステムを慎重にテストする必要があります。

不整合のある名前空間は、次のような場合に機能します (およびサポートされます)。

- 複数の Active Directory ドメインを持つフォレストが1つの DNS 名前空間を使用する場合 (DNS ゾーンとも呼ばれます)

    この例として、na.corp.fabrikam.com、sa.corp.fabrikam.com、asia.corp.fabrikam.com などの名前を持つ地域ドメインを使用し、corp.fabrikam.com などの単一の DNS 名前空間を使用する企業が挙げられます。

- 1つの Active Directory ドメインが個別の DNS 名前空間に分割される場合

    この例として、hr.corp.contoso.com、production.corp.contoso.com、it.corp.contoso.com などの DNS ゾーンを使用する corp.contoso.com の Active Directory ドメインがある企業が挙げられます。

不整合な名前空間は、次の状況では正しく機能しません (およびサポートされません)。

- ドメインメンバーが使用する不整合のあるサフィックスは、このまたは別のフォレスト内の Active Directory ドメイン名と一致します。 これにより、Kerberos の名前サフィックスルーティングが中断します。

- 同じ不整合サフィックスが別のフォレストで使用されています。 これにより、フォレスト間でこれらのサフィックスを一意にルーティングできなくなります。

- ドメインメンバー証明機関 (CA) サーバーが完全修飾ドメイン名 (FQDN) を変更すると、CA サーバーがメンバーとなっているドメインのドメインコントローラーによって使用されるのと同じプライマリ DNS サフィックスを使用しなくなります。 この場合、CRL 配布ポイントで使用されている DNS 名に応じて、CA サーバーが発行した証明書の検証で問題が発生する可能性があります。 ただし、安定していない名前空間に CA サーバーを配置すると、正常に動作し、サポートされます。

## <a name="considerations-for-disjoint-namespaces"></a>不整合な名前空間に関する考慮事項

次の考慮事項は、不整合な名前空間を使用する必要があるかどうかを判断するのに役立ちます。

### <a name="application-compatibility"></a>アプリケーションの互換性

既に説明したように、不整合な名前空間は、コンピューターのプライマリ DNS サフィックスがメンバーとなっているドメイン名と同じであることを想定するために記述されたアプリケーションやサービスに関して、問題を引き起こす可能性があります。 不整合のある名前空間を展開する前に、アプリケーションの互換性の問題を確認する必要があります。 また、分析を実行するときに使用するすべてのアプリケーションの互換性を確認してください。 これには、Microsoft および他のソフトウェア開発者からのアプリケーションが含まれます。

### <a name="advantages-of-disjoint-namespaces"></a>不整合な名前空間の利点

不整合な名前空間を使用すると、次のような利点があります。

- コンピューターのプライマリ DNS サフィックスは異なる情報を示す可能性があるため、DNS 名前空間を Active Directory ドメイン名とは別に管理できます。

- DNS 名前空間は、ビジネスの構造または地理的な場所に基づいて分けることができます。 たとえば、名前空間は、事業単位名または大陸、国/地域、建物などの物理的な場所に基づいて分けることができます。

### <a name="disadvantages-of-disjoint-namespaces"></a>不整合な名前空間の短所

不整合な名前空間を使用すると、次のような欠点があります。

- 不整合な名前空間を使用するメンバーコンピューターが存在するフォレスト内の Active Directory ドメインごとに、個別の DNS ゾーンを作成して管理する必要があります。 (つまり、追加の複雑な構成が必要です)。

- ドメインメンバーが指定されたプライマリ DNS サフィックスを使用できるようにする Active Directory 属性を変更および管理するには、手動の手順を実行する必要があります。

- 名前解決を最適化するには、グループポリシーを変更して維持するための手動の手順を実行して、代替プライマリ DNS サフィックスを持つメンバーコンピューターを構成する必要があります。

> [!NOTE]
> Windows インターネットネームサービス (WINS) を使用して、単一ラベル名を解決することでこの欠点を相殺できます。 WINS の詳細については、「 [Wins テクニカルリファレンス](/previous-versions/windows/it-pro/windows-server-2003/cc736411(v=ws.10))」を参照してください。

- 環境に複数のプライマリ DNS サフィックスが必要な場合は、フォレスト内のすべての Active Directory ドメインの DNS サフィックス検索順序を適切に構成する必要があります。

    DNS サフィックスの検索順序を設定するには、グループポリシーオブジェクトまたは動的ホスト構成プロトコル (DHCP) サーバーサービスのパラメーターを使用します。 レジストリを変更することもできます。

- すべてのアプリケーションの互換性の問題を注意深くテストする必要があります。

これらの欠点に対処するために実行できる手順の詳細については、「 [不整合な名前空間を作成](/previous-versions/windows/it-pro/windows-server-2003/cc755926(v=ws.10))する」を参照してください。

### <a name="planning-a-namespace-transition"></a>名前空間の移行の計画

名前空間を変更する前に、次の考慮事項を確認してください。これは、連続する名前空間から不整合な名前空間への遷移 (または反転) に適用されます。

- 名前空間を変更した後、手動で構成されたサービスプリンシパル名 (Spn) が DNS 名と一致しなくなる場合があります。 これにより、認証エラーが発生する可能性があります。

    詳細については、「Spn が正しく設定されていない [ためにサービスログオンが失敗する](/previous-versions/windows/it-pro/windows-server-2003/cc772897(v=ws.10))」を参照してください。

    - 制約付き委任を使用する Windows Server 2003 ベースのコンピューターを使用する場合、これらのコンピューターで Spn を変更するには追加の構成が必要になることがあります。 詳細については、Microsoft サポート技術情報の記事936628を参照してください。 SPN は、Windows Server 2003 (404) を実行している [コンピューターで制約付き委任を構成しようとすると、アカウントに委任できるサービスの一覧に表示されません](https://support.microsoft.com/help/936628) 。

    - Spn を変更するアクセス許可を下位の管理者に委任する場合は、「 [spn を変更するため](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770439(v=ws.10))の権限の委任」を参照してください。

- 不整合な名前空間に構成されているドメインコントローラーがある、展開内の CA と Secure Sockets Layer (LDAPS と呼ばれます) を介してライトウェイトディレクトリアクセスプロトコル (LDAP) を使用する場合は、LDAPS 証明書を構成するときに、適切な Active Directory ドメイン名とプライマリ DNS サフィックスを使用する必要があります。

    ドメインコントローラー証明書の要件の詳細については、Microsoft サポート技術情報の記事321051を参照してください。 [サードパーティの証明機関との SSL 経由で LDAP を有効にする方法](https://support.microsoft.com/help/321051/)です。

    > [!NOTE]
    > LDAPS に証明書を使用するドメインコントローラーでは、証明書の再展開が必要になる場合があります。 この場合、ドメインコントローラーは、再起動されるまで適切な証明書を選択しないことがあります。 Windows Server 2003 のライトウェイトディレクトリアクセスプロトコル (LDAP) over Secure Sockets Layer (LDAPS) 認証の詳細については、Microsoft サポート技術情報の記事938703を参照してください。 [ldap OVER SSL 接続の問題をトラブルシューティングする方法](https://support.microsoft.com/help/938703/)については、「」を参照してください。

### <a name="planning-for-disjoint-namespace-deployments"></a>不整合な名前空間の展開の計画

不整合のある名前空間を持つ環境にコンピューターを展開する場合は、次の予防措置を取ります。

1. テストする必要があるビジネス担当者と、不整合な名前空間をサポートするすべてのソフトウェアベンダーに通知します。 これらのユーザーに対して、不整合な名前空間を使用する環境でアプリケーションがサポートされていることを確認してください。

2. 不整合な名前空間ラボ環境で、すべてのバージョンのオペレーティングシステムとアプリケーションをテストします。 その場合は、次の推奨事項に従ってください。

    1. ソフトウェアを環境に展開する前に、すべての問題を解決してください。

    2. 可能であれば、不整合な名前空間で展開する予定のオペレーティングシステムとアプリケーションのベータテストに参加します。

3. 管理者とヘルプデスクスタッフが、不整合な名前空間とその影響を認識していることを確認します。

4. 必要に応じて、不整合のある名前空間から連続する名前空間に移行できるようにするプランを作成します。

5. 伝えるは、オペレーティングシステムおよびアプリケーションプロバイダーでの不整合な名前空間のサポートの重要性をします。
