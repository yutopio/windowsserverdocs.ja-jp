---
ms.assetid: bd64a766-5362-4f29-b963-5465c2bb79e7
title: 操作マスターの役割の配置を計画する
ms.author: daveba
author: iainfoulds
manager: daveba
ms.date: 08/08/2018
ms.topic: article
ms.openlocfilehash: 158209ca281fdd3839747e936d1f439951cc644f
ms.sourcegitcommit: b115e5edc545571b6ff4f42082cc3ed965815ea4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2020
ms.locfileid: "93069154"
---
# <a name="planning-operations-master-role-placement"></a>操作マスターの役割の配置を計画する

> 適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

Active Directory Domain Services (AD DS) では、ディレクトリデータのマルチマスターレプリケーションがサポートされています。つまり、すべてのドメインコントローラーがディレクトリの変更を受け入れ、その変更を他のすべてのドメインコントローラーにレプリケートすることができます。 ただし、スキーマの変更などの特定の変更は、マルチマスター方式で実行するのは現実的ではありません。 このため、特定の特定の変更に対する要求の受け入れを担当する役割は、操作マスターと呼ばれる特定のドメインコントローラーに保持されます。

> [!NOTE]
> 操作マスターの役割所有者は、Active Directory データベースにいくつかの情報を書き込むことができる必要があります。 読み取り専用ドメインコントローラー (RODC) 上の Active Directory データベースの読み取り専用の性質上、 **rodc は操作マスターの役割所有者として機能できません** 。

各ドメインには、次の3つの操作マスターの役割 (フレキシブルシングルマスター操作または FSMO とも呼ばれます) が存在します。

- プライマリドメインコントローラ (PDC) エミュレータ操作マスタは、すべてのパスワードの更新を処理します。

- 相対 ID (RID) 操作マスタは、ドメインのグローバル RID プールを保持し、すべてのドメインコントローラにローカル Rid プールを割り当てて、ドメイン内に作成されたすべてのセキュリティプリンシパルが一意の識別子を持つようにします。
- 特定のドメインのインフラストラクチャ操作マスターは、そのドメイン内のグループのメンバーである他のドメインのセキュリティプリンシパルの一覧を保持します。

3つのドメインレベル操作マスターの役割に加えて、各フォレストには次の2つの操作マスターの役割があります。

- スキーマ操作マスタは、スキーマの変更を制御します。
- ドメイン名前付け操作マスタは、ドメインやその他のディレクトリパーティション (ドメインネームシステム (DNS) アプリケーションパーティションなど) をフォレストとの間で追加または削除します。

これらの操作マスターの役割をホストするドメインコントローラーは、ネットワークの信頼性が高い領域に配置し、PDC エミュレーターと RID マスターが一貫して使用可能であることを確認します。

操作マスタの役割所有者は、特定のドメインの最初のドメインコントローラーが作成されるときに自動的に割り当てられます。 フォレスト内に作成された最初のドメインコントローラーには、2つのフォレストレベルのロール (スキーママスタとドメイン名前付けマスタ) が割り当てられます。 さらに、3つのドメインレベルのロール (RID マスター、インフラストラクチャマスタ、および PDC エミュレーター) が、ドメイン内に作成された最初のドメインコントローラーに割り当てられます。

> [!NOTE]
> 自動操作マスターの役割の所有者の割り当ては、新しいドメインが作成され、現在の役割の所有者が降格された場合にのみ行われます。 ロールの所有者に対する他のすべての変更は、管理者によって開始される必要があります。

これらの自動操作マスタの役割の割り当てにより、フォレストまたはドメインで作成された最初のドメインコントローラーの CPU 使用率が非常に高くなる可能性があります。 これを回避するには、フォレストまたはドメイン内のさまざまなドメインコントローラーに操作マスターの役割を割り当て (転送) します。 操作マスターの役割をホストするドメインコントローラーは、ネットワークが信頼できる領域と、フォレスト内の他のすべてのドメインコントローラーが操作マスターにアクセスできる場所に配置します。

また、すべての操作マスターの役割に対して、スタンバイ (代替) 操作マスターを指定する必要があります。 スタンバイ操作マスタは、元のロールホルダーで障害が発生した場合に操作マスタの役割を転送できるドメインコントローラです。 スタンバイ操作マスタが、実際の操作マスタの直接レプリケーションパートナーであることを確認します。

## <a name="planning-the-pdc-emulator-placement"></a>PDC エミュレーターの配置の計画

PDC エミュレーターは、クライアントパスワードの変更を処理します。 フォレスト内の各ドメインで PDC エミュレーターとして機能するのは、1つのドメインコントローラーだけです。

すべてのドメインコントローラーが windows 2000、Windows Server 2003、および Windows Server 2008 にアップグレードされ、ドメインが Windows 2000 ネイティブ機能レベルで動作している場合でも、PDC エミュレーターは、ドメイン内の他のドメインコントローラーによって実行されたパスワード変更の優先的なレプリケーションを受け取ります。 パスワードが最近変更された場合、その変更は、ドメイン内のすべてのドメインコントローラーにレプリケートされるまでに時間がかかります。 パスワードが正しくないために別のドメインコントローラーでログオン認証が失敗した場合、ドメインコントローラーは、ログオン試行を受け入れるか拒否するかを決定する前に、認証要求を PDC エミュレーターに転送します。

必要に応じて、パスワード転送操作のために、そのドメインのユーザー数が多い場所に PDC エミュレーターを配置します。 また、レプリケーションの待機時間を最小限に抑えるために、場所が他の場所に適切に接続されていることを確認します。

各場所で表される各ドメインの PDC エミュレーターとユーザー数に関する情報を文書化するためのワークシートについては、「 [Windows Server 2003 展開キット用のジョブエイド](https://microsoft.com/download/details.aspx?id=9608)」、「Job_Aids_Designing_and_Deploying_Directory_and_Security_Services.zip をダウンロードして、ドメインコントローラーの配置を開く」 (DSSTOPO_4.doc) を参照してください。

地域ドメインを展開するときに、PDC エミュレーターを配置する必要がある場所に関する情報を参照する必要があります。 地域ドメインの展開に関する詳細については、次を参照してください。 [を展開する Windows Server 2008 地域ドメイン](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc755118(v=ws.10))します。

## <a name="requirements-for-infrastructure-master-placement"></a>インフラストラクチャマスターの配置の要件

インフラストラクチャマスタは、自身のドメイン内のグループに追加される他のドメインのセキュリティプリンシパルの名前を更新します。 たとえば、あるドメインのユーザーが2番目のドメインのグループのメンバーであり、最初のドメインでそのユーザーの名前が変更された場合、2番目のドメインには、そのユーザーの名前をグループのメンバーシップ一覧で更新する必要があることが通知されません。 1つのドメイン内のドメインコントローラーはセキュリティプリンシパルを別のドメインのドメインコントローラーにレプリケートしないため、2番目のドメインは、インフラストラクチャマスターが存在しない場合の変更を認識しません。

インフラストラクチャマスタは、グループのメンバーシップを絶えず監視し、他のドメインのセキュリティプリンシパルを探します。 見つかった場合は、セキュリティプリンシパルのドメインを調べて、情報が更新されたことを確認します。 情報が最新でない場合、インフラストラクチャマスターは更新を実行し、その変更をドメイン内の他のドメインコントローラーにレプリケートします。

この規則には、2つの例外が適用されます。 最初に、すべてのドメインコントローラーがグローバルカタログサーバーである場合、インフラストラクチャマスターの役割をホストするドメインコントローラーは意味がありません。これは、グローバルカタログが、更新された情報を所属するドメインに関係なくレプリケートするためです。 2つ目は、フォレストにドメインが1つしかない場合、他のドメインからのセキュリティプリンシパルが存在しないため、インフラストラクチャマスターの役割をホストするドメインコントローラーは意味がありません。

インフラストラクチャマスターは、グローバルカタログサーバーでもあるドメインコントローラーに配置しないでください。 インフラストラクチャマスターとグローバルカタログが同じドメインコントローラー上にある場合、インフラストラクチャマスターは機能しません。 インフラストラクチャマスターでは、最新ではないデータは検出されません。そのため、ドメイン内の他のドメインコントローラーに変更がレプリケートされることはありません。

## <a name="operations-master-placement-for-networks-with-limited-connectivity"></a>接続が制限されたネットワークの操作マスタの配置

操作マスターの役割の所有者を配置できる中央の場所またはハブサイトが環境にある場合は、それらの操作マスターの役割所有者の可用性に依存する特定のドメインコントローラー操作が影響を受ける可能性があることに注意してください。

たとえば、組織が A、B、C、および D というサイトを作成したとします。サイトリンクは A と B の間、B と C の間、および C と D の間に存在します。ネットワーク接続は、サイトリンクのネットワーク接続を正確に反映します。 この例では、すべての操作マスタの役割がサイト A に配置され、 **すべてのサイトリンクをブリッジ** するオプションが選択されていません。

この構成では、すべてのサイト間でレプリケーションが正常に実行されますが、操作マスターの役割の機能には次の制限があります。

- サイト C と D のドメインコントローラーは、サイト A の PDC エミュレーターにアクセスしてパスワードを更新したり、最近更新されたパスワードを確認したりすることはできません。
- サイト C と D のドメインコントローラーは、サイト A の RID マスターにアクセスして、Active Directory のインストール後に初期 RID プールを取得したり、RID プールが使い果たされたときに更新したりすることはできません。
- サイト C と D のドメインコントローラは、ディレクトリ、DNS、またはカスタムのアプリケーションパーティションを追加または削除できません。
- サイト C と D のドメインコントローラーでは、スキーマを変更することはできません。

操作マスターの役割の配置を計画するためのワークシートについては、「 [Windows Server 2003 展開キット用のジョブエイド](https://microsoft.com/download/details.aspx?id=9608)」、「Job_Aids_Designing_and_Deploying_Directory_and_Security_Services.zip をダウンロードして、ドメインコントローラーの配置を開く」 (DSSTOPO_4.doc) を参照してください。

フォレストルートドメインと地域ドメインを作成するときに、この情報を参照する必要があります。 フォレストルートドメインの展開の詳細については、「 [Windows Server 2008 フォレストルートドメイン](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731174(v=ws.10))の展開の展開」を参照してください。 地域ドメインの展開に関する詳細については、次を参照してください。 [を展開する Windows Server 2008 地域ドメイン](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc755118(v=ws.10))します。

## <a name="next-steps"></a>次のステップ

FSMO の役割の配置に関する追加情報については、サポートトピック「 [Active Directory ドメインコントローラーの fsmo の配置と最適化](https://support.microsoft.com/help/223346)」を参照してください。
