---
ms.assetid: 34244b53-1206-4f5b-8c4d-3ebf574d8e24
title: 資格情報の盗難の対象になりやすいアカウント
author: iainfoulds
ms.author: daveba
manager: daveba
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: fc447cb52f3d808a16b517b4cccaf3c15009f39c
ms.sourcegitcommit: b115e5edc545571b6ff4f42082cc3ed965815ea4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2020
ms.locfileid: "93069714"
---
# <a name="attractive-accounts-for-credential-theft"></a>資格情報の盗難の対象になりやすいアカウント

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

資格情報の盗難攻撃とは、攻撃者がネットワーク上のコンピューターへのアクセスによって最高レベルの特権 (ルート、管理者、またはシステム) を最初に取得した後、自由に利用できるツールを使用して、他のログオンアカウントのセッションから資格情報を抽出する攻撃です。 システム構成によっては、このような資格情報をハッシュ、チケット、またはプレーンテキスト パスワードの形式で抽出することができます。 収集された資格情報のいずれかが、ネットワーク上の他のコンピューター (Windows の管理者アカウント、OSX、UNIX、または Linux のルートアカウントなど) に存在する可能性があるローカルアカウントのものである場合、攻撃者はネットワーク上の他のコンピューターに資格情報を提示して、追加のコンピューターにセキュリティ侵害を適用し、2つの:

1.  広範な権限と深い権限 (多くのコンピューターで管理者レベルの特権を持つアカウントと Active Directory) の両方を持つ特権ドメインアカウント。 これらのアカウントは Active Directory の最高レベルの特権グループのメンバーではない可能性がありますが、ドメインまたはフォレスト内の多くのサーバーやワークステーションに対して管理者レベルの特権が付与されている可能性があります。これにより、Active Directory の特権グループのメンバーとして効果的に強力になります。 ほとんどの場合、広範な膨大の Windows インフラストラクチャに対して高いレベルの特権が付与されているアカウントはサービスアカウントであるため、サービスアカウントは常に、広範で深い権限を評価する必要があります。

2.  "非常に重要な人" (VIP) ドメインアカウント。 このドキュメントのコンテキストでは、VIP アカウントは、攻撃者が必要とする情報 (知的財産およびその他の機密情報)、または攻撃者にその情報へのアクセスを許可するために使用できる任意のアカウントにアクセスできる任意のアカウントです。 これらのユーザーアカウントの例を次に示します。

    1.  会社の機密情報にアクセスできるアカウントを持つ役員

    2.  役員が使用するコンピューターとアプリケーションの保守を担当するヘルプデスクスタッフのアカウント

    3.  組織の入札および契約ドキュメントにアクセスできる法務担当者向けのアカウント (ドキュメントが自分の組織用かクライアント組織向けか)

    4.  会社が行う製品の種類に関係なく、会社の開発パイプラインで製品の計画と仕様にアクセスできる製品プランナー

    5.  研究データ、製品式、またはその他の興味深い調査にアクセスするためにアカウントを使用する研究者

Active Directory の高い特権を持つアカウントを使用して、セキュリティ侵害を伝達したり、VIP アカウントやアクセスできるデータを操作したりすることができるため、資格情報の盗難攻撃に最も役立つアカウントは、Active Directory の Enterprise Admins、Domain Admins、および Administrators グループのメンバーであるアカウントです。

ドメインコントローラーは AD DS データベースのリポジトリであり、ドメインコントローラーは Active Directory 内のすべてのデータに対してフルアクセス権を持っているため、ドメインコントローラーは、資格情報の盗難攻撃と並行して、または1つ以上の特権のある Active Directory アカウントが侵害された後に、セキュリティ侵害の対象にもなります。 多数の出版物 (および多くの攻撃者) は、ハッシュパスとその他の資格情報の盗難攻撃 ( [Active Directory の攻撃対象領域の削減](../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)に関するページを参照) を記述するときに、domain Admins グループのメンバーシップに焦点を合わせていますが、ここに記載されているグループのいずれかのメンバーであるアカウントを使用して、AD DS

> [!NOTE]
> ハッシュのパススルーとその他の資格情報の盗難攻撃に関する包括的な情報については、「[付録 M: ドキュメントリンクと推奨](../../../ad-ds/manage/Appendix-M--Document-Links-and-Recommended-Reading.md)される読み取り」に記載されている、軽減された[ハッシュ (PTH) 攻撃とその他の資格](https://download.microsoft.com/download/7/7/A/77ABC5BD-8320-41AF-863C-6ECFB10CB4B9/Mitigating%20Pass-the-Hash%20(PtH)%20Attacks%20and%20Other%20Credential%20Theft%20Techniques_English.pdf)情報の盗難に関する技術に関するホワイトペーパーを参照してください。 "高度な永続的な脅威" (APTs) と呼ばれることがある敵対者による攻撃の詳細については、「 [敵対者とターゲットの攻撃を特定](https://www.microsoft.com/download/details.aspx?id=34793)する」を参照してください。

## <a name="activities-that-increase-the-likelihood-of-compromise"></a>侵害の可能性を高めるアクティビティ
資格情報の盗難の対象は通常、高い特権を持つドメインアカウントと VIP アカウントであるため、管理者は、資格情報の盗難攻撃が成功する可能性を高めるアクティビティを意識することが重要です。 攻撃者も VIP アカウントを対象としていますが、システムまたはドメインに対する高レベルの特権が Vip に与えられていない場合、資格情報の盗難には他の種類の攻撃 (ソーシャル engineering による機密情報の提供など) が必要です。 または、資格情報がキャッシュされているシステムへの特権アクセスを攻撃者が最初に取得する必要があります。 このため、ここで説明されている資格情報の盗難の可能性を高める活動は、主に、高い特権を持つ管理者の資格情報を取得できないようにすることに重点を置いています。 これらのアクティビティは、特権のある資格情報を取得するために攻撃者がシステムを侵害できる一般的なメカニズムです。

### <a name="logging-on-to-unsecured-computers-with-privileged-accounts"></a>特権のあるアカウントを持つセキュリティで保護されていないコンピューターへのログオン
資格情報の盗難攻撃を成功させるための主要な脆弱性は、環境全体で広範かつ深い権限を持つアカウントを使用して、セキュリティで保護されていないコンピューターにログオンすることです。 これらのログオンは、ここで説明するさまざまな誤りの結果になる可能性があります。

#### <a name="not-maintaining-separate-administrative-credentials"></a>管理者の資格情報を個別に保持していない
これは比較的一般的ではありませんが、さまざまな AD DS のインストールを評価する際に、すべての作業に1つのアカウントを使用している従業員を見つけました。 アカウントは Active Directory 内の最も高い特権を持つグループのうちの少なくとも1つのメンバーであり、従業員が朝にワークステーションへのログオン、電子メールのチェック、インターネットサイトの参照、およびコンピューターへのコンテンツのダウンロードに使用するのと同じアカウントです。 ローカルの管理者権限とアクセス許可が付与されているアカウントを使用してユーザーを実行すると、ローカルコンピューターが危険にさらされるのを防ぐことができます。 これらのアカウントが Active Directory の最上位の権限を持つグループのメンバーでもある場合、フォレスト全体が危険にさらされることになり、攻撃者が Active Directory と Windows 環境を完全に制御できるようになります。

同様に、一部の環境では、windows 環境で使用されている Windows 以外のコンピューター上のルートアカウントに同じユーザー名とパスワードが使用されていることがわかっています。これにより、攻撃者は、UNIX または Linux システムから Windows システムへの侵害を、またはその逆に拡張することができます。

#### <a name="logons-to-compromised-workstations-or-member-servers-with-privileged-accounts"></a>権限のあるアカウントを使用して、侵害されたワークステーションまたはメンバーサーバーにログオンする
高い特権を持つドメインアカウントを使用して、侵害されたワークステーションまたはメンバーサーバーに対話形式でログオンすると、システムにログオンしているすべてのアカウントから資格情報を収集する可能性があります。

#### <a name="unsecured-administrative-workstations"></a>セキュリティで保護されていない管理ワークステーション
多くの組織では、IT スタッフが複数のアカウントを使用しています。 1つのアカウントが従業員のワークステーションへのログオンに使用されます。これらは IT スタッフであるため、多くの場合、ワークステーションに対するローカルの管理者権限を持っています。 場合によっては、ユーザーが少なくともログオン時に分割アクセストークンを受信し、特権が必要になったときに昇格する必要があるため、UAC が有効のままになることがあります。 これらのユーザーがメンテナンス操作を実行するときは、通常、ローカルにインストールされている管理ツールを使用し、ドメイン特権アカウントの資格情報を提供します。そのためには、[ **管理者として実行** ] オプションを選択するか、メッセージが表示されたら資格情報を指定します。 この構成は適切だと思われるかもしれませんが、次の理由により、セキュリティが侵害される環境を公開します。

-   従業員がワークステーションへのログオンに使用する "通常の" ユーザーアカウントには、ローカル管理者権限があります。このコンピューターは、ユーザーがマルウェアをインストールすることに納得される、 [ドライブ単位のダウンロード](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) 攻撃に対して脆弱です。

-   マルウェアが管理者アカウントのコンテキストでインストールされると、コンピューターを使用して、キーストローク、クリップボードの内容、スクリーンショット、およびメモリ常駐の資格情報をキャプチャできるようになります。これらの資格情報は、強力なドメインアカウントの資格情報を公開する可能性があります。

このシナリオの問題は2倍です。 まず、ローカル管理とドメイン管理に個別のアカウントを使用しますが、コンピューターはセキュリティで保護されていません。また、アカウントが盗難から保護されることもありません。 次に、通常のユーザーアカウントと管理者アカウントに、過剰な権限とアクセス許可が付与されています。

### <a name="browsing-the-internet-with-a-highly-privileged-account"></a>高い特権を持つアカウントを使用してインターネットを参照する
コンピューター上のローカル管理者グループのメンバーであるアカウントを持つコンピューターにログオンしたユーザー、または Active Directory の特権グループのメンバーであるコンピューターにログオンしたユーザーが、インターネット (または攻撃を受けたイントラネット) を参照すると、ローカルコンピューターとディレクトリが危険にさらされます。

管理者特権で実行されているブラウザーを使用して、悪意のある web サイトにアクセスすると、攻撃者は特権ユーザーのコンテキストで悪意のあるコードをローカルコンピューターにデポジットできます。 ユーザーがコンピューターのローカル管理者権限を持っている場合、攻撃者は、悪意のあるコードをダウンロードしたり、アプリケーションの脆弱性を活用する電子メールの添付ファイルを開いたり、ユーザーの特権を利用して、コンピューター上のすべてのアクティブなユーザーに対してローカルにキャッシュされた資格情報を騙すことができます。 ユーザーが Active Directory の Enterprise Admins、Domain Admins、または Administrators グループのメンバーシップによってディレクトリの管理者権限を持っている場合、攻撃者はドメインの資格情報を抽出し、それを使用して AD DS のドメインまたはフォレスト全体を危険にさらすことができます。フォレスト内の他のコンピューターに危害を加える必要はありません。

### <a name="configuring-local-privileged-accounts-with-the-same-credentials-across-systems"></a>システム間で同じ資格情報を使用してローカルの特権アカウントを構成する
多くのコンピューターまたはすべてのコンピューターで同じローカル管理者アカウント名とパスワードを構成すると、同じ資格情報を使用する他のすべてのコンピューターのセキュリティを侵害するために、1台のコンピューター上の SAM データベースからの資格情報が盗まれます。 少なくとも、ドメインに参加している各システムのローカル管理者アカウントでは、異なるパスワードを使用する必要があります。 ローカル管理者アカウントには一意の名前を付けることもできますが、資格情報を他のシステムで使用できないようにするには、システムの特権ローカルアカウントごとに異なるパスワードを使用するだけで十分です。

### <a name="overpopulation-and-overuse-of-privileged-domain-groups"></a>権限のあるドメイングループの過剰な作成と使いすぎる
ドメイン内の EA、DA、または BA グループのメンバーシップを付与すると、攻撃者のターゲットが作成されます。 これらのグループのメンバーの数が多いほど、特権を持つユーザーが誤って資格情報を悪用し、資格情報の盗難攻撃にさらされる可能性が高くなります。 特権ドメインユーザーがログオンするすべてのワークステーションまたはサーバーは、特権を持つユーザーの資格情報を収集し、AD DS のドメインとフォレストを侵害するために使用できるメカニズムを提供します。

### <a name="poorly-secured-domain-controllers"></a>不適切なセキュリティで保護されたドメインコントローラー
ドメインコントローラーには、ドメインの AD DS データベースのレプリカが格納されます。 読み取り専用ドメインコントローラーの場合、データベースのローカルレプリカには、ディレクトリ内の一部のアカウントの資格情報のみが含まれます。既定では、特権ドメインアカウントは使用されません。 読み取り/書き込みドメインコントローラーでは、各ドメインコントローラーが AD DS データベースの完全なレプリカを保持します。これには、ドメイン管理者などの特権を持つユーザーだけでなく、ドメインコントローラーアカウントやドメインの Krbtgt アカウントなどの特権を持つアカウント (ドメインコントローラーの KDC サービスに関連付けられているアカウント) も含まれます。 ドメインコントローラーの機能に必要な追加のアプリケーションがドメインコントローラーにインストールされていない場合、またはドメインコントローラーに修正プログラムを適用してセキュリティで保護されていない場合、攻撃者は修正プログラム脆弱性の脆弱性によって攻撃を受ける可能性があります

## <a name="privilege-elevation-and-propagation"></a>特権の昇格と伝達
使用されている攻撃方法に関係なく、Windows 環境が攻撃されたときは常に、攻撃者が必要なものへのアクセスを制御するため、Active Directory は常に対象となります。 ただし、これはディレクトリ全体が対象になっているという意味ではありません。 通常、特定のアカウント、サーバー、およびインフラストラクチャコンポーネントは、Active Directory に対する攻撃の主な対象となります。 これらのアカウントについては、次のように説明します。

### <a name="permanent-privileged-accounts"></a>永続的な特権アカウント
Active Directory が導入されたため、高い特権を持つアカウントを使用して Active Directory フォレストを構築し、より低い特権のアカウントで日常の管理を実行するために必要な権限とアクセス許可を委任できるようになりました。 Active Directory の Enterprise Admins、Domain Admins、または Administrators グループのメンバーシップは、日常の管理に最小限の特権アプローチを実装する環境では一時的かつ低頻度である必要があります。

永続的な特権を持つアカウントは、特権グループに配置されているアカウントであり、その場所には日から日まで残されています。 組織でドメインの Domain Admins グループに5つのアカウントを配置する場合、これらの5つのアカウントは1日24時間、週7日を対象にすることができます。 ただし、ドメイン管理者特権を持つアカウントを実際に使用する必要があるのは、通常、特定のドメイン全体の構成と、短時間の場合のみです。

### <a name="vip-accounts"></a>VIP アカウント
Active Directory 違反で見落とされることの多い目標は、組織内の "非常に重要な人物" (または Vip) のアカウントです。 特権アカウントは、このセクションで既に説明したように、これらのアカウントが攻撃者にアクセスを許可したり、対象システムを破棄したりできるようにするため、対象となります。

### <a name="privilege-attached-active-directory-accounts"></a>"特権が割り当てられた" Active Directory アカウント
"特権接続" Active Directory アカウントは、Active Directory で最高レベルの特権を持つグループのメンバーになっていないものの、環境内の多くのサーバーやワークステーションに対して高いレベルの特権が付与されているドメインアカウントです。 これらのアカウントは、通常、ドメインに参加しているシステムでサービスを実行するように構成されたドメインベースのアカウントで、インフラストラクチャの大規模なセクションで実行されるアプリケーションの場合に使用されます。 これらのアカウントには Active Directory の特権がありませんが、多数のシステムに高い特権が付与されている場合は、特権を持つ Active Directory アカウントの侵害と同じ効果を得るために、インフラストラクチャの大規模なセグメントを侵害または破棄するために使用できます。
