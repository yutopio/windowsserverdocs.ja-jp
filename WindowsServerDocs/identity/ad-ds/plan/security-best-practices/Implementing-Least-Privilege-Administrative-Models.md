---
description: 詳細については、「Least-Privilege 管理モデルの実装」を参照してください。
ms.assetid: 7a7ab95c-9cb3-4a7b-985a-3fc08334cf4f
title: 最低限の特権の管理モデルを実装する
ms.author: daveba
author: iainfoulds
manager: daveba
ms.date: 08/09/2018
ms.topic: article
ms.openlocfilehash: 02ce80d936caff5ef77a78585a2e0f35e0b12ca5
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "97040720"
---
# <a name="implementing-least-privilege-administrative-models"></a>最低限の特権の管理モデルを実装する

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

次の抜粋は、1999年4月1日に最初に公開され [た、管理者アカウントのセキュリティ計画ガイド](/previous-versions/tn-archive/cc162797(v=technet.10))に基づいています。

> 「ほとんどのセキュリティ関連のトレーニングコースとドキュメント」では、最小限の特権の原則の実装について説明していますが、これに従うことはめったにありません。 原則は単純であり、適切に適用することによってセキュリティが大幅に向上し、リスクが軽減されます。 原則は、すべてのユーザーが、現在のタスクを完了するために必要な絶対最小アクセス許可を持つユーザーアカウントを使用してログオンする必要があるということです。 そうすることで、悪意のあるコードから他の攻撃を防ぐことができます。 この原則は、コンピューターとそれらのコンピューターのユーザーに適用されます。
> "この原則がうまく機能する理由の1つは、内部調査を強制的に実行することです。 たとえば、コンピューターやユーザーが本当に必要とするアクセス権を決定し、実装する必要があります。 多くの組織にとって、このタスクは最初は大規模な作業であると思われるかもしれません。ただし、ネットワーク環境を正常にセキュリティで保護するには、これが不可欠な手順です。
> 「最小特権の概念で、すべてのドメイン管理者ユーザーにドメイン特権を付与する必要があります。 たとえば、管理者が特権アカウントでログオンし、誤ってウイルス対策プログラムを実行した場合、ウイルスはローカルコンピューターとドメイン全体への管理アクセス権を持っています。 管理者が特権のない (管理者以外の) アカウントを使用してログオンした場合は、ローカルコンピューターのユーザーとして実行されるため、ウイルスの破損の範囲はローカルコンピューターに限られます。
> "もう1つの例では、ドメインレベルの管理者権限を付与するアカウントは、フォレスト間に信頼関係がある場合でも、別のフォレストの昇格された権限を持つことはできません。 これにより、攻撃者が1つの管理対象フォレストを侵害した場合に広範囲に及ぶ損害を防ぐことができます。 組織は、承認されていない特権の昇格から保護するために、ネットワークを定期的に監査する必要があります。 "

次の抜粋は、2005で最初に公開された [Microsoft Windows セキュリティリソースキット](https://www.microsoftpressstore.com/store/microsoft-windows-security-resource-kit-9780735621749)の抜粋です。

> 「タスクを実行するために必要な最小限の特権を付与するという点で、セキュリティを常に考慮してください。 特権が多すぎるアプリケーションが侵害される可能性がある場合、攻撃者は、アプリケーションができるだけ多くの権限を持っていた場合よりも、攻撃を拡張できる可能性があります。 たとえば、ネットワーク管理者がウイルスを起動する電子メールの添付ファイルを開いている場合に、その結果を確認します。 管理者がドメイン管理者アカウントを使用してログオンしている場合、ウイルスはドメイン内のすべてのコンピューターに対する管理者特権を持っているため、ネットワーク上のほぼすべてのデータに無制限にアクセスできます。 管理者がローカルの管理者アカウントを使用してログオンしている場合、ウイルスはローカルコンピューターに対する管理者特権を持っているため、コンピューター上のデータにアクセスして、コンピューターにキーストロークログソフトウェアなどの悪意のあるソフトウェアをインストールすることができます。 管理者が通常のユーザーアカウントを使用してログオンしている場合、ウイルスは管理者のデータにのみアクセスできるため、悪意のあるソフトウェアをインストールすることはできません。 この例では、電子メールの読み取りに必要な最小限の特権を使用することにより、侵害の可能性のある範囲が大幅に減少しています。 "

## <a name="the-privilege-problem"></a>特権の問題

前の抜粋で説明した原則は変更されていませんが、Active Directory のインストールの評価では、毎日の作業を実行するために必要な権限とアクセス許可が付与されているアカウントの数が多くなります。 環境のサイズは、大量の特権を持つアカウントの未加工の数に影響しますが、proportionmidsized ディレクトリには、最も高い特権を持つグループに多数のアカウントを含めることができます。ただし、大規模なインストールでは、数百または数千に及ぶ場合があります。 例外がいくつかありますが、攻撃者のスキルとコレクションの高度化に関係なく、攻撃者は通常、最も低い抵抗のパスに従います。 単純なメカニズムが失敗した場合や、防御者によって阻止された場合にのみ、ツールとアプローチの複雑さが向上します。

残念ながら、多くの環境における抵抗力の低いパスは、広範でディープな権限を持つアカウントの使用過多であることが実証されています。 広範な特権は、アカウントが環境の大規模なセクション全体で特定のアクティビティを実行できるようにする権限とアクセス許可です。たとえば、ヘルプデスクスタッフには、多くのユーザーアカウントのパスワードをリセットするためのアクセス許可が付与されることがあります。

詳細な特権とは、サーバーに対してエンジニア管理者権限を付与して修復を実行できるようにするなど、人口の狭いセグメントに適用される強力な権限です。 広範な特権も深い特権も必ずしも危険ではありませんが、ドメイン内の多くのアカウントに広範で深い特権が付与されている場合、1つのアカウントのみが侵害された場合は、攻撃者の目的に環境を再構成したり、インフラストラクチャの大きなセグメントを破棄したりすることもできます。

資格情報の盗難攻撃の一種であるハッシュ攻撃は、使用するためのツールが自由に利用でき、使いやすく、多くの環境が攻撃に対して脆弱であるため、広く普及しています。 ただし、ハッシュパス攻撃は実際の問題ではありません。 問題の重要な点は次のようになります。

1. 通常、攻撃者は、1台のコンピューターで深い特権を取得し、その特権を他のコンピューターに広く伝達するのが簡単です。
2. 通常、コンピューティング環境全体で高いレベルの特権を持つ永続アカウントが多すぎます。

ハッシュパス攻撃を排除する場合でも、攻撃者は、異なる戦略ではなく、異なる戦術を使用するだけです。 資格情報の盗難ツールが含まれているマルウェアを植栽するのではなく、キーストロークをログに記録するマルウェアを分散したり、他のさまざまな方法を利用して環境全体で強力な資格情報を取得したりすることができます。 戦術に関係なく、ターゲットは、広範で深い権限を持つアカウントと同じままです。

過剰な特権の付与は、侵害された環境の Active Directory にのみ存在します。 必要以上に多くの特権を付与する習慣を組織が策定した場合、通常は、次のセクションで説明するように、インフラストラクチャ全体で検出されます。

## <a name="in-active-directory"></a>Active Directory

Active Directory では、EA、DA、および BA グループに過剰な数のアカウントが含まれていることがよくわかります。 ほとんどの場合、組織の EA グループには最も少ないメンバーが含まれ、DA グループには EA グループ内のユーザー数の乗数が含まれます。また、管理者グループには通常、他のグループの作成よりも多くのメンバーが含まれます。 これは、多くの場合、管理者が DAs や EAs よりも "権限が低い" という確信があることが原因です。 これらの各グループに付与される権限とアクセス許可は異なりますが、1つのメンバーが他の2つのメンバーになることができるため、同等の強力なグループとして効果的に扱う必要があります。

## <a name="on-member-servers"></a>メンバーサーバーの場合

多くの環境でメンバーサーバーのローカル管理者グループのメンバーシップを取得すると、いくつかのローカルアカウントとドメインアカウントの間のメンバーシップが、多数の入れ子になったグループに展開されます。これにより、サーバーに対するローカル管理者特権を持つアカウントの数が増えています。 多くの場合、大きなメンバーシップを持つドメイングループは、メンバーサーバーのローカル管理者グループに入れ子になっています。これは、ドメイン内のグループのメンバーシップを変更できるすべてのユーザーが、ローカルの Administrators グループに入れ子になっているすべてのシステムの管理制御を得ることができるということではありません。

## <a name="on-workstations"></a>ワークステーション上

ワークステーションは、通常、メンバーサーバーよりもローカルの Administrators グループのメンバーの数が非常に少なくなっていますが、多くの環境では、ユーザーは自分のパーソナルコンピューターのローカルの Administrators グループのメンバーシップを付与されます。 このような状況が発生すると、UAC が有効になっている場合でも、それらのユーザーはワークステーションの整合性に高いリスクをもたらすことになります。

> [!IMPORTANT]
> ユーザーのワークステーションに管理者権限が必要であるかどうかを慎重に検討する必要があります。その場合、管理者グループのメンバーであるコンピューターに個別のローカルアカウントを作成する方法が適しています。 昇格が必要なユーザーは、昇格のためにローカルアカウントの資格情報を提示することができますが、アカウントはローカルであるため、他のコンピューターのセキュリティ侵害やドメインリソースへのアクセスには使用できません。 ただし、ローカルアカウントの場合と同様に、ローカルの特権を持つアカウントの資格情報は一意である必要があります。複数のワークステーションで同じ資格情報を使用してローカルアカウントを作成した場合は、ハッシュを受け渡す攻撃をコンピューターに公開します。

## <a name="in-applications"></a>アプリケーション内

ターゲットが組織の知的財産である攻撃では、アプリケーション内で強力な特権を付与されたアカウントは、データの使用を許可することができます。 機密データへのアクセス権を持つアカウントには、ドメインまたはオペレーティングシステムに対する昇格された特権が付与されていない場合がありますが、アプリケーションの構成を操作するアカウント、またはアプリケーションによって提供される情報へのアクセスを許可するアカウントが存在します。

## <a name="in-data-repositories"></a>データリポジトリ内

他のターゲットの場合と同様に、ドキュメントやその他のファイルの形式で知的財産にアクセスする攻撃者は、ファイルストアへのアクセスを制御するアカウント、ファイルに直接アクセスできるアカウント、またはファイルへのアクセス権を持つグループまたはロールを対象にすることができます。 たとえば、ファイルサーバーを使用してコントラクトドキュメントを格納し、Active Directory グループを使用してドキュメントにアクセス権を付与した場合、攻撃者は、グループのメンバーシップを変更できる攻撃者は、侵害されたアカウントをグループに追加したり、コントラクトドキュメントにアクセスしたりすることができます。 SharePoint などのアプリケーションによってドキュメントへのアクセスが提供される場合、攻撃者は前述のようにアプリケーションを対象にすることができます。

## <a name="reducing-privilege"></a>特権の削減

大規模で複雑な環境では、管理とセキュリティ保護が難しくなります。 小規模な組織では、権限の確認と削減は比較的簡単な方法ですが、組織内で使用されている追加のサーバー、ワークステーション、ユーザーアカウント、アプリケーションごとに、セキュリティで保護する必要がある別のオブジェクトを追加します。 組織の IT インフラストラクチャのすべての側面を適切にセキュリティで保護することは困難であるか、または不可能な場合があるため、まず、特権を持つアカウント (Active Directory の組み込みの特権アカウントとグループ、ワークステーションとメンバーサーバーの特権ローカルアカウント) を使用することをお勧めします。

### <a name="securing-local-administrator-accounts-on-workstations-and-member-servers"></a>ワークステーションとメンバーサーバーのローカル管理者アカウントのセキュリティ保護

このドキュメントでは、前に説明したように、Active Directory のセキュリティ保護に焦点を当てていますが、ディレクトリに対するほとんどの攻撃は、個々のホストに対する攻撃として開始されます。 メンバーシステムでローカルグループをセキュリティで保護するための完全なガイドラインは提供できませんが、ワークステーションとメンバーサーバーのローカル管理者アカウントをセキュリティで保護するために、次の推奨事項を使用できます。

#### <a name="securing-local-administrator-accounts"></a>ローカル管理者アカウントのセキュリティ保護

現在メインストリームサポートで使用されているすべてのバージョンの Windows では、ローカル管理者アカウントが既定で無効になっています。これにより、ハッシュやその他の資格情報の盗難攻撃でアカウントが使用できなくなります。 ただし、レガシオペレーティングシステムが含まれているドメイン、またはローカル管理者アカウントが有効になっているドメインでは、これらのアカウントを前述のように使用して、メンバーのサーバーやワークステーション間でセキュリティを侵害することができます。 このため、ドメインに参加しているシステム上のすべてのローカル管理者アカウントには、次のコントロールを使用することをお勧めします。

これらのコントロールを実装するための詳細な手順については、 [「付録 H: ローカル管理者アカウントとグループをセキュリティで保護](../../../ad-ds/plan/security-best-practices/Appendix-H--Securing-Local-Administrator-Accounts-and-Groups.md)する」を参照してください。 ただし、これらの設定を実装する前に、コンピューターでサービスを実行したり、これらのアカウントを使用しないその他の操作を実行したりするために、ローカル管理者アカウントが環境内で現在使用されていないことを確認してください。 実稼働環境に実装する前に、これらの設定を十分にテストしてください。

#### <a name="controls-for-local-administrator-accounts"></a>ローカル管理者アカウントのコントロール

組み込みの管理者アカウントは、メンバーサーバー上のサービスアカウントとして使用することも、ローカルコンピューターへのログオンに使用することもできません (セーフモードでは、アカウントが無効になっている場合でも許可されます)。 ここで説明する設定を実装する目的は、保護コントロールを最初に元に戻す場合を除き、各コンピューターのローカル管理者アカウントを使用できないようにすることです。 これらのコントロールを実装し、変更の管理者アカウントを監視することにより、ローカル管理者アカウントを対象とする攻撃が成功する可能性を大幅に低減できます。

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-joined-systems"></a>Domain-Joined システムの管理者アカウントを制限するように Gpo を構成する

1つまたは複数の Gpo を作成し、各ドメインのワークステーションとメンバーサーバー Ou にリンクするには、Administrator アカウントを **Computer Configuration\Policies\Windows** の次のユーザー権利に追加します。

- ネットワークからこのコンピューターへのアクセスを拒否
- バッチ ジョブとしてのログオン権限を拒否する
- サービスとしてのログオン権限を拒否する
- リモート デスクトップ サービスを使ったログオンを拒否

これらのユーザー権利に管理者アカウントを追加する場合は、アカウントのラベル付け方法によってローカル管理者アカウントとドメインの管理者アカウントのどちらを追加するかを指定します。 たとえば、これらの拒否権限に NWTRADERS ドメインの管理者アカウントを追加するには、アカウントを **NWTRADERS\Administrator** として入力するか、nwtraders ドメインの管理者アカウントを参照します。 ローカル管理者アカウントを制限するには、グループポリシーオブジェクトエディターのこれらのユーザー権利設定に「 **Administrator** 」と入力します。

> [!NOTE]
> ローカル管理者アカウントの名前を変更しても、ポリシーは引き続き適用されます。

これらの設定により、誤って、または故意に有効になっていても、コンピューターの管理者アカウントを使用して他のコンピューターに接続することはできません。 ローカル管理者アカウントを使用したローカルログオンを完全に無効にすることはできません。また、コンピューターのローカル管理者アカウントはディザスターリカバリーシナリオで使用するように設計されているため、この操作を試行する必要もありません。

他のローカルアカウントに管理者特権が付与されていないドメインからメンバーサーバーまたはワークステーションが切断された場合、コンピューターをセーフモードで起動し、管理者アカウントを有効にすることができます。その後、アカウントを使用してコンピューターの修復を有効にすることができます。 修復が完了したら、管理者アカウントを再び無効にする必要があります。

### <a name="securing-local-privileged-accounts-and-groups-in-active-directory"></a>Active Directory でのローカルの特権アカウントとグループのセキュリティ保護

*法 6: コンピューターは、管理者が信頼できるようにするだけで安全です。* - [セキュリティに関する10の不変法 (バージョン 2.0)](https://www.microsoft.com/en-us/msrc?rtc=1)

ここで提供される情報は、Active Directory で、特権が組み込まれているビルトインアカウントとグループをセキュリティで保護するための一般的なガイドラインを提供することを目的としています。 詳細な手順については、 [「付録 D: Active Directory で Built-In 管理者アカウントをセキュリティ](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)で保護する」、付録 [E Active Directory:](../../../ad-ds/plan/security-best-practices/Appendix-E--Securing-Enterprise-Admins-Groups-in-Active-Directory.md)「 [Active Directory で Domain admins](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)グループをセキュリティで保護する」、および [「付録 G: Active Directory で管理者グループをセキュリティ](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)で保護する」を参照してください。

これらの設定のいずれかを実装する前に、すべての設定を十分にテストして、それらが環境に適しているかどうかを判断する必要もあります。 すべての組織でこれらの設定を実装することはできません。

#### <a name="securing-built-in-administrator-accounts-in-active-directory"></a>Active Directory でのビルトイン管理者アカウントのセキュリティ保護

Active Directory の各ドメインで、ドメインの作成の一環として管理者アカウントが作成されます。 既定では、このアカウントはドメインの domain Admins グループと管理者グループのメンバーであり、ドメインがフォレストのルートドメインである場合、アカウントは Enterprise Admins グループのメンバーでもあります。 ドメインのローカル管理者アカウントの使用は、最初のビルドアクティビティと、場合によってはディザスターリカバリーシナリオでのみ予約されている必要があります。 組み込みの Administrator アカウントを使用して、他のアカウントを使用できない場合に、修復に影響を与えることができるようにするには、フォレスト内のどのドメインでも、管理者アカウントの既定のメンバーシップを変更しないようにする必要があります。 代わりに、フォレスト内の各ドメインの管理者アカウントをセキュリティで保護するために、ガイドラインに従う必要があります。 これらのコントロールを実装するための詳細な手順については、 [「付録 D: Active Directory で Built-In 管理者アカウントを保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)する」を参照してください。

#### <a name="controls-for-built-in-administrator-accounts"></a>組み込みの Administrator アカウントのコントロール

ここで説明する設定を実装する目的は、複数のコントロールが反転されていない限り、各ドメインの管理者アカウント (グループではない) が使用できないようにすることです。 これらのコントロールを実装し、変更のために管理者アカウントを監視することにより、ドメインの管理者アカウントを利用することで、攻撃が成功する可能性を大幅に低減できます。 フォレスト内の各ドメインの管理者アカウントについては、次の設定を構成する必要があります。

##### <a name="enable-the-account-is-sensitive-and-cannot-be-delegated-flag-on-the-account"></a>アカウントの [アカウントは重要なので委任できない] フラグを有効にする

既定では、Active Directory 内のすべてのアカウントを委任できます。 委任を使用すると、コンピューターまたはサービスに対して認証されたアカウントの資格情報を他のコンピューターに提示して、そのアカウントに代わってサービスを取得することができます。 ドメインベースのアカウントで [ **アカウントは重要なので委任できない** ] 属性を有効にした場合、そのアカウントの資格情報をネットワーク上の他のコンピューターやサービスに提示することはできません。そのため、委任を利用して他のシステムでアカウントの資格情報を使用する攻撃が制限されます。

##### <a name="enable-the-smart-card-is-required-for-interactive-logon-flag-on-the-account"></a>アカウントの "対話型ログオンにはスマートカードが必要です" フラグを有効にする

アカウントの **対話型ログオン属性にスマートカードが必要な場合は** 、Windows によって、アカウントのパスワードが120文字のランダム値にリセットされます。 組み込みの管理者アカウントにこのフラグを設定することにより、アカウントのパスワードが長すぎて複雑なだけでなく、どのユーザーにも知られていないことを確認できます。 この属性を有効にする前に、アカウントのスマートカードを作成する必要はありませんが、可能な場合は、アカウント制限を構成する前に、管理者アカウントごとにスマートカードを作成する必要があります。また、スマートカードは安全な場所に保管する必要があります。

**対話型ログオンフラグにスマートカード** を設定する必要がありますが、アカウントのパスワードがリセットされますが、アカウントのパスワードをリセットする権限を持つユーザーは、アカウントのパスワードを既知の値に設定し、アカウント名と新しいパスワードを使用してネットワーク上のリソースにアクセスすることができます。 このため、次の追加のコントロールをアカウントに実装する必要があります。

##### <a name="configuring-gpos-to-restrict-domains-administrator-accounts-on-domain-joined-systems"></a>Domain-Joined システムでドメインの管理者アカウントを制限するように Gpo を構成する

ドメインの管理者アカウントを無効にすると、アカウントが効果的に使用できなくなりますが、アカウントが誤って、または故意に有効になっている場合に備えて、アカウントに追加の制限を実装する必要があります。 これらのコントロールは最終的に管理者アカウントによって元に戻すことができますが、その目的は、攻撃者の進行を遅らせ、アカウントが被る可能性のある損害を制限するコントロールを作成することです。

1つまたは複数の Gpo を作成し、各ドメインのワークステーションとメンバーサーバーの Ou にリンクする場合は、各ドメインの管理者アカウントを、 **Computer Configuration\Policies\Windows] 権利**\ ユーザー権利の割り当ての次のユーザー権利に追加します。

- ネットワークからこのコンピューターへのアクセスを拒否
- バッチ ジョブとしてのログオン権限を拒否する
- サービスとしてのログオン権限を拒否する
- リモート デスクトップ サービスを使ったログオンを拒否

> [!NOTE]
> ローカル管理者アカウントをこの設定に追加する場合は、ローカル管理者アカウントとドメイン管理者アカウントのどちらを構成するかを指定する必要があります。 たとえば、NWTRADERS ドメインのローカル管理者アカウントをこれらの拒否権限に追加するには、アカウントを **NWTRADERS\Administrator** として入力するか、または nwtraders ドメインのローカル管理者アカウントを参照する必要があります。 グループポリシーオブジェクトエディターのこれらのユーザー権利設定で「 **administrator** 」と入力すると、GPO が適用される各コンピューターのローカル管理者アカウントが制限されます。
>
> メンバーサーバーとワークステーションのローカル管理者アカウントは、ドメインベースの管理者アカウントと同じ方法で制限することをお勧めします。 そのため、通常は、フォレスト内の各ドメインの管理者アカウントと、ローカルコンピューターの管理者アカウントをこれらのユーザー権利設定に追加する必要があります。

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-controllers"></a>ドメインコントローラーの管理者アカウントを制限するように Gpo を構成する

フォレスト内の各ドメインにおいて、既定のドメインコントローラーポリシー、またはドメインコントローラー OU にリンクされているポリシーを変更して、各ドメインの管理者アカウントを、 **Computer Configuration\Policies\Windows] 権利の権限の割り当て** の次のユーザー権限に追加する必要があります。

- ネットワークからこのコンピューターへのアクセスを拒否
- バッチ ジョブとしてのログオン権限を拒否する
- サービスとしてのログオン権限を拒否する
- リモート デスクトップ サービスを使ったログオンを拒否

> [!NOTE]
> これらの設定により、ローカル管理者アカウントを使用してドメインコントローラーに接続することはできません。ただし、有効にした場合、アカウントはドメインコントローラーにローカルでログオンできます。 このアカウントは、ディザスターリカバリーシナリオでのみ有効にして使用する必要があるため、少なくとも1つのドメインコントローラーへの物理的なアクセスが可能であること、またはドメインコントローラーへのアクセス許可を持つ他のアカウントをリモートで使用できることが予想されます。

##### <a name="configure-auditing-of-built-in-administrator-accounts"></a>ビルトイン Administrator アカウントの監査を構成する

各ドメインの管理者アカウントをセキュリティで保護し、無効にした場合は、アカウントの変更を監視するように監査を構成する必要があります。 アカウントが有効になっている場合、パスワードがリセットされた場合、またはアカウントにその他の変更が加えられた場合は、組織内のインシデント対応チームに加えて、AD DS の管理を担当するユーザーまたはチームに警告を送信する必要があります。

### <a name="securing-administrators-domain-admins-and-enterprise-admins-groups"></a>管理者、Domain Admins、および Enterprise Admins グループをセキュリティで保護する

#### <a name="securing-enterprise-admin-groups"></a>エンタープライズ管理グループをセキュリティで保護する

フォレストのルートドメインに格納されている Enterprise Admins グループには、毎日のユーザーが含まれないようにする必要があります。ただし、前述のようにセキュリティで保護されている場合は、 [「付録 D: Active Directory で Built-In 管理者アカウントを保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)する」で説明したように、ドメインのローカル管理者アカウントを除きます。

EA へのアクセスが必要な場合は、EA の権利とアクセス許可を必要とするアカウントを持つユーザーは、一時的に Enterprise Admins グループに配置する必要があります。 ユーザーは高い特権を持つアカウントを使用していますが、それらのアクティビティは、変更を実行した1人のユーザーと、その変更を観察するユーザーによって監査される必要があります。 活動が完了したら、アカウントを EA グループから削除する必要があります。 これは、手動の手順とドキュメント化されたプロセス、サードパーティの特権 id/アクセス管理 (PIM/PAM) ソフトウェア、またはその両方の組み合わせを使用して実現できます。 Active Directory の特権グループのメンバーシップの制御に使用できるアカウントを作成するためのガイドラインは、 [資格情報の盗難に適したアカウント](../../../ad-ds/plan/security-best-practices/Attractive-Accounts-for-Credential-Theft.md) で提供されています。詳細な手順については、 [「付録 I: Active Directory で保護されたアカウントとグループの管理アカウントを作成する](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)」を参照してください。

Enterprise Admins は、既定では、フォレスト内の各ドメインの組み込みの Administrators グループのメンバーです。 各ドメインの管理者グループから Enterprise Admins グループを削除することは不適切な変更です。これは、フォレストのディザスターリカバリーシナリオでは、EA 権限が必要になる可能性があるためです。 Enterprise Admins グループがフォレスト内の管理者グループから削除されている場合は、各ドメインの Administrators グループに追加し、次の追加のコントロールを実装する必要があります。

- 前に説明したように、Enterprise Admins グループには、1日のうちにユーザーが含まれないようにする必要があります。ただし、 [「付録 D: Active Directory で Built-In 管理者アカウントをセキュリティで保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)する」の説明に従ってセキュリティで保護する必要があります。
- 各ドメインのメンバーサーバーとワークステーションを含む Ou にリンクされた Gpo では、EA グループを次のユーザー権利に追加する必要があります。
   - ネットワークからこのコンピューターへのアクセスを拒否
   - バッチ ジョブとしてのログオン権限を拒否する
   - サービスとしてのログオン権限を拒否する
   - ローカルでのログオンを拒否する
   - リモートデスクトップサービスによるログオンを拒否します。

これにより、EA グループのメンバーがメンバーサーバーおよびワークステーションにログオンするのを防ぐことができます。 ジャンプサーバーを使用してドメインコントローラーと Active Directory を管理する場合は、制限の厳しい Gpo がリンクされていない OU にジャンプサーバーが配置されていることを確認します。

- 監査は、EA グループのプロパティまたはメンバーシップに何らかの変更が加えられた場合にアラートを送信するように構成する必要があります。 これらのアラートは、少なくとも、Active Directory 管理とインシデント対応を担当するユーザーまたはチームに送信する必要があります。 また、グループの正当な作成が実行されたときの通知手順など、EA グループを一時的に作成するためのプロセスと手順も定義する必要があります。

#### <a name="securing-domain-admins-groups"></a>Domain Admins グループをセキュリティで保護する

Enterprise Admins グループの場合と同様に、Domain Admins グループのメンバーシップは、ビルドまたはディザスターリカバリーのシナリオでのみ必要になります。 [「付録 D: Active Directory での Built-In 管理者アカウントのセキュリティ保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)」で説明されているようにセキュリティで保護されている場合は、ドメインのローカル管理者アカウントを除き、日常のユーザーアカウントが DA グループに存在しないようにする必要があります。

DA へのアクセスが必要な場合、このレベルのアクセスを必要とするアカウントは、対象のドメインの DA グループに一時的に配置される必要があります。 ユーザーは高い特権を持つアカウントを使用していますが、ユーザーが変更を実行する1人のユーザーと、不注意による誤用や不適切な構成の可能性を最小限に抑えるために変更を観察するユーザーを使用して、アクティビティを監査する必要があります。 活動が完了したら、Domain Admins グループからアカウントを削除する必要があります。 これは、サードパーティの特権 id/アクセス管理 (PIM/PAM) ソフトウェアまたはその両方の組み合わせを使用して、手動の手順とドキュメント化されたプロセスを通じて実現できます。 Active Directory の特権グループのメンバーシップの制御に使用できるアカウントを作成するためのガイドラインについては、 [「付録 I: Active Directory で保護されたアカウントおよびグループの管理アカウントを作成](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)する」をご覧ください。

ドメイン管理者は、既定では、各ドメインのすべてのメンバーサーバーおよびワークステーション上のローカル Administrators グループのメンバーになります。 この既定の入れ子は、サポート性とディザスターリカバリーのオプションに影響するため、変更しないでください。 Domain Admins グループがメンバーサーバーのローカルの Administrators グループから削除されている場合は、リンクされた Gpo の制限されたグループ設定を使用して、ドメイン内の各メンバーサーバーおよびワークステーションの Administrators グループに追加する必要があります。 [「付録 F: Active Directory で Domain Admins グループをセキュリティで保護](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)する」で詳しく説明されている次の一般的なコントロールも実装する必要があります。

フォレスト内の各ドメインの Domain Admins グループについて、次のようにします。

1. [「付録 D: Active Directory での Built-In 管理者アカウントのセキュリティ保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)」で説明されているようにセキュリティで保護されていれば、DA グループからすべてのメンバーを削除します。
2. 各ドメインのメンバーサーバーとワークステーションを含む Ou にリンクされた Gpo では、次のユーザー権利に DA グループを追加する必要があります。
   - ネットワークからこのコンピューターへのアクセスを拒否
   - バッチ ジョブとしてのログオン権限を拒否する
   - サービスとしてのログオン権限を拒否する
   - ローカルでのログオンを拒否する
   - リモート デスクトップ サービスを使ったログオンを拒否

   これにより、DA グループのメンバーがメンバーサーバーおよびワークステーションにログオンできなくなります。 ジャンプサーバーを使用してドメインコントローラーと Active Directory を管理する場合は、制限の厳しい Gpo がリンクされていない OU にジャンプサーバーが配置されていることを確認します。

3. 監査は、DA グループのプロパティまたはメンバーシップに何らかの変更が加えられた場合にアラートを送信するように構成する必要があります。 これらのアラートは、少なくとも、AD DS 管理とインシデント対応を担当するユーザーまたはチームに送信する必要があります。 また、グループの正当な作成が実行されたときの通知手順を含め、DA グループに一時的に設定するためのプロセスと手順も定義する必要があります。

#### <a name="securing-administrators-groups-in-active-directory"></a>Active Directory の Administrators グループをセキュリティで保護する

EA および DA グループの場合と同様に、管理者 (BA) グループのメンバーシップは、ビルドまたはディザスターリカバリーのシナリオでのみ必要になります。 [「付録 D: Active Directory で Built-In 管理者アカウントを保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)する」で説明されているようにセキュリティで保護されている場合、ドメインのローカル管理者アカウントを除き、管理者グループには毎日のユーザーアカウントがない必要があります。

管理者アクセスが必要な場合、このレベルのアクセスを必要とするアカウントは、対象のドメインの Administrators グループに一時的に配置される必要があります。 ユーザーは高い特権を持つアカウントを使用していますが、アクティビティを監査する必要があります。また、変更を行ったユーザーと、不注意による誤用や誤った構成の可能性を最小限に抑えるために変更を観察しているユーザーとの間で実行する必要があります。 活動が完了すると、アカウントは管理者グループから直ちに削除されます。 これは、サードパーティの特権 id/アクセス管理 (PIM/PAM) ソフトウェアまたはその両方の組み合わせを使用して、手動の手順とドキュメント化されたプロセスを通じて実現できます。

管理者は、既定では、それぞれのドメイン内の AD DS オブジェクトのほとんどの所有者です。 このグループのメンバーシップは、所有権またはオブジェクトの所有権を取得する機能が必要なビルドおよびディザスターリカバリーのシナリオで必要になる場合があります。 さらに、DAs と EAs には、Administrators グループの既定のメンバーシップによって、多数の権限とアクセス許可が継承されています。 Active Directory の特権グループの既定のグループの入れ子を変更することはできません。また、 [「付録 G: Active Directory で管理者グループをセキュリティで保護](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)する」および一般的な手順に従って、各ドメインの管理者グループをセキュリティで保護する必要があります。

1. [「付録 D: Active Directory で Built-In 管理者アカウントを保護](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)する」で説明されているようにセキュリティで保護されている場合は、管理者グループからすべてのメンバーを削除します。ただし、ドメインのローカル管理者アカウントを除きます。
2. ドメインの Administrators グループのメンバーは、メンバーサーバーまたはワークステーションにログオンする必要はありません。 各ドメインのワークステーションとメンバーサーバー Ou にリンクされている1つ以上の Gpo で、Administrators グループを次のユーザー権利に追加する必要があります。
   - ネットワークからこのコンピューターへのアクセスを拒否
   - バッチジョブとしてのログオンを拒否する
   - サービスとしてのログオン権限を拒否する
   - これにより、Administrators グループのメンバーが、メンバーサーバーまたはワークステーションへのログオンまたは接続に使用されるのを防ぐことができます (複数のコントロールが最初に侵害された場合を除きます)。資格情報がキャッシュされ、それによって侵害される可能性があります。 特権のあるアカウントは、特権の低いシステムへのログオンには使用しないでください。これらのコントロールを適用すると、さまざまな攻撃に対する保護が強化されます。

3. フォレスト内の各ドメインのドメインコントローラー OU で、Administrators グループに次のユーザー権利が付与されている必要があります (これらの権限がない場合)。これにより、Administrators グループのメンバーは、フォレスト全体のディザスターリカバリーシナリオに必要な機能を実行できます。
   - ネットワークからこのコンピューターにアクセスする
   - ローカル ログオンを許可
   - リモート デスクトップ サービスを使ったログオンを許可

4. 監査は、管理者グループのプロパティまたはメンバーシップに何らかの変更が加えられた場合にアラートを送信するように構成する必要があります。 これらのアラートは、少なくとも、AD DS 管理を担当するチームのメンバーに送信される必要があります。 また、セキュリティチームのメンバーにアラートを送信する必要があります。また、管理者グループのメンバーシップを変更するための手順を定義する必要があります。 具体的には、これらのプロセスには、管理者グループが変更されたときに、通知が送信され、アラームが生成されないようにするために、セキュリティチームに通知する手順が含まれている必要があります。 さらに、管理者グループの使用が完了し、使用されているアカウントがグループから削除されている場合に、セキュリティチームに通知するプロセスを実装する必要があります。

> [!NOTE]
> Gpo の Administrators グループに制限を実装すると、Windows は、ドメインの Administrators グループに加えて、コンピューターのローカル管理者グループのメンバーにも設定を適用します。 そのため、管理者グループに制限を実装する場合は注意が必要です。 ネットワークの禁止、管理者グループのメンバーに対するバッチおよびサービスのログオンは、実装することが可能なすべての場所で推奨されますが、リモートデスクトップサービスによるローカルログオンやログオンを制限しないでください。 これらのログオンの種類をブロックすると、ローカルの Administrators グループのメンバーがコンピューターの正当な管理をブロックする可能性があります。 次のスクリーンショットは、組み込みのローカルまたはドメインの管理者アカウントの誤用をブロックする構成設定を示しています。組み込みのローカルまたはドメイン管理者グループの誤用もありません。 この設定に含めると、ローカルコンピューターの Administrators グループのメンバーであるアカウントのログオンもブロックされるので、 **[リモートデスクトップサービス経由でログオンを拒否** する] ユーザー権利には Administrators グループが含まれていないことに注意してください。 コンピューター上のサービスが、このセクションで説明されている特権グループのいずれかのコンテキストで実行されるように構成されている場合、これらの設定を実装すると、サービスとアプリケーションが失敗する可能性があります。 そのため、このセクションのすべての推奨事項と同様に、環境内の適用性の設定を十分にテストする必要があります。
>
> ![最小限の特権管理モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_3.gif)

### <a name="role-based-access-controls-rbac-for-active-directory"></a>Active Directory 用の Role-Based アクセス制御 (RBAC)

一般に、ロールベースのアクセス制御 (RBAC) は、ユーザーをグループ化し、ビジネスルールに基づいてリソースへのアクセスを提供するためのメカニズムです。 Active Directory の場合、AD DS 用の RBAC の実装は、権限とアクセス許可を委任するロールを作成するプロセスであり、ロールのメンバーは、過剰な権限を付与せずに日常的な管理タスクを実行できます。 Active Directory の RBAC は、ネイティブツールとインターフェイスを使用して設計および実装できます。これには、既に所有しているソフトウェアを利用したり、サードパーティ製品を購入したり、これらの方法を組み合わせたりすることができます。 このセクションでは、Active Directory に RBAC を実装する手順については説明しませんが、AD DS のインストールで RBAC を実装する方法を選択する際に考慮する必要がある要素について説明します。

#### <a name="native-approaches-to-rbac-for-active-directory"></a>Active Directory のための RBAC へのネイティブアプローチ

最も単純な RBAC 実装では、ロールを AD DS グループとして実装し、ロールの指定されたスコープ内で毎日の管理を実行できるようにするための権限とアクセス許可をグループに委任することができます。

場合によっては、Active Directory の既存のセキュリティグループを使用して、ジョブの機能に適した権限と権限を付与することができます。 たとえば、IT 組織内の特定の従業員が DNS ゾーンとレコードの管理と保守を担当している場合は、各 DNS 管理者のアカウントを作成し、そのアカウントを Active Directory の DNS Admins グループに追加するだけで、これらの役割を委任することができます。 DNS 管理者グループは、より高度な特権を持つグループとは異なり、Active Directory 全体で強力な権限を持っていますが、このグループのメンバーは、DNS の管理を許可するアクセス許可を委任されていても、侵害や不正使用によって特権が昇格される可能性があります。

また、グループのメンバーが指定した管理タスクを実行できるようにするには、セキュリティグループを作成し、権限とアクセス許可を Active Directory オブジェクト、ファイルシステムオブジェクト、およびレジストリオブジェクトに委任することが必要になる場合があります。 たとえば、ヘルプデスクのオペレーターがパスワードのリセット、接続に関する問題のあるユーザーの支援、アプリケーション設定のトラブルシューティングを行う必要がある場合は、ヘルプデスクユーザーがリモートでユーザーのコンピュータに接続してユーザーの構成設定を表示または変更できるようにする特権を使用して、Active Directory のユーザーオブジェクトに委任設定を結合する必要があります 定義するロールごとに、次のものを識別する必要があります。

1. ロールのメンバーが日常的に実行するタスクと、実行頻度の低いタスクを指定します。
2. ロールのどのアプリケーションメンバーに権限とアクセス許可を付与するかを指定します。
3. ロールのメンバーシップを付与するユーザーを指定します。
4. ロールメンバーシップの管理方法。

多くの環境では、Active Directory 環境を管理するためのロールベースのアクセス制御を手動で作成することは、実装と保守が困難な場合があります。 IT インフラストラクチャの管理について明確に定義されたロールと責任がある場合は、追加のツールを活用して、管理しやすいネイティブ RBAC デプロイの作成に役立てることができます。 たとえば、Forefront Identity Manager (FIM) が環境内で使用されている場合は、FIM を使用して管理ロールの作成と作成を自動化できます。これにより、継続的な管理が容易になります。 Microsoft Endpoint Configuration Manager と System Center Operations Manager (SCOM) を使用している場合は、アプリケーション固有の役割を使用して管理機能と監視機能を委任できます。また、ドメイン内のシステム全体で一貫した構成と監査を実施することもできます。 公開キー基盤 (PKI) を実装している場合は、環境の管理を担当する IT スタッフに対して、スマートカードを発行して要求することができます。 FIM Credential Management (FIM CM) を使用すると、管理スタッフのロールと資格情報の管理を組み合わせることもできます。

それ以外の場合は、"すぐに使える" 機能を提供するサードパーティの RBAC ソフトウェアの展開を検討することをお勧めします。 Active Directory、Windows、および Windows 以外のディレクトリとオペレーティングシステムの RBAC に対する商用の市販 (COTS) ソリューションは、多数のベンダーによって提供されています。 ネイティブソリューションとサードパーティ製品のどちらを選択する場合でも、次の要因を考慮する必要があります。

1. 予算: 既に所有しているソフトウェアとツールを使用して RBAC の開発に投資することで、ソリューションの展開に伴うソフトウェアコストを削減することができます。 ただし、ネイティブ RBAC ソリューションの作成とデプロイに経験があるスタッフがいない場合は、ソリューションを開発するためにコンサルティングリソースの関与が必要になることがあります。 カスタム開発されたソリューションの予想コストとコストを慎重に比較して、予算が限られている場合は特に、"すぐに使用できる" ソリューションをデプロイする必要があります。
2. IT 環境の構成: 環境が主に Windows システムで構成されている場合、または Windows 以外のシステムとアカウントを管理するために Active Directory を既に利用している場合は、カスタムネイティブソリューションによってニーズに最適なソリューションが提供されることがあります。 インフラストラクチャに Windows を実行しておらず、Active Directory で管理されていないシステムが多数含まれている場合は、Active Directory 環境とは別に、Windows 以外のシステムを管理するためのオプションを検討する必要があります。
3. ソリューションの特権モデル: 製品が Active Directory の高度な特権を持つグループにサービスアカウントを配置することに依存しており、RBAC ソフトウェアに対して過度の特権を付与する必要がないオプションが提供されていない場合は、ディレクトリ内の最上位のグループの構成を変更しただけで、Active Directory の攻撃対象領域が小さくなります。 アカウントが侵害され、悪用される可能性を最小限に抑えるために、アプリケーションベンダーがサービスアカウントの制御を提供できる場合を除き、他のオプションを検討することをお勧めします。

### <a name="privileged-identity-management"></a>Privileged Identity Management

Privileged identity management (PIM) は、特権アカウント管理 (PAM) または privileged credential management (PCM) とも呼ばれ、インフラストラクチャ内の特権アカウントを管理するためのアプローチの設計、構築、および実装です。 一般に、PIM では、アカウントに完全にアタッチされた権限を残すのではなく、ビルドまたは中断の修正機能を実行するために必要な一時的な権限とアクセス許可をアカウントに付与するメカニズムを提供します。 PIM 機能が手動で作成されているか、サードパーティ製ソフトウェアの展開によって実装されているかに関係なく、次の機能の1つまたは複数を使用できます。

- 資格情報 "コンテナー"。特権アカウントのパスワードは "チェックアウト" され、初期パスワードが割り当てられ、アクティビティが完了したときに "チェックインされました" になります。この時点で、アカウントのパスワードが再設定されます。
- 特権のある資格情報の使用に関する制限時間制約
- ワンタイム使用の資格情報
- ワークフローによって生成された特権の付与。実行されたアクティビティの監視とレポート、活動が完了したとき、または割り当てられた時間が経過したときの特権の自動削除
- アプリケーションプログラミングインターフェイス (Api) を使用してスクリプト内のユーザー名やパスワードなどのハードコーディングされた資格情報を、必要に応じて資格情報コンテナーから取得できるように置き換える
- サービスアカウントの資格情報の自動管理

### <a name="creating-unprivileged-accounts-to-manage-privileged-accounts"></a>特権のあるアカウントを管理するための特権のないアカウントの作成

特権アカウントを管理する際の課題の1つとして、既定では、特権のあるアカウントと保護されたアカウントおよびグループを管理できるアカウントが特権と保護されたアカウントになります。 Active Directory のインストールに適切な RBAC および PIM ソリューションを実装する場合、ソリューションには、ディレクトリ内の最も特権の高いグループのメンバーシップを効果的に作成し、グループを一時的に、必要に応じて設定するための方法が含まれていることがあります。

ただし、ネイティブ RBAC と PIM を実装する場合は、特権を持たないアカウントを作成し、必要に応じて Active Directory に特権グループの設定と入力を行う唯一の機能を使用することを検討してください。 [付録 I: Active Directory で保護されたアカウントとグループの管理アカウントを作成](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md) する手順に従って、この目的でアカウントを作成できます。

### <a name="implementing-robust-authentication-controls"></a>堅牢な認証制御の実装

*法 6: パスワードを推測しようとしている人がいます。* - [セキュリティ管理に関する10の不変法](/previous-versions/cc722488(v=technet.10))

ハッシュパスとその他の資格情報の盗難攻撃は、Windows オペレーティングシステムに固有のものではなく、新しいものでもありません。 最初のハッシュパス攻撃は、1997で作成されました。 しかし、従来は、これらの攻撃にはカスタマイズされたツールが必要でしたが、成功にヒットしたか、ミスがあったので、攻撃者は比較的高いスキルを持つ必要がありました。 資格情報をネイティブに抽出する、自由に利用できる、使いやすいツールの導入により、最近の年間での資格情報の盗難攻撃の回数と成功率が指数関数的に増加しました。 ただし、資格情報の盗難攻撃は、資格情報が対象として侵害される唯一のメカニズムではありません。

資格情報の盗難攻撃から保護するために、コントロールを実装する必要がありますが、攻撃者の対象となる可能性が最も高い環境内のアカウントを特定し、それらのアカウントに対して堅牢な認証制御を実装する必要もあります。 最上位の特権を持つアカウントがユーザー名やパスワードなどの単一要素認証を使用している場合 (どちらも1つの認証要素です)、これらのアカウントは弱く保護されています。 攻撃者が必要とするのは、そのアカウントに関連付けられているパスワードのユーザー名と知識を知っている必要があります。また、ハッシュパス攻撃は必要ありません。これにより、攻撃者は、単一要素の資格情報を受け入れる任意のシステムに対してユーザーとして認証を行うことができます。

Multi-factor authentication を実装しても、ハッシュのパススルー攻撃を防ぐことはできませんが、multi-factor authentication を保護されたシステムと組み合わせて実装することは可能です。 保護されたシステムの実装の詳細については、「セキュリティで保護された [管理ホストの実装](../../../ad-ds/plan/security-best-practices/Implementing-Secure-Administrative-Hosts.md)」を参照してください。

#### <a name="general-authentication-controls"></a>一般的な認証コントロール

スマートカードなどの多要素認証をまだ実装していない場合は、その方法を検討してください。 スマートカードは、公開キーと秘密キーのペアで秘密キーのハードウェアによる保護を実装するため、ユーザーが適切な PIN、パスコード、または生体認証 id をスマートカードに提示しない限り、ユーザーの秘密キーがアクセスされたり使用されたりすることはありません。 侵害されたコンピューターでユーザーの PIN やパスコードがキーストロークロガーによって傍受された場合でも、攻撃者が PIN やパスコードを再利用するためには、カードが物理的に存在している必要があります。

複雑なパスワードを使用すると、ユーザーの抵抗によって実装が困難になる場合があります。スマートカードは、ブルートフォース攻撃やレインボーテーブル攻撃に対して資格情報が脆弱になることなく、比較的単純な Pin やパスコードを実装できるメカニズムを提供します。 スマートカードの Pin は Active Directory またはローカルの SAM データベースには保存されませんが、認証にスマートカードが使用されているコンピューターの LSASS で保護されたメモリに資格情報のハッシュが保存される場合があります。

#### <a name="additional-controls-for-vip-accounts"></a>VIP アカウントの追加の制御

スマートカードまたはその他の証明書ベースの認証メカニズムを実装するもう1つの利点は、認証メカニズムアシュアランスを利用して、VIP ユーザーがアクセスできる機密データを保護できることです。 認証メカニズムの保証は、機能レベルが Windows Server 2012 または Windows Server 2008 R2 に設定されているドメインで使用できます。 認証メカニズムアシュアランスを有効にすると、ユーザーの資格情報が証明書ベースのログオン方法を使用してログオン時に認証されるときに、管理者が指定したグローバルグループメンバーシップがユーザーの Kerberos トークンに追加されます。

これにより、リソース管理者は、使用する証明書の種類に加えて、証明書ベースのログオン方法を使用してユーザーがログオンしたかどうかに基づいて、ファイル、フォルダー、プリンターなどのリソースへのアクセスを制御することができます。 たとえば、ユーザーがスマートカードを使用してログオンした場合、ユーザーがスマートカードを使用しない場合 (つまり、ユーザー名とパスワードを入力してログオンしたとき) には、ネットワーク上のリソースに対するユーザーのアクセス権を指定できます。 認証メカニズムの保証の詳細については、「 [Windows Server 2008 R2 の AD DS の認証メカニズムの保証」ステップバイステップガイド](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd378897(v=ws.10))を参照してください。

#### <a name="configuring-privileged-account-authentication"></a>特権アカウントの認証の構成

すべての管理者アカウントの Active Directory で、[ **対話型ログオンにスマートカードを必要** とする] を有効にし、アカウントの [ **アカウント** ] タブの属性 (Cn、Name、SAMAccountName、userPrincipalName、userAccountControl など) のいずれかの属性を (少なくとも) 管理ユーザーオブジェクトに対して監査します。

アカウントの [ **対話型ログオンにスマートカードを必要** とする] を設定すると、アカウントのパスワードは120文字のランダム値にリセットされ、対話型ログオンにはスマートカードが必要になりますが、アカウントのパスワードの変更を許可するアクセス許可を持つユーザーは、そのアカウントを使用して、ユーザー名とパスワードのみを使用できます。

また、Active Directory 証明書サービス (AD CS) またはサードパーティの PKI で Active Directory と証明書の設定に含まれるアカウントの構成によっては、ここで説明するように、管理アカウントまたは VIP アカウントのユーザープリンシパル名 (UPN) 属性を特定の種類の攻撃の対象にすることができます。

##### <a name="upn-hijacking-for-certificate-spoofing"></a>証明書スプーフィングの UPN ハイジャック

公開キー基盤 (Pki) に対する攻撃の詳細については、このドキュメントでは説明しませんが、パブリックとプライベートの Pki に対する攻撃は、2008以降指数関数的に増加しました。 パブリック Pki の侵害は広く普及していますが、組織の内部 PKI に対する攻撃は、さらに豊富になる可能性があります。 このような攻撃の1つは、Active Directory と証明書を利用して、攻撃者が、検出するのが困難な方法で他のアカウントの資格情報になりすますことができるようにすることです。

ドメインに参加しているシステムに対する認証のために証明書が提示された場合、証明書のサブジェクトまたはサブジェクト代替名 (SAN) の属性を使用して、Active Directory のユーザーオブジェクトに証明書をマップします。 証明書の種類とその構築方法に応じて、証明書の Subject 属性には通常、次のスクリーンショットに示すように、ユーザーの共通名 (CN) が含まれます。

![最小限の特権管理モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_4.gif)

既定では、Active Directory は、アカウント名と姓を連結してユーザーの CN を構築します。 ただし、Active Directory 内のユーザーオブジェクトの CN コンポーネントは必須ではなく、一意であることが保証されます。また、ディレクトリ内の別の場所にユーザーアカウントを移動すると、ディレクトリ内のオブジェクトへの完全なパスであるアカウントの識別名 (DN) が変更されます。

証明書のサブジェクト名は静的であるか、または一意であるとは限らないため、サブジェクトの別名の内容は、Active Directory でユーザーオブジェクトを特定するためによく使用されます。 エンタープライズ証明機関 (Active Directory 統合 Ca) からユーザーに発行される証明書の SAN 属性には、通常、ユーザーの UPN または電子メールアドレスが含まれます。 Upn は AD DS フォレスト内で一意であることが保証されるため、UPN によってユーザーオブジェクトを検索することは、通常、認証プロセスに含まれる証明書の有無にかかわらず、認証の一部として実行されます。

認証証明書の SAN 属性で Upn を使用すると、攻撃者は不正な証明書を取得できます。 ユーザーオブジェクトで Upn の読み取りと書き込みを行う権限を持つアカウントが攻撃者によって侵害された場合、攻撃は次のように実装されます。

ユーザーオブジェクト (VIP ユーザーなど) の UPN 属性は、一時的に別の値に変更されます。 SAM アカウント名の属性と CN は、この時点でも変更できますが、これは、前述の理由では通常必要ありません。

ターゲットアカウントの UPN 属性が変更されると、古い、有効なユーザーアカウント、または新しく作成されたユーザーアカウントの UPN 属性が、最初にターゲットアカウントに割り当てられた値に変更されます。 有効になっている古いユーザーアカウントは、長期間ログオンしていないが、無効になっていないアカウントです。 これらは、次の理由により、"普通に見えないようにする" ことを意図している攻撃者によって対象となります。

1. アカウントは有効になっていますが、最近使用されていないため、アカウントを使用すると、無効になっているユーザーアカウントを有効にする方法でアラートがトリガーされることはほとんどありません。
2. 既存のアカウントを使用する場合は、管理スタッフによって認識される可能性のある新しいユーザーアカウントを作成する必要はありません。
3. まだ有効になっている古いユーザーアカウントは、通常、さまざまなセキュリティグループのメンバであり、ネットワーク上のリソースへのアクセスが許可され、既存のユーザー設定へのアクセスが簡略化されます。

ターゲット UPN が現在構成されているユーザーアカウントを使用して、Active Directory 証明書サービスに1つ以上の証明書を要求します。

攻撃者のアカウントの証明書が取得されると、"新規" アカウントの Upn とターゲットアカウントの Upn が元の値に戻ります。

攻撃者には、ユーザーがアカウントが一時的に変更された VIP ユーザーであるかのように、リソースとアプリケーションに対して認証用に提示できる証明書が1つ以上あります。 証明書と PKI を攻撃者が対象とするすべての方法については、このドキュメントでは説明しませんが、この攻撃メカニズムを使用して、アカウントの [ **アカウント** ] タブの属性 (cn、Name、SAMAccountName、UserPrincipalName、userAccountControl など) に対する変更について、AD DS の特権アカウントおよび VIP アカウントを監視する必要があります。 アカウントの監視に加えて、アカウントを変更できるユーザーを、可能な限り少数の管理ユーザーに制限する必要があります。 同様に、管理ユーザーのアカウントは、承認されていない変更を保護および監視する必要があります。
