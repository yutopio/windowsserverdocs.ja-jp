---
description: '詳細情報: セキュリティ侵害の手段'
ms.assetid: d7a4d2e1-217d-4ffc-93f0-817149bd9e7f
title: セキュリティ侵害に至る過程
author: iainfoulds
ms.author: daveba
manager: daveba
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: f85fdb8c723972ce1d441d45510b738d0e166cff
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "97045510"
---
# <a name="avenues-to-compromise"></a>セキュリティ侵害に至る過程

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

*法律番号 7: 最も安全なネットワークは、適切に管理されたネットワークです。* - [セキュリティ管理に関する10の不変法](/previous-versions/cc722488(v=technet.10))

深刻な侵害イベントが発生している組織では、評価は通常、組織が IT インフラストラクチャの実際の状態の可視性を制限していることを明らかにします。これは、"ドキュメント化された" 状態とは大きく異なる場合があります。 このような差異によって、攻撃者が環境を効果的に "所有" している時点まで、セキュリティ侵害が発生するのを防ぐために、環境を危険にさらす危険性が生じます。

これらの組織の AD DS 構成、公開キー基盤 (Pki)、サーバー、ワークステーション、アプリケーション、アクセス制御リスト (Acl)、およびその他のテクノロジの詳細な評価により、修復されなかった場合に、初期の侵害を防ぐことができる構成の誤りや脆弱性が明らかになります。

IT ドキュメント、プロセス、および手順の分析によって、Active Directory フォレストを完全に侵害するために使用された特権を最終的に取得するために攻撃者によって利用された、管理者の作業のギャップによって導入される脆弱性が特定されます。 完全に侵害されたフォレストとは、攻撃者が個々のシステム、アプリケーション、またはユーザーアカウントだけでなく、アクセスをエスカレートして、フォレストのすべての要素を変更または破棄できるレベルの特権を取得することです。 Active Directory インストールのセキュリティが侵害された場合、攻撃者は、環境全体での存在を維持したり、より悪いディレクトリや管理対象のシステムやアカウントを破棄したりできるように変更を加えることができます。

この後の説明でよく利用されている脆弱性の多くは Active Directory に対する攻撃ではありませんが、攻撃者は、特権エスカレーション (特権昇格とも呼ばれます) 攻撃を実行し、最終的に AD DS をターゲットにしてセキュリティを侵害するために使用できる環境に足掛かりを確立することができます。

このドキュメントのこのセクションでは、攻撃者がインフラストラクチャにアクセスし、最終的に特権昇格攻撃を開始するために使用するメカニズムについて説明します。 次のセクションも参照してください。

-   [Active Directory の攻撃対象領域の削減](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md) Active Directory のセキュリティで保護された構成に関する詳細な推奨事項。

-   [侵害の兆候の Active Directory を監視する](../../../ad-ds/plan/security-best-practices/Monitoring-Active-Directory-for-Signs-of-Compromise.md) セキュリティ侵害の検出に役立つ推奨事項

-   [セキュリティ侵害の計画](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) IT およびビジネスの観点からインフラストラクチャに対する攻撃を準備するための高度なアプローチ

> [!NOTE]
> このドキュメントでは、AD DS ドメインの一部である Active Directory および Windows システムに焦点を当てていますが、攻撃者が Active Directory と Windows だけに焦点を当てることはほとんどありません。 オペレーティングシステム、ディレクトリ、アプリケーション、およびデータリポジトリが混在する環境では、Windows 以外のシステムも侵害されていることがよくわかります。 これは、windows および UNIX または Linux クライアントがアクセスするファイルサーバー、複数のオペレーティングシステムに認証サービスを提供するディレクトリ、異なるディレクトリ間でデータを同期するメタディレクトリなど、windows 環境と Windows 以外の環境の間に "ブリッジ" を提供するシステムの場合に特に当てはまります。
>
> AD DS は、集中管理されたアクセスと構成の管理機能により、Windows システムだけでなく、他のクライアントにも提供されます。 認証および構成管理サービスを提供するその他のディレクトリまたはアプリケーションは、特定の攻撃者によって対象となります。 このドキュメントでは、Active Directory インストールのセキュリティ侵害の可能性を低減できる保護に焦点を合わせていますが、Windows 以外のコンピューター、ディレクトリ、アプリケーション、またはデータリポジトリを含むすべての組織が、これらのシステムに対する攻撃を準備する必要もあります。

## <a name="initial-breach-targets"></a>最初の違反ターゲット
だれも故意に組織を公開する IT インフラストラクチャを意図的に構築することはありません。 Active Directory フォレストが最初に構築されると、通常は不自然と current になります。 数年が経過すると、新しいオペレーティングシステムとアプリケーションが獲得されると、フォレストに追加されます。 Active Directory によって提供される管理容易性の利点が認識されると、ディレクトリに追加されるコンテンツが増え、コンピューターやアプリケーションを AD DS と統合できるようになります。また、ドメインは、最新バージョンの Windows オペレーティングシステムで提供される新しい機能をサポートするためにアップグレードされます。 ただし、時間の経過と共に発生するのは、新しいインフラストラクチャを追加している場合でも、インフラストラクチャの他の部分が管理されていない可能性があります。また、システムとアプリケーションが正常に機能しているために注意が必要ないため、組織は従来のインフラストラクチャを排除していないことを忘れてしまいます。 侵害されたインフラストラクチャの評価、古い、大規模、複雑な環境の評価に基づいて、一般的に悪用される脆弱性の多くのインスタンスが存在する可能性が高くなります。

攻撃者の動機に関係なく、ほとんどの情報セキュリティ侵害は、一度に1つまたは2つのシステムを侵害することから始まります。 これらの初期イベントまたはネットワークへのエントリポイントは、多くの場合、修正された可能性があっても修正されなかった脆弱性を活用します。 [2012 のデータ侵害調査レポート (DBIR)](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf)は、米国のセキュリティ機関およびその他の企業と協力して Verizon リスクチームによって作成された年次調査であり、96% の攻撃が "非常に困難" であるということ、および 97 "侵害のあればがシンプルまたは中間の制御によって侵害された" ということを これらの結果は、次に示す一般的な脆弱性の影響を受ける可能性があります。

### <a name="gaps-in-antivirus-and-antimalware-deployments"></a>ウイルス対策およびマルウェア対策展開におけるギャップ
*法 8: 最新ではないマルウェアスキャナーは、スキャナーがまったくない場合にのみわずかに優れています。* - [セキュリティに関する10の不変法 (バージョン 2.0)](https://www.microsoft.com/en-us/msrc?rtc=1)

多くの場合、組織のウイルス対策およびマルウェア対策展開の分析によって、ほとんどのワークステーションが、有効で最新のウイルス対策ソフトウェアおよびマルウェア対策ソフトウェアで構成されている環境が明らかになります。 例外は通常、企業環境や従業員のデバイスに接続することの少ないワークステーションで、ウイルス対策ソフトウェアやマルウェア対策ソフトウェアを展開、構成、更新するのが困難な場合があります。

ただし、サーバーの作成は、侵害が多い多くの環境では一貫して保護されない傾向があります。 [2012 のデータ侵害の調査](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf)で報告されているように、すべてのデータ侵害の94% が、前年比18% の増加を表し、マルウェアが含まれている攻撃の69% を表します。 サーバーの作成では、ウイルス対策およびマルウェア対策のインストールの構成が一貫していない、古い、正しく構成されていない、または無効になっていることは珍しくありません。 場合によっては、ウイルス対策ソフトウェアとマルウェア対策ソフトウェアが管理スタッフによって無効にされていることもありますが、攻撃者は他の脆弱性によってサーバーを侵害した後にソフトウェアを無効にします。 ウイルス対策ソフトウェアとマルウェア対策ソフトウェアが無効になっている場合、攻撃者はサーバーにマルウェアをプラント化し、サーバーの作成全体にわたってセキュリティ侵害の危険に注力します。

システムが最新の包括的なマルウェア対策によって保護されていることを確認するだけでなく、ウイルス対策ソフトウェアとマルウェア対策ソフトウェアを無効化または削除するシステムを監視し、手動で無効にした場合に自動的に保護を再開することも重要です。 ウイルス対策ソフトウェアやマルウェア対策ソフトウェアでは、すべての感染を防止し、検出することはできませんが、適切に構成して展開したウイルス対策およびマルウェア対策の実装により、感染の可能性が低下する可能性があります。

### <a name="incomplete-patching"></a>不完全な修正プログラム
*法 3: セキュリティの修正については、お客様のネットワークが長期に合わない場合に使用します。* - [セキュリティ管理に関する10の不変法](/previous-versions/cc722488(v=technet.10))

Microsoft は毎月第2火曜日にセキュリティ情報をリリースしますが、まれに、お客様のシステムに対して緊急のリスクをもたらすために脆弱性が特定された場合、月例のセキュリティ更新プログラム (これらは "帯域外" 更新プログラムとも呼ばれます) の間でセキュリティ更新プログラムがリリースされます。 小規模企業で、システムとアプリケーションの修正プログラムの適用に Windows Update を使用するように Windows コンピューターを構成するか、または大規模な組織で Microsoft Endpoint Configuration Manager などの管理ソフトウェアを使用して、詳細な階層の計画に従って修正プログラムを展開するかにかかわらず、多くのお客様が Windows インフラストラクチャを比較的タイムリーに修正します。

ただし、Windows コンピューターと Microsoft アプリケーションのみを含むインフラストラクチャはほとんどありませんが、侵害された環境では、組織の修正プログラム管理戦略にギャップがあることを確認するのが一般的です。 これらの環境の Windows システムでは、修正プログラムの適用が一貫していません。 Windows 以外のオペレーティングシステムでは、すべてのオペレーティングシステムが散発的に適用されます。 商用市販 (COTS) アプリケーションには、修正プログラムが存在するものの、適用されていない脆弱性が含まれています。 多くの場合、ネットワークデバイスは工場出荷時の既定の資格情報を使用して構成され、インストール後にファームウェアが更新されることはありません。 ベンダーによってサポートされなくなったアプリケーションとオペレーティングシステムは、多くの場合、脆弱性に対する修正プログラムを適用できなくなっても、実行されたままになります。 これらの各修正プログラム脆弱性システムは、攻撃者にとって潜在的なもう1つのエントリポイントを表します。

また、従業員所有のデバイスが会社所有のデータにアクセスするために使用されているため、その企業のコンシューマライゼーションによって追加の課題が発生しています。また、組織は、従業員の個人のデバイスの修正プログラムと構成をほとんど制御する必要がありません。 通常、エンタープライズクラスのハードウェアには、エンタープライズ対応の構成オプションと管理機能が付属しています。これは、個々のカスタマイズとデバイス選択ではあまり選択肢がないということです。 従業員重視のハードウェアには、より広範な製造元、ベンダー、ハードウェアのセキュリティ機能、ソフトウェアのセキュリティ機能、管理機能、および構成オプションが用意されており、多くのエンタープライズ機能が完全に欠けている可能性があります。

#### <a name="patch-and-vulnerability-management-software"></a>修正プログラムと脆弱性管理ソフトウェア
Windows システムと Microsoft アプリケーションに対して効果的な修正プログラム管理システムが導入されている場合は、修正プログラム脆弱性脆弱性の作成によって攻撃を受ける可能性があります。 ただし、Windows 以外のシステム、Microsoft 以外のアプリケーション、ネットワークインフラストラクチャ、および従業員のデバイスも、修正プログラムやその他の修正プログラムによって最新の状態に保たれている場合を除き、インフラストラクチャは脆弱な状態のままです。 場合によっては、アプリケーションのベンダーが自動更新機能を提供することがあります。それ以外の場合は、修正プログラムやその他の修正プログラムを定期的に取得して適用するためのアプローチを考案する必要があります。

### <a name="outdated-applications-and-operating-systems"></a>古くなったアプリケーションとオペレーティングシステム
*"6 年前のオペレーティングシステムでは、6か月前の攻撃から保護することは期待できません。"* -エンタープライズインストールのセキュリティを10年間経験した情報セキュリティ Professional

「最新の情報を入手する」はマーケティング用のフレーズのように聞こえますが、古いオペレーティングシステムとアプリケーションは、多くの組織の IT インフラストラクチャにリスクを持ちます。 2003でリリースされたオペレーティングシステムは、ベンダーによって引き続きサポートされており、脆弱性に対処するための更新プログラムが提供されている場合がありますが、そのオペレーティングシステムには、新しいバージョンのオペレーティングシステムで追加されたセキュリティ機能が含まれていない可能性があります。 古くなったシステムでは、特定の AD DS セキュリティ構成を使用して、これらのコンピューターのより低い機能をサポートする必要がある場合もあります。

アプリケーションをサポートしなくなったベンダーが従来の認証プロトコルを使用するように記述されたアプリケーションは、通常、より強力な認証メカニズムをサポートするために再利用することはできません。 ただし、このようなアプリケーションをサポートするために LAN Manager ハッシュまたは可逆暗号化パスワードを保存するように、組織の Active Directory ドメインを構成することもできます。 新しいオペレーティングシステムの導入前に作成されたアプリケーションは、現在のオペレーティングシステムでは正常に機能しない場合もあれば、古いシステムを保守する必要がある場合や、場合によっては完全にサポートされていないハードウェアとソフトウェアを管理する必要があります。

組織がドメインコントローラーを Windows Server 2012、Windows Server 2008 R2、または Windows Server 2008 に更新した場合でも、通常は、Windows Server 2003、Windows 2000 Server、または Windows NT Server 4.0 (完全にサポートされていない) を実行しているメンバーサーバーの作成の大部分を検索します。 組織がエージングシステムを保持する時間が長くなるほど、機能セット間の不一致が増加し、実稼働システムがサポートされなくなる可能性が高くなります。 さらに、Active Directory フォレストが保持される時間が長くなるほど、アップグレード計画でレガシシステムとアプリケーションが不足していることがわかります。 これは、Active Directory がレガシプロトコルと認証メカニズムをサポートするように構成されているため、単一のアプリケーションを実行する1台のコンピューターでドメインまたはフォレスト全体の脆弱性が発生する可能性があることを意味します。

レガシシステムとアプリケーションを排除するには、まず、それらを識別してカタログ化し、次にアプリケーションまたはホストをアップグレードするか置き換えるかを決定する必要があります。 サポートもアップグレードパスも存在しない高度に特殊化されたアプリケーションの代替を見つけるのは困難ですが、"creative 破壊" という概念を活用して、レガシアプリケーションを、必要な機能を提供する新しいアプリケーションに置き換えることができます。 [侵害の計画](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) については、このドキュメントで後述する「侵害の計画」で詳しく説明しています。

### <a name="misconfiguration"></a>誤った構成
*法 4: 最初にセキュリティで保護されていないコンピューターにセキュリティ修正プログラムをインストールすることは、あまり良い方法ではありません。* - [セキュリティ管理に関する10の不変法](/previous-versions/cc722488(v=technet.10))

システムが通常は最新のままになっており、パッチが適用されている環境でも、オペレーティングシステム、コンピューターで実行されているアプリケーション、および Active Directory におけるギャップや不備を特定することがよくあります。 一部の不備は、セキュリティ侵害のためにローカルコンピューターのみを公開していますが、コンピューターが "所有者" になった後、攻撃者は通常、他のシステム間のセキュリティ侵害をさらに伝達し、最終的には Active Directory することに専念します。 リスクをもたらす構成を特定する一般的な領域の一部を次に示します。

#### <a name="in-active-directory"></a>Active Directory
攻撃者によって最も一般的に対象となる Active Directory のアカウントは、ドメイン管理者 (DA)、Enterprise Admins (EA)、または Active Directory の組み込み管理者 (BA) グループのメンバーなど、最も高い特権を持つグループのメンバーであるアカウントです。 これらのグループのメンバーシップは、可能な限り少数のアカウントに減らす必要があります。これにより、これらのグループの攻撃対象領域が制限されます。 これらの特権グループの "永続的な" メンバーシップを排除することもできます。つまり、ドメインおよびフォレスト全体の特権が必要な場合にのみ、これらのグループを一時的に作成できる設定を実装できます。 高い特権を持つアカウントを使用する場合は、ドメインコントローラーやセキュリティで保護された管理ホストなど、指定されたセキュリティで保護されたシステムでのみ使用する必要があります。 これらの構成をすべて実装するのに役立つ詳細情報については [、「Active Directory の攻撃対象領域を減らす](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)」を参照してください。

Active Directory で最上位の特権を持つグループのメンバーシップを評価すると、一般的に、3つの最上位レベルのすべてのグループのメンバーシップが過剰に検出されます。 場合によっては、DA グループに数十のアカウントが含まれている組織もあります。 それ以外の場合、組織はアカウントを組み込みの管理者グループに直接配置し、そのグループが DAs グループよりも "低い特権" であると考えます。 そうじゃないです。 多くの場合、ea の特権はめったになく一時的に必要であるという事実にかかわらず、EA グループの一部の永続的なメンバーがフォレストのルートドメインにあります。 これは実質的に冗長な構成でも、3つのグループすべてで IT ユーザーの日常の管理アカウントを見つけることも一般的です。 アカウントがこれらのグループのいずれかの永続的なメンバーであるか、またはそのすべてのアカウントであるかについては、「 [Active Directory の攻撃対象領域を減らす](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)」で説明されているように、アカウントを使用して、AD DS 環境とそれによって管理されるシステムとアカウントを破棄することもできます。 Active Directory におけるセキュリティで保護された構成と特権アカウントの使用に関する推奨事項については、 [Active Directory の攻撃対象領域を削減](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)することをお勧めします。

#### <a name="on-domain-controllers"></a>ドメインコントローラーの場合
ドメインコントローラーを評価する際には、多くの場合、メンバーサーバーとは異なる方法で構成および管理されていることがわかります。 ドメインコントローラーでは、メンバーサーバーにインストールされているのと同じアプリケーションとユーティリティが実行されることがあります。ドメインコントローラーで必要になるわけではありませんが、アプリケーションは標準ビルドの一部であるためです。 これらのアプリケーションは、ドメインコントローラーの最小限の機能を提供しますが、ポートを開いたり、高い特権を持つサービスアカウントを作成したり、認証やグループポリシーアプリケーション以外の目的のためにドメインコントローラーに接続しないユーザーによってシステムへのアクセスを許可したりすることにより、攻撃を大幅に向上させることができます。 侵害によっては、ドメインコントローラーへのアクセスを取得するだけでなく、AD DS データベースを変更または破損するために、ドメインコントローラーに既にインストールされていたツールを攻撃者が使用していることもあります。

ドメインコントローラーで Internet Explorer の構成設定を抽出すると、Active Directory で高いレベルの特権を持つアカウントを使用してユーザーがログオンし、ドメインコントローラーからインターネットおよびイントラネットにアクセスするためにアカウントを使用していることがわかります。 場合によっては、インターネットコンテンツのダウンロードを許可するようにアカウントがドメインコントローラー上で Internet Explorer の設定を構成し、フリーウェアユーティリティがインターネットサイトからダウンロードされ、ドメインコントローラーにインストールされていることがあります。 Internet Explorer セキュリティ強化の構成は、既定ではユーザーと管理者に対して有効になっていますが、多くの場合、は管理者に対して無効になっていることに注意してください。 高い特権を持つアカウントがインターネットにアクセスし、任意のコンピューターにコンテンツをダウンロードすると、そのコンピューターは深刻なリスクを負うことになります。 コンピューターがドメインコントローラーである場合は、AD DS インストール全体が危険にさらされます。

##### <a name="protecting-domain-controllers"></a>ドメインコントローラーの保護
ドメインコントローラーは、重要なインフラストラクチャコンポーネントとして処理され、より厳密に保護され、ファイル、印刷、アプリケーションサーバーよりも厳格に構成される必要があります。 ドメインコントローラーが機能するために不要なソフトウェアや、ドメインコントローラーを攻撃から保護しないソフトウェアは、ドメインコントローラーで実行しないでください。 ドメインコントローラーはインターネットにアクセスできないようにし、セキュリティ設定はグループポリシーオブジェクト (Gpo) によって構成および適用される必要があります。 ドメインコントローラーのセキュリティで保護されたインストール、構成、および管理に関する詳細な推奨事項については、「 [ドメインコントローラーを攻撃から保護](../../../ad-ds/plan/security-best-practices/Securing-Domain-Controllers-Against-Attack.md)する」をお勧めします。

#### <a name="within-the-operating-system"></a>オペレーティングシステム内
*法律番号 2: 悪意のあるユーザーがコンピューター上のオペレーティングシステムを変更できる場合は、コンピューターではなくなります。* - [セキュリティに関する10の不変法 (バージョン 2.0)](https://www.microsoft.com/en-us/msrc?rtc=1)

組織によっては、さまざまな種類のサーバーのベースライン構成を作成し、インストール後にオペレーティングシステムの制限付きカスタマイズを可能にするものもありますが、侵害された環境の分析では、多くの場合、アドホックな方法で展開され、手動で個別に構成された多数のサーバーが明らかになります。 同じ機能を実行する2台のサーバー間の構成は、どちらのサーバーも安全に構成されていない場合、まったく異なる場合があります。 逆に、サーバー構成基準は一貫して強制されますが、一貫して正しく構成されていない場合もあります。つまり、サーバーは、特定の種類のすべてのサーバーで同じ脆弱性を作成するように構成されます。 構成の誤りには、セキュリティ機能の無効化、アカウント (特にサービスアカウント) への過度の権限とアクセス許可の付与、システム間での同一のローカル資格情報の使用、および独自の脆弱性を作成する承認されていないアプリケーションやユーティリティのインストールの許可などのプラクティスが含まれます。

##### <a name="disabling-security-features"></a>セキュリティ機能の無効化
場合によっては、WFAS のセキュリティが強化された Windows ファイアウォール (WFAS) を無効にすることがあります。 ただし、Windows Server 2008 以降では、役割または機能がサーバーにインストールされている場合は、役割または機能が機能するために必要な最小限の特権で既定で構成され、Windows ファイアウォールは役割または機能をサポートするように自動的に構成されます。 (他のホストベースのファイアウォールを使用せずに) WFAS を無効にすることにより、組織は Windows 環境全体の攻撃対象領域を増やします。 境界ファイアウォールは、インターネットから環境を直接ターゲットとする攻撃に対して何らかの保護を提供しますが、 [ドライブごとのダウンロード](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) 攻撃や、イントラネット上の他の侵害されたシステムからの攻撃など、他の攻撃ベクトルを悪用する攻撃に対する保護を提供しません。

サーバーでは、ユーザーアカウント制御 (UAC) の設定が無効になることがあります。これは、管理スタッフがメッセージを邪魔にするためです。 [Microsoft サポートの記事 2526083](https://support.microsoft.com/kb/2526083)では、Windows SERVER で uac を無効にできるシナリオについて説明していますが、Server core インストール (uac が設計によって無効にされている) を実行していない場合は、慎重に考慮して調査することなく、サーバーで uac を無効にしないでください。

それ以外の場合、サーバー設定は、セキュリティが低下した値に構成されます。これは、オペレーティングシステムの変更を反映するためにベースラインを変更することなく、windows server 2012、Windows Server 2008 R2、または Windows Server 2008 を実行しているコンピューターに Windows Server 2003 の基準を適用するなど、古いサーバー構成設定を新しいオペレーティングシステム 新しいオペレーティングシステムに古いサーバーベースラインを使用するのではなく、新しいオペレーティングシステムを展開するときに、セキュリティの変更と構成設定を確認して、実装されている設定が新しいオペレーティングシステムに適用可能であり、適切であることを確認します。

##### <a name="granting-excessive-privilege"></a>過剰な特権の付与
評価したほぼすべての環境で、Windows システムのローカルアカウントとドメインベースのアカウントに過度の特権が付与されます。 ユーザーには、ワークステーションのローカル管理者権限が付与されます。メンバーサーバーは、機能する必要がある以外の権限で構成されたサービスを実行します。また、サーバーの設定全体のローカル管理者グループには、数十または数百のローカルおよびドメインのアカウントが含まれます。 コンピューター上の特権アカウントが1つだけ侵害されると、攻撃者は、コンピューターにログオンするすべてのユーザーとサービスのアカウントを侵害し、資格情報を使用して他のシステムにセキュリティ侵害を伝達することができます。

ハッシュパス (PTH) やその他の資格情報の盗難攻撃は、現在は広く普及していますが、攻撃者がコンピューターに対して管理者またはシステムレベルのアクセス権を取得した場合に、他の特権アカウントの資格情報を簡単かつ簡単に抽出できるようにする、自由に利用できるツールがあるからです。 ログオンセッションから資格情報を取得できるツールがない場合でも、コンピューターへの特権アクセスを持つ攻撃者は、キーストローク、スクリーンショット、およびクリップボードの内容をキャプチャするキーストロークロガーを簡単にインストールできます。 コンピューターへの特権アクセスを持つ攻撃者は、マルウェア対策ソフトウェアを無効にしたり、ルートキットをインストールしたり、保護されたファイルを変更したり、攻撃を自動化するコンピューターにマルウェアをインストールしたり、サーバーを [ドライブ単位のダウンロード](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) ホストに変換したりすることができます。

1台のコンピューターを超える侵害を拡張するために使用される戦術は異なりますが、セキュリティを侵害するための鍵は、追加のシステムへの高度な特権アクセスを取得することです。 任意のシステムへの特権アクセスを持つアカウントの数を減らすことで、そのコンピューターだけでなく攻撃対象領域を減らすことができますが、攻撃者がコンピューターから貴重な資格情報を収集する可能性は低くなります。

##### <a name="standardizing-local-administrator-credentials"></a>ローカル管理者の資格情報の標準化
セキュリティ専門家には、Windows コンピューター上のローカル管理者アカウントの名前変更に価値があるかどうかに関して、長年にかかわらず議論されています。 ローカル管理者アカウントでは、複数のコンピューター間で同じユーザー名とパスワードを使用して構成されているかどうかについて、実際に重要なのは何ですか。

ローカル管理者アカウントの名前がサーバー間で同じ値に設定されていて、そのアカウントに割り当てられたパスワードも同じ値に構成されている場合、攻撃者は、管理者またはシステムレベルのアクセス権が取得された1台のコンピューターでアカウントの資格情報を抽出できます。 攻撃者が最初に管理者アカウントを侵害する必要はありません。ローカルの Administrators グループのメンバーであるユーザー、または LocalSystem または管理者権限で実行するように構成されているサービスアカウントのアカウントを侵害するだけで済みます。 その後、攻撃者は管理者アカウントの資格情報を抽出し、ネットワーク上の他のコンピューターに対するネットワークログオンでこれらの資格情報を再生できます。

別のコンピューターに、提示されているアカウントの資格情報と同じユーザー名とパスワード (またはパスワードハッシュ) を持つローカルアカウントがある限り、ログオン試行は成功し、攻撃者は対象のコンピューターへの特権アクセスを取得します。 現在のバージョンの Windows では、ビルトイン Administrator アカウントは [既定で無効](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753450(v=ws.11))になっていますが、レガシオペレーティングシステムでは、アカウントは既定で有効になっています。

> [!NOTE]
> 一部の組織では、他のすべての特権アカウントがシステムからロックアウトされた場合に "フェイルセーフ" が提供されるという信念で、ローカル管理者アカウントを意図的に有効にするように構成しています。 ただし、ローカル管理者アカウントが無効になっていて、アカウントを有効にできる他のアカウントがなく、管理者特権を使用してシステムにログオンできない場合でも、 [Microsoft サポートの記事 814777](https://support.microsoft.com/kb/814777)で説明されているように、システムをセーフモードで起動し、組み込みのローカル管理者アカウントを再び有効にすることができます。 さらに、システムが Gpo を正常に適用した場合は、管理者アカウントを (一時的に) 再度有効にするように GPO を変更することも、ドメインベースのアカウントをローカルの Administrators グループに追加するように制限されたグループを構成することもできます。 修復を実行し、管理者アカウントを再び無効にすることができます。 組み込みのローカル管理者アカウントの資格情報を使用する、左右のセキュリティを効果的に防ぐには、ローカル管理者アカウント用に一意のユーザー名とパスワードを構成する必要があります。 GPO を使用してローカル管理者アカウント用の一意のパスワードを展開するには、technet の「GPO を使用して [ビルトイン administrator アカウントのパスワードを管理するためのソリューション](/previous-versions/mt227395(v=msdn.10)) 」を参照してください。  

##### <a name="permitting-installation-of-unauthorized-applications"></a>承認されていないアプリケーションのインストールを許可する
*法 1: 悪意のあるユーザーが自分のコンピューターでプログラムを実行するように誘導した場合、そのコンピューターだけではなくなります。* - [セキュリティに関する10の不変法 (バージョン 2.0)](https://www.microsoft.com/en-us/msrc?rtc=1)

組織でサーバー全体に一貫したベースライン設定を展開するかどうかにかかわらず、サーバーに定義された役割の一部ではないアプリケーションのインストールは許可されません。 サーバーによって指定された機能の一部ではないソフトウェアをインストールできるようにすることで、サーバーは、サーバーの攻撃対象領域を増やしたり、アプリケーションの脆弱性が発生したり、システムが不安定になったりする、偶発的または悪意のあるソフトウェアのインストールにさらされます。

#### <a name="applications"></a>アプリケーション
前述のように、アプリケーションは多くの場合、アプリケーションが実際に必要とするよりも多くの特権を付与されたアカウントを使用するようにインストールおよび構成されます。 場合によっては、アプリケーションのドキュメントで、サービスアカウントがサーバーのローカル管理者グループのメンバーであるか、LocalSystem のコンテキストで実行されるように構成されている必要があることを指定します。 多くの場合、アプリケーションにはこれらの権限が必要ですが、アプリケーションのサービスアカウントに必要な権限とアクセス許可を決定するには、追加の時間と労力の投資が必要です。 アプリケーションに必要な最小限の特権でアプリケーションがインストールされず、アプリケーションが機能するように構成されている場合は、オペレーティングシステム自体に対して攻撃を受けることなく、アプリケーションの特権を活用する攻撃に対してシステムが公開されます。

### <a name="lack-of-secure-application-development-practices"></a>セキュリティで保護されたアプリケーションの開発方法の欠如
ビジネスワークロードをサポートするインフラストラクチャが存在します。 これらのワークロードがカスタムアプリケーションに実装されている場合は、アプリケーションが安全なベストプラクティスを使用して開発されていることを確認することが重要です。 企業全体のインシデントを根本原因で分析することは、多くの場合、最初のセキュリティ侵害がカスタムアプリケーション (特にインターネットに接続しているアプリケーション) によって影響を受けることを示しています。 これらの侵害のほとんどは、SQL インジェクション (SQLi) やクロスサイトスクリプティング (XSS) 攻撃などの既知の攻撃の危険によって実現されます。

SQL インジェクションはアプリケーションの脆弱性であり、ユーザー定義の入力を使用して、実行するためにデータベースに渡される SQL ステートメントを変更できます。 この入力は、アプリケーションのフィールド、パラメーター (クエリ文字列や cookie など)、またはその他のメソッドを使用して指定できます。 この挿入の結果として、データベースに提供される SQL ステートメントは、開発者が意図したものとは基本的に異なります。 たとえば、ユーザー名とパスワードの組み合わせの評価で使用される一般的なクエリは次のようになります。

`SELECT userID FROM users WHERE username = 'sUserName' AND password = 'sPassword'`

データベースサーバーによって受信された場合、サーバーは users テーブルを検索し、ユーザー名とパスワードがユーザーによって提供されたものと一致する (おそらく、何らかの種類のログインを使用している) ユーザーの userID レコードを返します。 この場合の開発者の意図は、ユーザーが正しいユーザー名とパスワードを指定できる場合にのみ、有効なレコードを返すことです。 いずれかが正しくない場合、データベースサーバーは一致するレコードを検索できず、空の結果を返します。

この問題が発生するのは、攻撃者が、有効なデータの代わりに独自の SQL を提供するなど、予期しない問題が発生した場合です。 SQL はデータベースサーバーによってすぐに解釈されるため、挿入されたコードは開発者が自身に配置したかのように処理されます。 たとえば、攻撃者がユーザー ID として **管理者** を入力し、そのパスワードとして **xyz** または **1 = 1** を入力した場合、データベースによって処理されるステートメントは次のようになります。

`SELECT userID FROM users WHERE username = 'administrator' AND password = 'xyz' OR 1=1`

このクエリがデータベースサーバーによって処理される場合、1 = 1 は常に True と評価されるため、テーブル内のすべての行がクエリで返されます。したがって、正しいユーザー名とパスワードが認識されているか、指定されているかどうかは関係ありません。 ほとんどの場合、最終的な結果として、ユーザーはユーザーのデータベースの最初のユーザーとしてログオンします。ほとんどの場合、これは管理ユーザーになります。

単にログオンするだけでなく、このような不適切な SQL ステートメントを使用して、データの追加、削除、変更を行ったり、データベースからテーブル全体を削除したりすることもできます。 SQLi が過剰な特権で結合されている最も極端なケースでは、オペレーティングシステムコマンドを実行して、新しいユーザーの作成、攻撃ツールのダウンロード、または攻撃者によるその他のアクションの実行を可能にすることができます。

クロスサイトスクリプティングでは、アプリケーションの出力に脆弱性が導入されます。 攻撃は、攻撃者がアプリケーションに不適切な形式のデータを提供することから始まりますが、この例では、不適切な形式のデータは、対象のブラウザーによって実行されるスクリプトコード (JavaScript など) の形式になっています。 XSS 脆弱性を悪用すると、攻撃者は、ブラウザーを起動したユーザーのコンテキストでターゲットアプリケーションの任意の機能を実行できるようになります。 XSS 攻撃は、通常、フィッシング詐欺検出プログラムによって開始され、アプリケーションに接続して攻撃コードを実行するリンクをクリックするようユーザーに促すことができます。

XSS は、攻撃者が悪用されたユーザーのコンテキストで購入または譲渡を行うことができるオンラインバンキングおよび e コマースのシナリオでよく利用されます。 カスタム web ベースの id 管理アプリケーションで攻撃を受けた場合は、攻撃者が独自の id を作成し、アクセス許可と権限を変更して、体系的な侵害を招く可能性があります。

クロスサイトスクリプトと SQL インジェクションの詳細については、このドキュメントでは説明しませんが、 [Open Web Application Security Project (OWASP)](https://www.owasp.org/index.php/Main_Page) は、脆弱性と対策について詳細な説明が記載された上位10のリストを公開します。

インフラストラクチャのセキュリティへの投資にかかわらず、設計および書き込みが適切なアプリケーションがそのインフラストラクチャ内に配置されている場合、環境は攻撃に対して脆弱になります。 また、適切に保護されたインフラストラクチャでも、多くの場合、これらのアプリケーション攻撃に対する効果的な対策を提供できません。 この問題を複合すると、不適切に設計されたアプリケーションでは、アプリケーションを機能させるために、サービスアカウントに過剰なアクセス許可を付与する必要があります。

Microsoft セキュリティ開発ライフサイクル (Security Development Lifecycle: SDL) は、アプリケーションのライフサイクルを通じて、使用停止になるまで、事前に要件の収集と拡張を行うことで、セキュリティを強化するために機能する構造的なプロセスコントロールのセットです。 この効果的なセキュリティ制御の統合は、セキュリティの観点からは重要ではないので、アプリケーションのセキュリティを確保し、コストとスケジュールを有効にすることが重要です。 アプリケーションのセキュリティ上の問題が実質的にコードの完了時に評価されるようにするには、アプリケーションを展開する前または後に、アプリケーションのセキュリティに関する決定を行う必要があります。 組織は、アプリケーションを運用環境に展開する前にアプリケーションの欠陥に対処したり、コストと遅延を発生させることができます。または、既知のセキュリティ欠陥を使用して運用環境にアプリケーションを展開し、侵害を防ぐことができます。

組織によっては、$1万を超える運用環境のコードでのセキュリティの問題を完全に修正したうえで、問題が発生した場合は、10万行のコードあたり10件を超える重大度の問題が発生する可能性があります。 大規模なアプリケーションでは、コストが迅速にエスカレートされます。 これに対して、多くの企業では、SDL の最終的なコードレビューステージで10万行のコードに1つ未満の問題のベンチマークを設定し、運用環境での危険度の高いアプリケーションでの問題をゼロにすることを目標としています。

SDL を実装することにより、アプリケーションの収集と設計に関する要件を早期に示すことによってセキュリティが強化され、危険度の高いアプリケーションに対する脅威のモデル化が実現します。開発者の効果的なトレーニングと監視が必要です。とには、明確で一貫性のあるコード標準とプラクティスが必要です。 SDL の実質的な効果は、アプリケーションのセキュリティを大幅に向上させると同時に、アプリケーションの開発、デプロイ、保守、使用停止にかかるコストを削減します。 このドキュメントでは、SDL の設計と実装の詳細については説明しませんが、詳細なガイダンスと情報については、 [Microsoft セキュリティ開発ライフサイクル](https://www.microsoft.com/security/sdl/default.aspx) を参照してください。

