---
ms.assetid: ba28bd05-16e6-465f-982b-df49633cfde4
title: 攻撃に対してドメイン コントローラーをセキュリティで保護する
ms.author: daveba
author: iainfoulds
manager: daveba
ms.date: 06/18/2017
ms.topic: article
ms.openlocfilehash: 31cb962d03fab418f3d98320662a15ef4f3f3764
ms.sourcegitcommit: b115e5edc545571b6ff4f42082cc3ed965815ea4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2020
ms.locfileid: "93069484"
---
# <a name="securing-domain-controllers-against-attack"></a>攻撃に対してドメイン コントローラーをセキュリティで保護する

> 適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

*法 3: 悪意のあるユーザーがコンピューターに物理的にアクセスできない場合、それはコンピューターではなくなります。* - [セキュリティに関する10の不変法 (バージョン 2.0)](https://www.microsoft.com/en-us/msrc?rtc=1)

ドメインコントローラーは、企業がサーバー、ワークステーション、ユーザー、およびアプリケーションを効率的に管理できるようにするサービスとデータを提供するだけでなく、AD DS データベースの物理ストレージを提供します。 ドメインコントローラーへの特権アクセスが悪意のあるユーザーによって取得された場合、そのユーザーは、Active Directory によって管理されているすべてのシステムとアカウントの変更、破損、または削除を行うことができます。また、拡張機能によって、AD DS ます。

ドメインコントローラーは AD DS データベース内のすべてのデータの読み取りと書き込みが可能であるため、ドメインコントローラーのセキュリティが侵害された場合、既知の良好なバックアップを使用して回復し、プロセスのセキュリティ侵害を許可しているギャップを閉じることができない限り、Active Directory フォレストが信頼できないと見なされることはありません。

攻撃者の準備、ツール、スキルによっては、AD DS データベースの変更や修復不能な破損にも、数日や数週間ではなく数分で完了できます。 重要なのは、攻撃者が Active Directory への特権アクセスを持つ期間ですが、特権アクセスを取得した時点で攻撃者がどの程度の時間を計画しているかということです。 ドメインコントローラーを侵害すると、アクセスの大規模な伝達に最も適したパス、またはメンバーサーバー、ワークステーション、および Active Directory を破棄するための最も直接的なパスを提供できます。 このため、ドメインコントローラーは、一般的な Windows インフラストラクチャよりも個別にセキュリティで保護する必要があります。

## <a name="physical-security-for-domain-controllers"></a>ドメインコントローラーの物理的なセキュリティ

このセクションでは、ドメインコントローラーが物理マシンであるか仮想マシンであるか、データセンターの場所、ブランチオフィス、さらに基本的なインフラストラクチャの制御のみを持つ遠隔地であるかに関係なく、ドメインコントローラーを物理的にセキュリティで保護する方法について説明します。

### <a name="datacenter-domain-controllers"></a>データセンターのドメインコントローラー

#### <a name="physical-domain-controllers"></a>物理ドメインコントローラー

データセンターでは、物理ドメインコントローラーは、一般的なサーバーの作成とは別の専用の安全なラックまたはケージにインストールする必要があります。 可能な場合は、トラステッドプラットフォームモジュール (TPM) チップを使用してドメインコントローラーを構成し、ドメインコントローラーサーバー内のすべてのボリュームを BitLocker ドライブ暗号化経由で保護する必要があります。 通常、BitLocker は、1桁のパーセンテージでパフォーマンスのオーバーヘッドを追加しますが、サーバーからディスクが削除された場合でも、ディレクトリを侵害から保護します。 また、BitLocker は、ルートキットなどの攻撃からシステムを保護するのにも役立ちます。ブートファイルを変更すると、サーバーが回復モードで起動し、元のバイナリを読み込むことができるためです。 ソフトウェア RAID、シリアル接続 SCSI、SAN/NAS 記憶域、またはダイナミックボリュームを使用するようにドメインコントローラーが構成されている場合、BitLocker を実装することはできません。したがって、ローカルに接続された記憶域 (ハードウェア RAID の有無にかかわらず) は、可能な限りドメインコントローラーで使用する必要があります。

#### <a name="virtual-domain-controllers"></a>仮想ドメインコントローラー

仮想ドメインコントローラーを実装する場合は、ドメインコントローラーが環境内の他の仮想マシンとは別の物理ホストで実行されていることを確認する必要があります。 サードパーティの仮想化プラットフォームを使用する場合でも、Windows Server 2012 または Windows Server 2008 R2 の Hyper-v サーバーに仮想ドメインコントローラーを展開することを検討してください。これにより、最小限の攻撃対象が提供され、仮想化ホストの他の部分で管理するのではなく、ホストするドメインコントローラーで管理できるようになります。 仮想化インフラストラクチャの管理のために System Center Virtual Machine Manager (SCVMM) を実装する場合は、ドメインコントローラー仮想マシンが存在する物理ホストの管理と、ドメインコントローラー自体を承認された管理者に委任することができます。 また、記憶域管理者が仮想マシンファイルにアクセスできないように、仮想ドメインコントローラーの記憶域を分離することも検討してください。

### <a name="branch-locations"></a>ブランチの場所

#### <a name="physical-domain-controllers-in-branches"></a>ブランチ内の物理ドメインコントローラー

複数のサーバーが存在し、データセンターサーバーがセキュリティで保護されている程度まで物理的には保護されていない場所では、物理ドメインコントローラーを TPM チップで構成し、すべてのサーバーボリュームに BitLocker ドライブ暗号化する必要があります。 ブランチの場所にある施錠された部屋にドメインコントローラーを格納できない場合は、その場所に Rodc を展開することを検討してください。

#### <a name="virtual-domain-controllers-in-branches"></a>ブランチ内の仮想ドメインコントローラー

可能な場合は、サイト内の他の仮想マシンとは別の物理ホスト上のブランチオフィスで、仮想ドメインコントローラーを実行する必要があります。 仮想ドメインコントローラーを他の仮想サーバーの作成とは別の物理ホスト上で実行できないブランチオフィスでは、TPM チップを実装し、仮想ドメインコントローラーが少なくとも可能な場合は、すべてのホストで実行されるホストに BitLocker ドライブ暗号化する必要があります。 ブランチオフィスのサイズと物理ホストのセキュリティに応じて、ブランチの場所に Rodc を展開することを検討してください。

### <a name="remote-locations-with-limited-space-and-security"></a>領域とセキュリティが制限されたリモートの場所

1台の物理サーバーのみをインストールできる場所がインフラストラクチャに含まれている場合は、仮想化ワークロードを実行できるサーバーをリモートの場所にインストールし、サーバー内のすべてのボリュームを保護するように BitLocker ドライブ暗号化を構成する必要があります。 サーバー上の1台の仮想マシンで、ホスト上で別の仮想マシンとして実行されている他のサーバーを使用して、RODC を実行する必要があります。 RODC の展開の計画に関する情報については、 [「読み取り専用ドメインコントローラーの計画と展開ガイド](/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc771744(v=ws.10))」を参照してください。 仮想化ドメインコントローラーの展開とセキュリティ保護の詳細については、「 [hyper-v でのドメインコントローラーの実行](/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd363553(v=ws.10))」を参照してください。 Hyper-v のセキュリティ強化、仮想マシンの管理の委任、および仮想マシンの保護に関する詳細なガイダンスについては、Microsoft web サイトの「 [Hyper-v セキュリティガイド](https://www.microsoft.com/download/details.aspx?id=16650) ソリューションアクセラレータ」を参照してください。

## <a name="domain-controller-operating-systems"></a>ドメインコントローラーのオペレーティングシステム

組織内でサポートされている最新バージョンの Windows Server 上のすべてのドメインコントローラーを実行し、ドメインコントローラーの作成時にレガシオペレーティングシステムの使用停止を優先することをお勧めします。 ドメインコントローラーを最新の状態に保ち、レガシドメインコントローラーを排除することで、多くの場合、レガシオペレーティングシステムを実行しているドメインコントローラーを持つドメインまたはフォレストでは使用できない新しい機能とセキュリティを利用できます。 ドメインコントローラーは、以前のオペレーティングシステムまたはサーバーの役割からアップグレードするのではなく、新しくインストールして昇格させる必要があります。つまり、ドメインコントローラーのインプレースアップグレードを実行したり、オペレーティングシステムがインストールされていないサーバーで AD DS インストールウィザードを実行したりしないでください。 新しくインストールされたドメインコントローラーを実装することで、従来のファイルや設定が誤ってドメインコントローラーに残されないようにすると共に、一貫したセキュリティで保護されたドメインコントローラーの構成の適用を簡略化します。

## <a name="secure-configuration-of-domain-controllers"></a>ドメインコントローラーの構成をセキュリティで保護する

Windows に既定でインストールされている、無償で利用可能なツールが多数用意されています。これを使用すると、後で Gpo で適用できるドメインコントローラーの初期セキュリティ構成基準を作成できます。 これらのツールについては、こちらを参照してください。

### <a name="security-configuration-wizard"></a>セキュリティの構成ウィザード

最初のビルド時に、すべてのドメインコントローラーをロックダウンする必要があります。 これは、Windows Server にネイティブで提供されるセキュリティ構成ウィザードを使用して、"基本ビルド" ドメインコントローラーでサービス、レジストリ、システム、および WFAS の設定を構成することによって実現できます。 設定は、ドメインコントローラーの一貫した構成を適用するために、フォレスト内の各ドメインのドメインコントローラー OU にリンクできる GPO に保存およびエクスポートできます。 ドメインに複数のバージョンの Windows オペレーティングシステムが含まれている場合は、対応するバージョンのオペレーティングシステムを実行しているドメインコントローラーにのみ Gpo を適用するように Windows Management Instrumentation (WMI) フィルターを構成できます。

### <a name="microsoft-security-compliance-toolkit"></a>Microsoft セキュリティコンプライアンスツールキット

[Microsoft セキュリティコンプライアンスツールキット](https://microsoft.com/download/details.aspx?id=55319) のドメインコントローラー設定をセキュリティ構成ウィザードの設定と組み合わせると、Active Directory のドメインコントローラー OU に展開されている gpo によって展開および適用されるドメインコントローラーの包括的な構成基準を作成できます。

### <a name="rdp-restrictions"></a>RDP の制限

フォレスト内のすべてのドメインコントローラー Ou にリンクするグループポリシーオブジェクトは、承認されたユーザーとシステム (ジャンプサーバーなど) からの RDP 接続のみを許可するように構成する必要があります。 これは、ユーザー権利設定と WFAS 構成の組み合わせによって実現でき、ポリシーが一貫して適用されるように Gpo に実装する必要があります。 この値がバイパスされると、次のグループポリシー更新によってシステムが適切な構成に戻ります。

### <a name="patch-and-configuration-management-for-domain-controllers"></a>ドメインコントローラーの修正プログラムと構成の管理

反するに思えるかもしれませんが、一般的な Windows インフラストラクチャとは別に、ドメインコントローラーやその他の重要なインフラストラクチャコンポーネントの修正プログラムを適用することを検討してください。 インフラストラクチャ内のすべてのコンピューターに対してエンタープライズ構成管理ソフトウェアを利用する場合、システム管理ソフトウェアのセキュリティ侵害を使用して、そのソフトウェアによって管理されるすべてのインフラストラクチャコンポーネントを侵害または破壊することができます。 ドメインコントローラーの修正プログラムとシステム管理を一般作成から分離することにより、ドメインコントローラーにインストールされるソフトウェアの量を削減できるだけでなく、管理を厳しく制御することができます。

### <a name="blocking-internet-access-for-domain-controllers"></a>ドメインコントローラーのインターネットアクセスをブロックする

Active Directory セキュリティ評価の一部として実行されるチェックの1つは、ドメインコントローラーでの Internet Explorer の使用と構成です。 Internet Explorer (またはその他の web ブラウザー) はドメインコントローラーでは使用しないでください。しかし、多数のドメインコントローラーを分析することで、多くの場合、特権のあるユーザーが Internet Explorer を使用して組織のイントラネットまたはインターネットを参照することが明らかになりました。

セキュリティを [侵害する手段](../../../ad-ds/plan/security-best-practices/Avenues-to-Compromise.md)について前述したように、高い特権を持つアカウント (既定ではドメインコントローラーへのローカルログオンが許可されている唯一のアカウント) を使用して、Windows インフラストラクチャ内の最も強力なコンピューターからインターネット (または感染したイントラネット) を参照すると、組織のセキュリティに大きなリスクが生じます。 ダウンロードによってドライブを使用する場合でも、マルウェアに感染したユーティリティをダウンロードする場合でも、攻撃者は、Active Directory 環境を完全に侵害したり破壊したりするために必要なすべてのものにアクセスできます。

Windows Server 2012、Windows Server 2008 R2、Windows Server 2008、および Internet Explorer の現在のバージョンでは、悪意のあるダウンロードに対するさまざまな保護が提供されています。ただし、ほとんどの場合、ドメインコントローラーと特権アカウントを使用してインターネットを参照しているか、ドメインコントローラーで Windows Server 2003 が実行されています。

ドメインコントローラーでの web ブラウザーの起動は、ポリシーだけでなく、技術的な制御によっても禁止する必要があります。また、ドメインコントローラーはインターネットへのアクセスを許可しないでください。 ドメインコントローラーを複数のサイトにレプリケートする必要がある場合は、サイト間にセキュリティで保護された接続を実装する必要があります。 詳細な構成手順については、このドキュメントでは説明しませんが、多数のコントロールを実装して、ドメインコントローラーが誤用されたり、正しく構成されていない場合に、侵害される可能性を制限したりすることができます。

### <a name="perimeter-firewall-restrictions"></a>境界ファイアウォールの制限

境界ファイアウォールは、ドメインコントローラーからインターネットへの送信接続をブロックするように構成する必要があります。 ドメインコントローラーはサイトの境界を越えて通信する必要がある場合がありますが、境界ファイアウォールを構成してサイト間通信を許可することができます。そのためには、Microsoft サポート web サイトで [Active Directory ドメインと信頼のためにファイアウォールを構成する方法](https://support.microsoft.com/kb/179442) に関するページのガイドラインに従ってください。

### <a name="dc-firewall-configurations"></a>DC ファイアウォールの構成

前述のように、セキュリティの構成ウィザードを使用して、ドメインコントローラーのセキュリティが強化された Windows ファイアウォールの構成設定をキャプチャする必要があります。 セキュリティ構成ウィザードの出力を確認して、ファイアウォールの構成設定が組織の要件を満たしていることを確認し、Gpo を使用して構成設定を適用する必要があります。

### <a name="preventing-web-browsing-from-domain-controllers"></a>ドメインコントローラーからの Web 閲覧を防止する

AppLocker 構成、"ブラックホール" プロキシ構成、および WFAS 構成の組み合わせを使用して、ドメインコントローラーがインターネットにアクセスできないようにし、ドメインコントローラーで web ブラウザーを使用しないようにすることができます。
