---
description: 詳細については、「フェデレーションサーバーの証明書の要件」を参照してください。
ms.assetid: 9831b421-8fb7-4e15-ac27-c013cbca6d05
title: フェデレーション サーバーの証明書の要件
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: c9b769588d4dcb0d77f15143247151b20f0dc934
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "97044780"
---
# <a name="certificate-requirements-for-federation-servers"></a>フェデレーション サーバーの証明書の要件

Active Directory フェデレーションサービス (AD FS) AD FS の \( 設計では \) 、通信をセキュリティで保護し、インターネットクライアントとフェデレーションサーバー間のユーザー認証を容易にするために、さまざまな証明書を使用する必要があります。 各フェデレーションサーバーは、AD FS 通信に参加する前に、サービス通信証明書とトークン署名証明書を持っている必要があり \- ます。 次の表では、フェデレーションサーバーに関連付けられている証明書の種類について説明します。

|証明書の種類|説明|
|--------------------|---------------|
|トークン \- 署名証明書|トークン \- 署名証明書は X509 証明書です。 フェデレーションサーバーは、関連付けられた公開 \/ 秘密キーペアを使用して、生成されるすべてのセキュリティトークンにデジタル署名します。 これには、公開されたフェデレーション メタデータとアーティファクト解決要求の署名が含まれます。<p>\-AD FS 管理スナップインで複数のトークン署名証明書を構成して、 \- 1 つの証明書の有効期限が近づいたときに証明書をロールオーバーできるようにすることができます。 既定では、一覧にあるすべての証明書が公開されますが、 \- 実際にトークンに署名するために AD FS によって使用されるのはプライマリトークン署名証明書のみです。 選択するすべての証明書には、対応する秘密キーが必要です。<p>詳細については、「[トークン署名証明書](Token-Signing-Certificates.md)」と「[トークン署名証明書の追加](../../ad-fs/deployment/Add-a-Token-Signing-Certificate.md)」を参照してください。|
|サービス通信証明書|フェデレーションサーバーは、サーバー認証証明書を使用します。これは、Windows Communication Foundation WCF メッセージセキュリティに対するサービス通信とも呼ば \( \) れます。 既定では、これは、フェデレーションサーバーが \( \) インターネットインフォメーションサービス IIS で Secure Sockets Layer SSL 証明書として使用するのと同じ証明書です \( \) 。 **注:** AD FS 管理スナップインは、 \- サービス通信証明書としてのフェデレーションサーバーのサーバー認証証明書を参照します。<p>詳細については、「 [サービス通信証明](Service-Communications-Certificates.md) 書」と「 [サービス通信証明書の設定](../../ad-fs/deployment/Set-a-Service-Communications-Certificate.md)」を参照してください。<p>サービス通信証明書はクライアントコンピューターによって信頼されている必要があるため、信頼された証明機関の CA によって署名された証明書を使用することをお勧め \( \) します。 選択するすべての証明書には、対応する秘密キーが必要です。|
|\(SSL \) 証明書の Secure Sockets Layer|フェデレーション サーバーは、SSL 証明書を使用して Web クライアントとフェデレーション サーバー プロキシとの SSL 通信で Web サービス トラフィックを保護します。<p>SSL 証明書はクライアント コンピューターから信頼されている必要があるので、信頼されている CA が署名した証明書の使用が推奨されます。 選択するすべての証明書には、対応する秘密キーが必要です。|
|トークン \- 暗号化解除証明書|この証明書は、このフェデレーションサーバーが受信するトークンの暗号化を解除するために使用されます。<p>複数の暗号化解除証明書を使用することができます。 これにより、新しい証明書がプライマリ暗号化解除証明書として設定された後に、リソースフェデレーションサーバーが古い証明書で発行されたトークンの暗号化を解除できるようになります。 すべての証明書は復号化に使用できますが、 \- 実際には、プライマリトークン暗号化解除証明書のみがフェデレーションメタデータで公開されます。 選択するすべての証明書には、対応する秘密キーが必要です。<p>詳細については、「 [Token-Decrypting 証明書の追加](../../ad-fs/deployment/Add-a-Token-Decrypting-Certificate.md)」を参照してください。|

IIS 用の Microsoft 管理コンソール MMC スナップインを使用して、サービス通信証明書を要求することにより、SSL 証明書またはサービス通信証明書を要求してインストールすることができ \( \) \- ます。 SSL 証明書の使用に関する一般的な情報については、「iis [7.0: iis 7.0 での Secure Sockets Layer の構成](https://go.microsoft.com/fwlink/?LinkID=108544) 」および「 [IIS 7.0: iis 7.0 でのサーバー証明書の構成](https://go.microsoft.com/fwlink/?LinkID=108545) 」を参照してください。

> [!NOTE]
> AD FS では、デジタル署名に使用されるセキュリティで保護されたハッシュアルゴリズムの \( sha \) レベルを、sha \- 1 または sha 256 の安全性が高くなるように変更でき \- \( \) ます。 AD FSdoes、 \( Makecert.exe コマンドラインツールで使用される既定のハッシュアルゴリズムである MD5 など、他のハッシュ方式での証明書の使用をサポートしていません \- \) 。 セキュリティのベストプラクティスとして、 \- \( すべての署名に既定で設定されている SHA 256 を使用することをお勧めし \) ます。 SHA \- 1 は、 \- Microsoft 以外の \- 製品や AD FS 1 など、sha 256 を使用した通信をサポートしていない製品と相互運用する必要がある場合にのみ使用することをお勧めします。 *x* があります。

## <a name="determining-your-ca-strategy"></a>CA 戦略の決定
AD FS では、証明書が CA によって発行される必要はありません。 ただし、SSL 証明書では、 \( サービス通信証明書としても既定で使用される証明書は、 \) AD FS クライアントによって信頼されている必要があります。 \-これらの証明書の種類には自己署名証明書を使用しないことをお勧めします。

> [!IMPORTANT]
> \-運用環境で自己署名された SSL 証明書を使用すると、アカウントパートナー組織の悪意のあるユーザーがリソースパートナー組織のフェデレーションサーバーを制御できるようになります。 このセキュリティリスクは、自己 \- 署名証明書がルート証明書であるために存在します。 他のフェデレーションサーバー (たとえば、リソースフェデレーションサーバー) の信頼されたルートストアに追加する必要があり \( \) ます。これにより、サーバーが攻撃に対して脆弱になる可能性があります。

CA から証明書を受け取ったら、すべての証明書がローカル コンピューターの個人証明書ストアにインポートされていることを確認してください。 証明書 MMC スナップインを使用して、個人用ストアに証明書をインポートでき \- ます。

証明書スナップインを使用する代わりに \- 、ssl \- 証明書を既定の Web サイトに割り当てるときに、IIS マネージャースナップインを使用して ssl 証明書をインポートすることもできます。 詳細については、「 [サーバー認証証明書を既定の Web サイトにインポートする](../../ad-fs/deployment/Import-a-Server-Authentication-Certificate-to-the-Default-Web-Site.md)」を参照してください。

> [!NOTE]
> フェデレーションサーバーとなるコンピューターに AD FS ソフトウェアをインストールする前に、両方の証明書がローカルコンピューターの個人証明書ストアにあり、SSL 証明書が既定の Web サイトに割り当てられていることを確認してください。 フェデレーションサーバーのセットアップに必要なタスクの順序の詳細については、「 [チェックリスト: フェデレーションサーバーの](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md)セットアップ」を参照してください。

セキュリティと予算の要件に応じて、どの証明書をパブリック CA または企業 CA から取得するかを慎重に検討してください。 次の図は、特定の種類の証明書に推奨される CA 発行者を示しています。 この推奨事項は、 \- セキュリティとコストに関するベストプラクティスアプローチを反映しています。

![証明書の要件](media/adfs2_fedserver_certstory_1.png)

## <a name="certificate-revocation-lists"></a>証明書失効リスト
使用するいずれかの証明書に CRL が指定されている場合、構成済みの証明書が存在するサーバーは CRL を配布するサーバーと通信できる必要があります。

## <a name="see-also"></a>関連項目
[Windows Server 2012 での AD FS 設計ガイド](AD-FS-Design-Guide-in-Windows-Server-2012.md)
